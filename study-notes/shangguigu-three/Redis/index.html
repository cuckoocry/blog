<!doctype html>
<html lang="zh-CN" data-theme="light">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <meta name="generator" content="VuePress 2.0.0-rc.14" />
    <meta name="theme" content="VuePress Theme Hope 2.0.0-rc.52" />
    <style>
      html {
        background: var(--bg-color, #fff);
      }

      html[data-theme="dark"] {
        background: var(--bg-color, #1d1e1f);
      }

      body {
        background: var(--bg-color);
      }
    </style>
    <script>
      const userMode = localStorage.getItem("vuepress-theme-hope-scheme");
      const systemDarkMode =
        window.matchMedia &&
        window.matchMedia("(prefers-color-scheme: dark)").matches;

      if (userMode === "dark" || (userMode !== "light" && systemDarkMode)) {
        document.documentElement.setAttribute("data-theme", "dark");
      }
    </script>
    <meta property="og:url" content="https://mister-hope.github.io/study-notes/shangguigu-three/Redis/"><meta property="og:site_name" content="æ’„å®çš„åšå®¢"><meta property="og:title" content="Redis"><meta property="og:description" content="1ã€Redis 6.0.8 ç¬”è®°å‚è€ƒï¼šhttps://blog.csdn.net/oneby1314/article/details/113789412 1.1ã€Redis 6.0.8 ç‰ˆæœ¬ å®˜ç½‘åœ°å€ å®˜ç½‘åœ°å€ï¼šhttps://redis.io/ ä¸­æ–‡å®˜ç½‘åœ°å€ï¼šhttp://www.redis.cn/ TODO å›¾ç‰‡å¤ªå¤šï¼ŒåæœŸæ›¿æ¢åˆ æ‰ ä¸ºä»€ä¹ˆè¦ä½¿ç”¨ R..."><meta property="og:type" content="article"><meta property="og:locale" content="zh-CN"><meta property="og:updated_time" content="2024-07-27T14:24:55.000Z"><meta property="article:author" content="æ¨±å®"><meta property="article:tag" content="redis"><meta property="article:published_time" content="2023-03-11T00:00:00.000Z"><meta property="article:modified_time" content="2024-07-27T14:24:55.000Z"><script type="application/ld+json">{"@context":"https://schema.org","@type":"Article","headline":"Redis","image":[""],"datePublished":"2023-03-11T00:00:00.000Z","dateModified":"2024-07-27T14:24:55.000Z","author":[{"@type":"Person","name":"æ¨±å®","url":"https://mister-hope.com"}]}</script><title>Redis | æ’„å®çš„åšå®¢</title><meta name="description" content="1ã€Redis 6.0.8 ç¬”è®°å‚è€ƒï¼šhttps://blog.csdn.net/oneby1314/article/details/113789412 1.1ã€Redis 6.0.8 ç‰ˆæœ¬ å®˜ç½‘åœ°å€ å®˜ç½‘åœ°å€ï¼šhttps://redis.io/ ä¸­æ–‡å®˜ç½‘åœ°å€ï¼šhttp://www.redis.cn/ TODO å›¾ç‰‡å¤ªå¤šï¼ŒåæœŸæ›¿æ¢åˆ æ‰ ä¸ºä»€ä¹ˆè¦ä½¿ç”¨ R...">
    <link rel="stylesheet" href="/assets/css/styles.5a20b7f1.css">
    <link rel="preload" href="/assets/js/runtime~app.b0d5d539.js" as="script"><link rel="preload" href="/assets/css/styles.5a20b7f1.css" as="style"><link rel="preload" href="/assets/js/4438.2d872995.js" as="script"><link rel="preload" href="/assets/js/app.44d28fea.js" as="script">
    <link rel="prefetch" href="/assets/js/study-notes_RocketMQ_index.html.2ee58c12.js" as="script"><link rel="prefetch" href="/assets/js/study-notes_heima-java-bagu_concurrent-programming_more.html.8e27d7ef.js" as="script"><link rel="prefetch" href="/assets/js/study-notes_heima-java-bagu_JVM_index.html.75b7da15.js" as="script"><link rel="prefetch" href="/assets/js/study-notes_shangguigu-three_AQS_index.html.3c75cafb.js" as="script"><link rel="prefetch" href="/assets/js/study-notes_heima-java-bagu_concurrent-programming_index.html.0db6e1ae.js" as="script"><link rel="prefetch" href="/assets/js/study-notes_heima-java-bagu_collection_more.html.fb1a423d.js" as="script"><link rel="prefetch" href="/assets/js/study-notes_heima-baodian_framework_index.html.a906998d.js" as="script"><link rel="prefetch" href="/assets/js/study-notes_heima-baodian_base_index.html.2110f2ff.js" as="script"><link rel="prefetch" href="/assets/js/study-notes_heima-java-bagu_enterprise-scenarios_design-patterns.html.1f296879.js" as="script"><link rel="prefetch" href="/assets/js/study-notes_shangguigu-three_Spring_index.html.1cf03463.js" as="script"><link rel="prefetch" href="/assets/js/study-notes_shangguigu-three_Redis_index.html.5a739419.js" as="script"><link rel="prefetch" href="/assets/js/study-notes_spring-boot_index.html.3ba8987d.js" as="script"><link rel="prefetch" href="/assets/js/study-notes_heima-java-bagu_collection_index.html.7110b7a3.js" as="script"><link rel="prefetch" href="/assets/js/study-notes_shangguigu-second_ThreadPool_index.html.da786451.js" as="script"><link rel="prefetch" href="/assets/js/problem-record_merge-pdf.html.d9573496.js" as="script"><link rel="prefetch" href="/assets/js/problem-record_miscellaneous-notes.html.78627b56.js" as="script"><link rel="prefetch" href="/assets/js/study-notes_shangguigu-second_BlockingQueue_index.html.4d45060b.js" as="script"><link rel="prefetch" href="/assets/js/study-notes_JVM_index.html.ac91a204.js" as="script"><link rel="prefetch" href="/assets/js/problem-record_delete-more-iif.html.bb0c0eed.js" as="script"><link rel="prefetch" href="/assets/js/photo-swipe.8b913169.js" as="script"><link rel="prefetch" href="/assets/js/study-notes_shangguigu-second_JVM_six.html.08303fd7.js" as="script"><link rel="prefetch" href="/assets/js/study-notes_shangguigu-second_volatile_two.html.237bc4f4.js" as="script"><link rel="prefetch" href="/assets/js/study-notes_shangguigu-second_JVM_four.html.e52b7652.js" as="script"><link rel="prefetch" href="/assets/js/study-notes_shangguigu-second_ABA_index.html.f6c2859e.js" as="script"><link rel="prefetch" href="/assets/js/study-notes_heima-java-bagu_Redis_more.html.92c49436.js" as="script"><link rel="prefetch" href="/assets/js/problem-record_HTTPInputStreamExample.html.a2d08f79.js" as="script"><link rel="prefetch" href="/assets/js/study-notes_shangguigu-three_UUID_index.html.d181dce1.js" as="script"><link rel="prefetch" href="/assets/js/study-notes_shangguigu-second_lock_one.html.e86cff71.js" as="script"><link rel="prefetch" href="/assets/js/study-notes_heima-baodian_jvm_index.html.d7916282.js" as="script"><link rel="prefetch" href="/assets/js/study-notes_heima-java-bagu_Redis_index.html.a47ffc21.js" as="script"><link rel="prefetch" href="/assets/js/study-notes_shangguigu-second_JVM_three.html.80c02474.js" as="script"><link rel="prefetch" href="/assets/js/study-notes_shangguigu-second_JVM_five.html.2adb6a53.js" as="script"><link rel="prefetch" href="/assets/js/study-notes_shangguigu-second_lock_three.html.4cfd462d.js" as="script"><link rel="prefetch" href="/assets/js/study-notes_heima-java-bagu_MySQL_index.html.f5d65f90.js" as="script"><link rel="prefetch" href="/assets/js/study-notes_shangguigu-second_Linux_index.html.5927316d.js" as="script"><link rel="prefetch" href="/assets/js/study-notes_heima-java-bagu_Microservices_more.html.ac96191d.js" as="script"><link rel="prefetch" href="/assets/js/problem-record_idea-template.html.f266627b.js" as="script"><link rel="prefetch" href="/assets/js/study-notes_shangguigu-second_ArrayList_index.html.20db0d60.js" as="script"><link rel="prefetch" href="/assets/js/study-notes_heima-java-bagu_frame_spring_index.html.d5916296.js" as="script"><link rel="prefetch" href="/assets/js/study-notes_heima-java-bagu_MySQL_more.html.e264ca25.js" as="script"><link rel="prefetch" href="/assets/js/study-notes_shangguigu-second_volatile_four.html.675a1026.js" as="script"><link rel="prefetch" href="/assets/js/study-notes_shangguigu-three_await-signal.html.2bc23012.js" as="script"><link rel="prefetch" href="/assets/js/study-notes_heima-baodian_concurrency_index.html.c5d49b43.js" as="script"><link rel="prefetch" href="/assets/js/study-notes_shangguigu-three_two.html.1ad53cd5.js" as="script"><link rel="prefetch" href="/assets/js/study-notes_shangguigu-second_Synchronized-Lock_index.html.939b0167.js" as="script"><link rel="prefetch" href="/assets/js/study-notes_heima-java-bagu_message-middleware_more.html.3ae3b32d.js" as="script"><link rel="prefetch" href="/assets/js/study-notes_heima-java-bagu_enterprise-scenarios_technical-scenarios.html.b6045028.js" as="script"><link rel="prefetch" href="/assets/js/study-notes_shangguigu-three_WaitNotify_index.html.53868da1.js" as="script"><link rel="prefetch" href="/assets/js/demo_markdown.html.ca9ed489.js" as="script"><link rel="prefetch" href="/assets/js/study-notes_shangguigu-second_volatile_one.html.c6412124.js" as="script"><link rel="prefetch" href="/assets/js/study-notes_shangguigu-second_SiSuo_index.html.118bd2a2.js" as="script"><link rel="prefetch" href="/assets/js/problem-record_github-tips.html.cb0ccced.js" as="script"><link rel="prefetch" href="/assets/js/study-notes_shangguigu-second_CAS_index.html.b8efdf46.js" as="script"><link rel="prefetch" href="/assets/js/study-notes_shangguigu-three_ReentrantLock_index.html.35ba8440.js" as="script"><link rel="prefetch" href="/assets/js/study-notes_heima-java-bagu_frame_mybatis_index.html.23c6a9cb.js" as="script"><link rel="prefetch" href="/assets/js/study-notes_heima-java-bagu_frame_index.html.3f60f718.js" as="script"><link rel="prefetch" href="/assets/js/problem-record_redission.html.efba65bc.js" as="script"><link rel="prefetch" href="/assets/js/study-notes_Internet_five_index.html.53db647b.js" as="script"><link rel="prefetch" href="/assets/js/study-notes_shangguigu-second_volatile_three.html.ad7262a1.js" as="script"><link rel="prefetch" href="/assets/js/study-notes_shangguigu-three_one.html.804e2a46.js" as="script"><link rel="prefetch" href="/assets/js/study-notes_shangguigu-second_lock_four.html.46f7726e.js" as="script"><link rel="prefetch" href="/assets/js/study-notes_Internet_one_index.html.6bf3eab7.js" as="script"><link rel="prefetch" href="/assets/js/study-notes_Internet_four_index.html.3c9ab8e0.js" as="script"><link rel="prefetch" href="/assets/js/study-notes_shangguigu-second_CountDownLatch_CyclicBarrier_Semaphore_Semaphore.html.fd8b4edd.js" as="script"><link rel="prefetch" href="/assets/js/study-notes_shangguigu-second_CountDownLatch_CyclicBarrier_Semaphore_countDownLatch.html.938876ec.js" as="script"><link rel="prefetch" href="/assets/js/study-notes_shangguigu-second_CountDownLatch_CyclicBarrier_Semaphore_CyclicBarrier.html.a6a3bf4f.js" as="script"><link rel="prefetch" href="/assets/js/problem-record_interview-transcripts.html.ac6b208a.js" as="script"><link rel="prefetch" href="/assets/js/study-notes_heima-java-bagu_Microservices_index.html.f31da1ed.js" as="script"><link rel="prefetch" href="/assets/js/study-notes_Internet_https-http_index.html.57051d7b.js" as="script"><link rel="prefetch" href="/assets/js/study-notes_Internet_TCP_index.html.92943403.js" as="script"><link rel="prefetch" href="/assets/js/study-notes_shangguigu-second_JVM_two.html.ebe7c20d.js" as="script"><link rel="prefetch" href="/assets/js/study-notes_Internet_http-state_index.html.236f5ee2.js" as="script"><link rel="prefetch" href="/assets/js/about-the-blogs_about-learn.html.ecc6aa52.js" as="script"><link rel="prefetch" href="/assets/js/study-notes_shangguigu-three_LockSupport_index.html.31120357.js" as="script"><link rel="prefetch" href="/assets/js/study-notes_shangguigu-second_lock_six.html.9d160033.js" as="script"><link rel="prefetch" href="/assets/js/study-notes_shangguigu-second_lock_two.html.3ba10359.js" as="script"><link rel="prefetch" href="/assets/js/interview-related_index.html.a39d7ec8.js" as="script"><link rel="prefetch" href="/assets/js/study-notes_shangguigu-second_github_index.html.5ff5d830.js" as="script"><link rel="prefetch" href="/assets/js/study-notes_shangguigu-second_lock_five.html.16aef773.js" as="script"><link rel="prefetch" href="/assets/js/demo_page.html.9fdec868.js" as="script"><link rel="prefetch" href="/assets/js/study-notes_shangguigu-second_JVM_one.html.efb67209.js" as="script"><link rel="prefetch" href="/assets/js/vue_basics.html.9ed2ff6c.js" as="script"><link rel="prefetch" href="/assets/js/study-notes_shangguigu-three_index.html.1d3993a8.js" as="script"><link rel="prefetch" href="/assets/js/demo_layout.html.df6ea29e.js" as="script"><link rel="prefetch" href="/assets/js/study-notes_heima-java-bagu_index.html.6153514d.js" as="script"><link rel="prefetch" href="/assets/js/index.html.226c9895.js" as="script"><link rel="prefetch" href="/assets/js/study-notes_heima-baodian_index.html.171e0a1a.js" as="script"><link rel="prefetch" href="/assets/js/study-notes_Internet_index.html.2cf17bc9.js" as="script"><link rel="prefetch" href="/assets/js/problem-record_tool.html.8fbe9897.js" as="script"><link rel="prefetch" href="/assets/js/study-notes_SpringCloud_index.html.8f5a72ee.js" as="script"><link rel="prefetch" href="/assets/js/about-the-blogs_about-blogs.html.8832fc96.js" as="script"><link rel="prefetch" href="/assets/js/posts_tomato.html.b67eccc0.js" as="script"><link rel="prefetch" href="/assets/js/posts_cherry.html.1f0519ed.js" as="script"><link rel="prefetch" href="/assets/js/posts_dragonfruit.html.4f3b22aa.js" as="script"><link rel="prefetch" href="/assets/js/interview-related_collection.html.37ac5f0d.js" as="script"><link rel="prefetch" href="/assets/js/interview-related_java-thread.html.78ce6e10.js" as="script"><link rel="prefetch" href="/assets/js/interview-related_network.html.1fb20e4d.js" as="script"><link rel="prefetch" href="/assets/js/posts_strawberry.html.5b034160.js" as="script"><link rel="prefetch" href="/assets/js/interview-related_javase.html.bc943ebd.js" as="script"><link rel="prefetch" href="/assets/js/interview-related_rocketMQ.html.9e465bce.js" as="script"><link rel="prefetch" href="/assets/js/web3_basics.html.982467f3.js" as="script"><link rel="prefetch" href="/assets/js/demo_disable.html.a65959a2.js" as="script"><link rel="prefetch" href="/assets/js/interview-related_mybatis.html.06d02f5b.js" as="script"><link rel="prefetch" href="/assets/js/interview-related_spring.html.e051de85.js" as="script"><link rel="prefetch" href="/assets/js/problem-record_idea-tool.html.04317727.js" as="script"><link rel="prefetch" href="/assets/js/interview-related_mysql.html.49038ee5.js" as="script"><link rel="prefetch" href="/assets/js/interview-related_redis.html.96f9eded.js" as="script"><link rel="prefetch" href="/assets/js/interview-related_jvm.html.bbce5275.js" as="script"><link rel="prefetch" href="/assets/js/intro.html.bd3ece79.js" as="script"><link rel="prefetch" href="/assets/js/study-notes_heima-java-bagu_message-middleware_index.html.003f41a6.js" as="script"><link rel="prefetch" href="/assets/js/note-record_index.html.afbe755e.js" as="script"><link rel="prefetch" href="/assets/js/vue_advanced.html.f7e661c2.js" as="script"><link rel="prefetch" href="/assets/js/demo_index.html.4b67b37f.js" as="script"><link rel="prefetch" href="/assets/js/study-notes_Redis_index.html.7bb41ba6.js" as="script"><link rel="prefetch" href="/assets/js/study-notes_index.html.d07347fa.js" as="script"><link rel="prefetch" href="/assets/js/about-the-blogs_index.html.221e9a9e.js" as="script"><link rel="prefetch" href="/assets/js/demo_encrypt.html.54689103.js" as="script"><link rel="prefetch" href="/assets/js/study-notes_shangguigu-second_CountDownLatch_CyclicBarrier_Semaphore_index.html.75c9ceb9.js" as="script"><link rel="prefetch" href="/assets/js/category_å¾…å®Œæˆå­¦ä¹ _index.html.4c296546.js" as="script"><link rel="prefetch" href="/assets/js/category_è®¡ç®—æœºç½‘ç»œ_index.html.78e3ff25.js" as="script"><link rel="prefetch" href="/assets/js/tag_linuxè¯Šæ–­åŸå› _index.html.f87ddee4.js" as="script"><link rel="prefetch" href="/assets/js/tag_åƒåœ¾æ”¶é›†å™¨_index.html.bd300acb.js" as="script"><link rel="prefetch" href="/assets/js/tag_è®¡ç®—æœºç½‘ç»œ_index.html.62354a90.js" as="script"><link rel="prefetch" href="/assets/js/tag_javaä¸­çš„å¼•ç”¨_index.html.2b7ecce6.js" as="script"><link rel="prefetch" href="/assets/js/tag_pdfæ–‡ä»¶åˆå¹¶_index.html.3c3cecca.js" as="script"><link rel="prefetch" href="/assets/js/category_ä»£ç å®è·µ_index.html.c5fce4f7.js" as="script"><link rel="prefetch" href="/assets/js/category_ä½¿ç”¨æŒ‡å—_index.html.0ef7fbc5.js" as="script"><link rel="prefetch" href="/assets/js/category_å¼€å‘å·¥å…·_index.html.fc08d3fc.js" as="script"><link rel="prefetch" href="/assets/js/category_æ–‡ä»¶ä¸‹è½½_index.html.b5fc346e.js" as="script"><link rel="prefetch" href="/assets/js/category_é¢è¯•æŒ‡å—_index.html.da2cbc4d.js" as="script"><link rel="prefetch" href="/assets/js/category_åˆ†å¸ƒå¼é”_index.html.6ab87fbd.js" as="script"><link rel="prefetch" href="/assets/js/category_å­¦ä¹ ç¬”è®°_index.html.e1c6b897.js" as="script"><link rel="prefetch" href="/assets/js/tag_ä½¿ç”¨æŒ‡å—_index.html.bc841eb2.js" as="script"><link rel="prefetch" href="/assets/js/tag_é¡µé¢é…ç½®_index.html.450f5b04.js" as="script"><link rel="prefetch" href="/assets/js/category_ä¸­é—´ä»¶_index.html.e6ea141d.js" as="script"><link rel="prefetch" href="/assets/js/category_ç«é¾™æœ_index.html.7b624395.js" as="script"><link rel="prefetch" href="/assets/js/category_çº¿ç¨‹æ± _index.html.dbd8d811.js" as="script"><link rel="prefetch" href="/assets/js/tag_çº¿ç¨‹æ± _index.html.c1728d38.js" as="script"><link rel="prefetch" href="/assets/js/category_vueç³»åˆ—_index.html.c45f0061.js" as="script"><link rel="prefetch" href="/assets/js/tag_countdownlatch_index.html.e2d1f863.js" as="script"><link rel="prefetch" href="/assets/js/tag_blockingqueue_index.html.6886f648.js" as="script"><link rel="prefetch" href="/assets/js/tag_cyclicbarrier_index.html.c8d05131.js" as="script"><link rel="prefetch" href="/assets/js/study-notes_heima-java-bagu_enterprise-scenarios_index.html.486faa2e.js" as="script"><link rel="prefetch" href="/assets/js/tag_abaé—®é¢˜_index.html.4ebb7a1a.js" as="script"><link rel="prefetch" href="/assets/js/tag_synchronized_index.html.2a050105.js" as="script"><link rel="prefetch" href="/assets/js/category_ä½œè€…_index.html.4a06c4dd.js" as="script"><link rel="prefetch" href="/assets/js/category_åšå®¢_index.html.b01c0be2.js" as="script"><link rel="prefetch" href="/assets/js/category_æŒ‡å—_index.html.cbc6ddd9.js" as="script"><link rel="prefetch" href="/assets/js/category_æ°´æœ_index.html.ae881e84.js" as="script"><link rel="prefetch" href="/assets/js/category_è‰è“_index.html.57cb5e09.js" as="script"><link rel="prefetch" href="/assets/js/category_è”¬èœ_index.html.aa9a0818.js" as="script"><link rel="prefetch" href="/assets/js/category_é¢è¯•_index.html.0d330113.js" as="script"><link rel="prefetch" href="/assets/js/category_é»‘é©¬_index.html.2afbd9e4.js" as="script"><link rel="prefetch" href="/assets/js/tag_springcloud_index.html.c181453e.js" as="script"><link rel="prefetch" href="/assets/js/category_æ¨±æ¡ƒ_index.html.fc7c9cfe.js" as="script"><link rel="prefetch" href="/assets/js/tag_springboot_index.html.bf003e53.js" as="script"><link rel="prefetch" href="/assets/js/category_redisson_index.html.9547efcc.js" as="script"><link rel="prefetch" href="/assets/js/tag_åŠ å¯†_index.html.ed2afdb8.js" as="script"><link rel="prefetch" href="/assets/js/tag_æ­»é”_index.html.c956510f.js" as="script"><link rel="prefetch" href="/assets/js/tag_ç¦ç”¨_index.html.55d5f998.js" as="script"><link rel="prefetch" href="/assets/js/tag_å¸ƒå±€_index.html.e4e5637f.js" as="script"><link rel="prefetch" href="/assets/js/tag_semaphore_index.html.dc787218.js" as="script"><link rel="prefetch" href="/assets/js/tag_markdown_index.html.8b7160eb.js" as="script"><link rel="prefetch" href="/assets/js/tag_redisson_index.html.6eda9ef5.js" as="script"><link rel="prefetch" href="/assets/js/tag_rocketmq_index.html.2fbcee45.js" as="script"><link rel="prefetch" href="/assets/js/tag_volatile_index.html.264b4aba.js" as="script"><link rel="prefetch" href="/assets/js/category_python_index.html.2695dc60.js" as="script"><link rel="prefetch" href="/assets/js/category_github_index.html.767d937d.js" as="script"><link rel="prefetch" href="/assets/js/category_redis_index.html.55a4485e.js" as="script"><link rel="prefetch" href="/assets/js/tag_github_index.html.40f0ba65.js" as="script"><link rel="prefetch" href="/assets/js/tag_spring_index.html.da740394.js" as="script"><link rel="prefetch" href="/assets/js/study-notes_shangguigu-second_index.html.afb183a0.js" as="script"><link rel="prefetch" href="/assets/js/category_code_index.html.0da6942e.js" as="script"><link rel="prefetch" href="/assets/js/category_web3_index.html.25b16ace.js" as="script"><link rel="prefetch" href="/assets/js/category_idea_index.html.d05dfe34.js" as="script"><link rel="prefetch" href="/assets/js/tag_redis_index.html.c50d3b8d.js" as="script"><link rel="prefetch" href="/assets/js/tag_åœ†_index.html.82de771e.js" as="script"><link rel="prefetch" href="/assets/js/tag_å¤§_index.html.f5259ce1.js" as="script"><link rel="prefetch" href="/assets/js/tag_å°_index.html.7618ef30.js" as="script"><link rel="prefetch" href="/assets/js/tag_çº¢_index.html.ed83d242.js" as="script"><link rel="prefetch" href="/assets/js/tag_é”_index.html.8ead85bf.js" as="script"><link rel="prefetch" href="/assets/js/category_juc_index.html.b4989350.js" as="script"><link rel="prefetch" href="/assets/js/tag_lock_index.html.cf83714a.js" as="script"><link rel="prefetch" href="/assets/js/study-notes_shangguigu-second_volatile_index.html.186645dd.js" as="script"><link rel="prefetch" href="/assets/js/tag_aqs_index.html.9439689b.js" as="script"><link rel="prefetch" href="/assets/js/tag_cas_index.html.c57de7ea.js" as="script"><link rel="prefetch" href="/assets/js/tag_git_index.html.53147f3a.js" as="script"><link rel="prefetch" href="/assets/js/tag_jvm_index.html.f08f0b7b.js" as="script"><link rel="prefetch" href="/assets/js/tag_oom_index.html.0a682b87.js" as="script"><link rel="prefetch" href="/assets/js/tag_juc_index.html.d623dc53.js" as="script"><link rel="prefetch" href="/assets/js/404.html.163411d4.js" as="script"><link rel="prefetch" href="/assets/js/timeline_index.html.90648ff2.js" as="script"><link rel="prefetch" href="/assets/js/problem-record_index.html.7d185252.js" as="script"><link rel="prefetch" href="/assets/js/study-notes_shangguigu-second_lock_index.html.11231ee0.js" as="script"><link rel="prefetch" href="/assets/js/category_index.html.3b894dd2.js" as="script"><link rel="prefetch" href="/assets/js/study-notes_shangguigu-second_JVM_index.html.01efbaf1.js" as="script"><link rel="prefetch" href="/assets/js/article_index.html.8ba67079.js" as="script"><link rel="prefetch" href="/assets/js/tag_index.html.069b8621.js" as="script"><link rel="prefetch" href="/assets/js/star_index.html.4fc96bbe.js" as="script"><link rel="prefetch" href="/assets/js/posts_index.html.f200a201.js" as="script"><link rel="prefetch" href="/assets/js/web3_index.html.e40de95d.js" as="script"><link rel="prefetch" href="/assets/js/vue_index.html.f5914a75.js" as="script">
  </head>
  <body>
    <div id="app"><!--[--><!--[--><!--[--><span tabindex="-1"></span><a href="#main-content" class="vp-skip-link sr-only">è·³è‡³ä¸»è¦å…§å®¹</a><!--]--><div class="theme-container external-link-icon has-toc"><!--[--><header id="navbar" class="vp-navbar"><div class="vp-navbar-start"><button type="button" class="vp-toggle-sidebar-button" title="Toggle Sidebar"><span class="icon"></span></button><!----><!--[--><a class="route-link vp-brand" href="/"><img class="vp-nav-logo" src="https://theme-hope-assets.vuejs.press/logo.svg" alt><!----><span class="vp-site-name hide-in-pad">æ’„å®çš„åšå®¢</span></a><!--]--><!----></div><div class="vp-navbar-center"><!----><!--[--><nav class="vp-nav-links"><div class="vp-nav-item hide-in-mobile"><a class="route-link auto-link" href="/" aria-label="é¦–é¡µ"><!--[--><span class="font-icon icon fa-fw fa-sm fas fa-home" style=""></span><!--]-->é¦–é¡µ<!----></a></div><div class="vp-nav-item hide-in-mobile"><a class="route-link route-link-active auto-link" href="/study-notes/" aria-label="å­¦ä¹ ç¬”è®°"><!--[--><span class="font-icon icon fa-fw fa-sm fas fa-wand-magic-sparkles" style=""></span><!--]-->å­¦ä¹ ç¬”è®°<!----></a></div><div class="vp-nav-item hide-in-mobile"><a class="route-link auto-link" href="/interview-related/" aria-label="é¢è¯•æŒ‡å—"><!--[--><span class="font-icon icon fa-fw fa-sm fas fa-pen-to-square" style=""></span><!--]-->é¢è¯•æŒ‡å—<!----></a></div><div class="vp-nav-item hide-in-mobile"><a class="route-link auto-link" href="/problem-record/" aria-label="æ‚è®°"><!--[--><span class="font-icon icon fa-fw fa-sm fas fa-eye" style=""></span><!--]-->æ‚è®°<!----></a></div><div class="vp-nav-item hide-in-mobile"><a class="route-link auto-link" href="/note-record/" aria-label="ç¬”è®°æ€»ç»“"><!--[--><span class="font-icon icon fa-fw fa-sm fas fa-eye" style=""></span><!--]-->ç¬”è®°æ€»ç»“<!----></a></div><div class="vp-nav-item hide-in-mobile"><a class="route-link auto-link" href="/web3/" aria-label="web3ç³»åˆ—"><!--[--><span class="font-icon icon fa-fw fa-sm fas fa-fire" style=""></span><!--]-->web3ç³»åˆ—<!----></a></div><div class="vp-nav-item hide-in-mobile"><a class="route-link auto-link" href="/vue/" aria-label="Vueç³»åˆ—"><!--[--><span class="font-icon icon fa-fw fa-sm fas fa-fire" style=""></span><!--]-->Vueç³»åˆ—<!----></a></div><div class="vp-nav-item hide-in-mobile"><a class="route-link auto-link" href="/about-the-blogs/" aria-label="åšå®¢ç›¸å…³"><!--[--><span class="font-icon icon fa-fw fa-sm fas fa-blog" style=""></span><!--]-->åšå®¢ç›¸å…³<!----></a></div></nav><!--]--><!----></div><div class="vp-navbar-end"><!----><!--[--><!----><div class="vp-nav-item vp-action"><a class="vp-action-link" href="https://github.com/vuepress-theme-hope/vuepress-theme-hope" target="_blank" rel="noopener noreferrer" aria-label="GitHub"><svg xmlns="http://www.w3.org/2000/svg" class="icon github-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="github icon" name="github" style="width:1.25rem;height:1.25rem;vertical-align:middle;"><path d="M511.957 21.333C241.024 21.333 21.333 240.981 21.333 512c0 216.832 140.544 400.725 335.574 465.664 24.49 4.395 32.256-10.07 32.256-23.083 0-11.69.256-44.245 0-85.205-136.448 29.61-164.736-64.64-164.736-64.64-22.315-56.704-54.4-71.765-54.4-71.765-44.587-30.464 3.285-29.824 3.285-29.824 49.195 3.413 75.179 50.517 75.179 50.517 43.776 75.008 114.816 53.333 142.762 40.79 4.523-31.66 17.152-53.377 31.19-65.537-108.971-12.458-223.488-54.485-223.488-242.602 0-53.547 19.114-97.323 50.517-131.67-5.035-12.33-21.93-62.293 4.779-129.834 0 0 41.258-13.184 134.912 50.346a469.803 469.803 0 0 1 122.88-16.554c41.642.213 83.626 5.632 122.88 16.554 93.653-63.488 134.784-50.346 134.784-50.346 26.752 67.541 9.898 117.504 4.864 129.834 31.402 34.347 50.474 78.123 50.474 131.67 0 188.586-114.73 230.016-224.042 242.09 17.578 15.232 33.578 44.672 33.578 90.454v135.85c0 13.142 7.936 27.606 32.854 22.87C862.25 912.597 1002.667 728.747 1002.667 512c0-271.019-219.648-490.667-490.71-490.667z"></path></svg></a></div><div class="vp-nav-item hide-in-mobile"><button type="button" class="vp-outlook-button" tabindex="-1" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" class="icon outlook-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="outlook icon" name="outlook"><path d="M224 800c0 9.6 3.2 44.8 6.4 54.4 6.4 48-48 76.8-48 76.8s80 41.6 147.2 0 134.4-134.4 38.4-195.2c-22.4-12.8-41.6-19.2-57.6-19.2C259.2 716.8 227.2 761.6 224 800zM560 675.2l-32 51.2c-51.2 51.2-83.2 32-83.2 32 25.6 67.2 0 112-12.8 128 25.6 6.4 51.2 9.6 80 9.6 54.4 0 102.4-9.6 150.4-32l0 0c3.2 0 3.2-3.2 3.2-3.2 22.4-16 12.8-35.2 6.4-44.8-9.6-12.8-12.8-25.6-12.8-41.6 0-54.4 60.8-99.2 137.6-99.2 6.4 0 12.8 0 22.4 0 12.8 0 38.4 9.6 48-25.6 0-3.2 0-3.2 3.2-6.4 0-3.2 3.2-6.4 3.2-6.4 6.4-16 6.4-16 6.4-19.2 9.6-35.2 16-73.6 16-115.2 0-105.6-41.6-198.4-108.8-268.8C704 396.8 560 675.2 560 675.2zM224 419.2c0-28.8 22.4-51.2 51.2-51.2 28.8 0 51.2 22.4 51.2 51.2 0 28.8-22.4 51.2-51.2 51.2C246.4 470.4 224 448 224 419.2zM320 284.8c0-22.4 19.2-41.6 41.6-41.6 22.4 0 41.6 19.2 41.6 41.6 0 22.4-19.2 41.6-41.6 41.6C339.2 326.4 320 307.2 320 284.8zM457.6 208c0-12.8 12.8-25.6 25.6-25.6 12.8 0 25.6 12.8 25.6 25.6 0 12.8-12.8 25.6-25.6 25.6C470.4 233.6 457.6 220.8 457.6 208zM128 505.6C128 592 153.6 672 201.6 736c28.8-60.8 112-60.8 124.8-60.8-16-51.2 16-99.2 16-99.2l316.8-422.4c-48-19.2-99.2-32-150.4-32C297.6 118.4 128 291.2 128 505.6zM764.8 86.4c-22.4 19.2-390.4 518.4-390.4 518.4-22.4 28.8-12.8 76.8 22.4 99.2l9.6 6.4c35.2 22.4 80 12.8 99.2-25.6 0 0 6.4-12.8 9.6-19.2 54.4-105.6 275.2-524.8 288-553.6 6.4-19.2-3.2-32-19.2-32C777.6 76.8 771.2 80 764.8 86.4z"></path></svg><div class="vp-outlook-dropdown"><!----></div></button></div><!----><!--]--><!----><button type="button" class="vp-toggle-navbar-button" aria-label="Toggle Navbar" aria-expanded="false" aria-controls="nav-screen"><span><span class="vp-top"></span><span class="vp-middle"></span><span class="vp-bottom"></span></span></button></div></header><!----><!--]--><!----><div class="toggle-sidebar-wrapper"><span class="arrow start"></span></div><aside id="sidebar" class="vp-sidebar"><!----><ul class="vp-sidebar-links"><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">å¤§å‚é¢è¯•ç¬¬äºŒå­£</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable active" type="button"><!----><span class="vp-sidebar-title">å¤§å‚é¢è¯•ç¬¬ä¸‰å­£</span><span class="vp-arrow down"></span></button><ul class="vp-sidebar-links"><li><a class="route-link auto-link vp-sidebar-link" href="/study-notes/shangguigu-three/" aria-label="å¤§å‚é¢è¯•é¢˜ç¬¬ä¸‰å­£"><!---->å¤§å‚é¢è¯•é¢˜ç¬¬ä¸‰å­£<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/study-notes/shangguigu-three/one.html" aria-label="å­—ç¬¦ä¸²å¸¸é‡Javaå†…éƒ¨åŠ è½½"><!---->å­—ç¬¦ä¸²å¸¸é‡Javaå†…éƒ¨åŠ è½½<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/study-notes/shangguigu-three/two.html" aria-label="é—²èŠåŠ›æ‰£ç®—æ³•ç¬¬ä¸€é¢˜"><!---->é—²èŠåŠ›æ‰£ç®—æ³•ç¬¬ä¸€é¢˜<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/study-notes/shangguigu-three/ReentrantLock/" aria-label="å¯é‡å…¥é”ç†è®º"><!---->å¯é‡å…¥é”ç†è®º<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/study-notes/shangguigu-three/LockSupport/" aria-label="LockSupport"><!---->LockSupport<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/study-notes/shangguigu-three/WaitNotify/" aria-label="çº¿ç¨‹ç­‰å¾…å”¤é†’æœºåˆ¶"><!---->çº¿ç¨‹ç­‰å¾…å”¤é†’æœºåˆ¶<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/study-notes/shangguigu-three/await-signal.html" aria-label="await - signalé™åˆ¶"><!---->await - signalé™åˆ¶<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/study-notes/shangguigu-three/LockSupport/" aria-label="LockSupport"><!---->LockSupport<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/study-notes/shangguigu-three/AQS/" aria-label="AQS"><!---->AQS<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/study-notes/shangguigu-three/Spring/" aria-label="Spring"><!---->Spring<!----></a></li><li><a class="route-link route-link-active auto-link vp-sidebar-link active" href="/study-notes/shangguigu-three/Redis/" aria-label="Redis"><!---->Redis<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/study-notes/shangguigu-three/UUID/" aria-label="é›†ç¾¤é«˜å¹¶å‘æƒ…å†µä¸‹å¦‚ä½•ä¿è¯åˆ†å¸ƒå¼å”¯ä¸€å…¨å±€Idç”Ÿæˆ"><!---->é›†ç¾¤é«˜å¹¶å‘æƒ…å†µä¸‹å¦‚ä½•ä¿è¯åˆ†å¸ƒå¼å”¯ä¸€å…¨å±€Idç”Ÿæˆ<!----></a></li></ul></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">é»‘é©¬Javaå…«è‚¡</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">é»‘é©¬é¢è¯•å®å…¸</span><span class="vp-arrow end"></span></button><!----></section></li><li><a class="route-link auto-link vp-sidebar-link" href="/study-notes/JVM/" aria-label="JVM"><!---->JVM<!----></a></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">è®¡ç®—æœºç½‘ç»œ</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">SpringBoot</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">SpringCloud</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">RocketMQ</span><span class="vp-arrow end"></span></button><!----></section></li><li><a class="route-link auto-link vp-sidebar-link" href="/study-notes/Redis/" aria-label="Redis"><!---->Redis<!----></a></li></ul><!----></aside><!--[--><main id="main-content" class="vp-page"><!--[--><!----><!----><nav class="vp-breadcrumb disable"></nav><div class="vp-page-title"><h1><!---->Redis</h1><div class="page-info"><span class="page-author-info" aria-label="ä½œè€…ğŸ–Š" data-balloon-pos="up"><svg xmlns="http://www.w3.org/2000/svg" class="icon author-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="author icon" name="author"><path d="M649.6 633.6c86.4-48 147.2-144 147.2-249.6 0-160-128-288-288-288s-288 128-288 288c0 108.8 57.6 201.6 147.2 249.6-121.6 48-214.4 153.6-240 288-3.2 9.6 0 19.2 6.4 25.6 3.2 9.6 12.8 12.8 22.4 12.8h704c9.6 0 19.2-3.2 25.6-12.8 6.4-6.4 9.6-16 6.4-25.6-25.6-134.4-121.6-240-243.2-288z"></path></svg><span><a class="page-author-item" href="https://mister-hope.com" target="_blank" rel="noopener noreferrer">æ¨±å®</a></span><span property="author" content="æ¨±å®"></span></span><!----><span class="page-date-info" aria-label="å†™ä½œæ—¥æœŸğŸ“…" data-balloon-pos="up"><svg xmlns="http://www.w3.org/2000/svg" class="icon calendar-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="calendar icon" name="calendar"><path d="M716.4 110.137c0-18.753-14.72-33.473-33.472-33.473-18.753 0-33.473 14.72-33.473 33.473v33.473h66.993v-33.473zm-334.87 0c0-18.753-14.72-33.473-33.473-33.473s-33.52 14.72-33.52 33.473v33.473h66.993v-33.473zm468.81 33.52H716.4v100.465c0 18.753-14.72 33.473-33.472 33.473a33.145 33.145 0 01-33.473-33.473V143.657H381.53v100.465c0 18.753-14.72 33.473-33.473 33.473a33.145 33.145 0 01-33.473-33.473V143.657H180.6A134.314 134.314 0 0046.66 277.595v535.756A134.314 134.314 0 00180.6 947.289h669.74a134.36 134.36 0 00133.94-133.938V277.595a134.314 134.314 0 00-133.94-133.938zm33.473 267.877H147.126a33.145 33.145 0 01-33.473-33.473c0-18.752 14.72-33.473 33.473-33.473h736.687c18.752 0 33.472 14.72 33.472 33.473a33.145 33.145 0 01-33.472 33.473z"></path></svg><span><!----></span><meta property="datePublished" content="2023-03-11T00:00:00.000Z"></span><!----><span class="page-reading-time-info" aria-label="é˜…è¯»æ—¶é—´âŒ›" data-balloon-pos="up"><svg xmlns="http://www.w3.org/2000/svg" class="icon timer-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="timer icon" name="timer"><path d="M799.387 122.15c4.402-2.978 7.38-7.897 7.38-13.463v-1.165c0-8.933-7.38-16.312-16.312-16.312H256.33c-8.933 0-16.311 7.38-16.311 16.312v1.165c0 5.825 2.977 10.874 7.637 13.592 4.143 194.44 97.22 354.963 220.201 392.763-122.204 37.542-214.893 196.511-220.2 389.397-4.661 5.049-7.638 11.651-7.638 19.03v5.825h566.49v-5.825c0-7.379-2.849-13.981-7.509-18.9-5.049-193.016-97.867-351.985-220.2-389.527 123.24-37.67 216.446-198.453 220.588-392.892zM531.16 450.445v352.632c117.674 1.553 211.787 40.778 211.787 88.676H304.097c0-48.286 95.149-87.382 213.728-88.676V450.445c-93.077-3.107-167.901-81.297-167.901-177.093 0-8.803 6.99-15.793 15.793-15.793 8.803 0 15.794 6.99 15.794 15.793 0 80.261 63.69 145.635 142.01 145.635s142.011-65.374 142.011-145.635c0-8.803 6.99-15.793 15.794-15.793s15.793 6.99 15.793 15.793c0 95.019-73.789 172.82-165.96 177.093z"></path></svg><span>å¤§çº¦ 59 åˆ†é’Ÿ</span><meta property="timeRequired" content="PT59M"></span><span class="page-category-info" aria-label="åˆ†ç±»ğŸŒˆ" data-balloon-pos="up"><svg xmlns="http://www.w3.org/2000/svg" class="icon category-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="category icon" name="category"><path d="M148.41 106.992h282.176c22.263 0 40.31 18.048 40.31 40.31V429.48c0 22.263-18.047 40.31-40.31 40.31H148.41c-22.263 0-40.311-18.047-40.311-40.31V147.302c0-22.263 18.048-40.31 40.311-40.31zM147.556 553.478H429.73c22.263 0 40.311 18.048 40.311 40.31v282.176c0 22.263-18.048 40.312-40.31 40.312H147.555c-22.263 0-40.311-18.049-40.311-40.312V593.79c0-22.263 18.048-40.311 40.31-40.311zM593.927 106.992h282.176c22.263 0 40.31 18.048 40.31 40.31V429.48c0 22.263-18.047 40.31-40.31 40.31H593.927c-22.263 0-40.311-18.047-40.311-40.31V147.302c0-22.263 18.048-40.31 40.31-40.31zM730.22 920.502H623.926c-40.925 0-74.22-33.388-74.22-74.425V623.992c0-41.038 33.387-74.424 74.425-74.424h222.085c41.038 0 74.424 33.226 74.424 74.067v114.233c0 10.244-8.304 18.548-18.547 18.548s-18.548-8.304-18.548-18.548V623.635c0-20.388-16.746-36.974-37.33-36.974H624.13c-20.585 0-37.331 16.747-37.331 37.33v222.086c0 20.585 16.654 37.331 37.126 37.331H730.22c10.243 0 18.547 8.304 18.547 18.547 0 10.244-8.304 18.547-18.547 18.547z"></path></svg><!--[--><span class="page-category-item color5 clickable" role="navigation">å­¦ä¹ ç¬”è®°</span><!--]--><meta property="articleSection" content="å­¦ä¹ ç¬”è®°"></span><span class="page-tag-info" aria-label="æ ‡ç­¾ğŸ·" data-balloon-pos="up"><svg xmlns="http://www.w3.org/2000/svg" class="icon tag-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="tag icon" name="tag"><path d="M939.902 458.563L910.17 144.567c-1.507-16.272-14.465-29.13-30.737-30.737L565.438 84.098h-.402c-3.215 0-5.726 1.005-7.634 2.913l-470.39 470.39a10.004 10.004 0 000 14.164l365.423 365.424c1.909 1.908 4.42 2.913 7.132 2.913s5.223-1.005 7.132-2.913l470.39-470.39c2.01-2.11 3.014-5.023 2.813-8.036zm-240.067-72.121c-35.458 0-64.286-28.828-64.286-64.286s28.828-64.285 64.286-64.285 64.286 28.828 64.286 64.285-28.829 64.286-64.286 64.286z"></path></svg><!--[--><span class="page-tag-item color8 clickable" role="navigation">redis</span><!--]--><meta property="keywords" content="redis"></span></div><hr></div><div class="vp-toc-placeholder"><aside id="toc"><!----><div class="vp-toc-header">æ­¤é¡µå†…å®¹<button type="button" class="print-button" title="æ‰“å°"><svg xmlns="http://www.w3.org/2000/svg" class="icon print-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="print icon" name="print"><path d="M819.2 364.8h-44.8V128c0-17.067-14.933-32-32-32H281.6c-17.067 0-32 14.933-32 32v236.8h-44.8C145.067 364.8 96 413.867 96 473.6v192c0 59.733 49.067 108.8 108.8 108.8h44.8V896c0 17.067 14.933 32 32 32h460.8c17.067 0 32-14.933 32-32V774.4h44.8c59.733 0 108.8-49.067 108.8-108.8v-192c0-59.733-49.067-108.8-108.8-108.8zM313.6 160h396.8v204.8H313.6V160zm396.8 704H313.6V620.8h396.8V864zM864 665.6c0 25.6-19.2 44.8-44.8 44.8h-44.8V588.8c0-17.067-14.933-32-32-32H281.6c-17.067 0-32 14.933-32 32v121.6h-44.8c-25.6 0-44.8-19.2-44.8-44.8v-192c0-25.6 19.2-44.8 44.8-44.8h614.4c25.6 0 44.8 19.2 44.8 44.8v192z"></path></svg></button><div class="arrow end"></div></div><div class="vp-toc-wrapper"><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#_1ã€redis-6-0-8">1ã€Redis 6.0.8</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_1-1ã€redis-6-0-8-ç‰ˆæœ¬">1.1ã€Redis 6.0.8 ç‰ˆæœ¬</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_1-2ã€å®‰è£…-redis-6-0-8">1.2ã€å®‰è£… Redis 6.0.8</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_1-3ã€å®‰è£…åçš„é…ç½®">1.3ã€å®‰è£…åçš„é…ç½®</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_1-4ã€redis-å‘½ä»¤å¤§å…¨">1.4ã€Redis å‘½ä»¤å¤§å…¨</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#_2ã€redis-åŸºæœ¬æ•°æ®ç±»å‹">2ã€Redis åŸºæœ¬æ•°æ®ç±»å‹</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_2-1ã€8-å¤§ç±»å‹">2.1ã€8 å¤§ç±»å‹</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_2-2ã€string">2.2ã€string</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_2-3ã€hash">2.3ã€hash</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_2-4ã€list">2.4ã€list</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_2-5ã€set">2.5ã€set</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_2-6ã€zset">2.6ã€zset</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#_3ã€redis-åˆ†å¸ƒå¼é”">3ã€Redis åˆ†å¸ƒå¼é”</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_3-1ã€åˆ†å¸ƒå¼é”çš„é¢è¯•é¢˜">3.1ã€åˆ†å¸ƒå¼é”çš„é¢è¯•é¢˜</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_3-2ã€æ­å»ºè¶…å–å·¥ç¨‹">3.2ã€æ­å»ºè¶…å–å·¥ç¨‹</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_3-3ã€æµ‹è¯•-æ‰¾èŒ¬">3.3ã€æµ‹è¯• &amp; æ‰¾èŒ¬</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_3-4ã€åˆ†å¸ƒå¼é”æ€»ç»“">3.4ã€åˆ†å¸ƒå¼é”æ€»ç»“</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#_4ã€redis-ç¼“å­˜æ·˜æ±°ç­–ç•¥">4ã€Redis ç¼“å­˜æ·˜æ±°ç­–ç•¥</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_4-1ã€ç¼“å­˜æ·˜æ±°ç­–ç•¥çš„é¢è¯•é¢˜">4.1ã€ç¼“å­˜æ·˜æ±°ç­–ç•¥çš„é¢è¯•é¢˜</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_4-2ã€redis-å†…å­˜æ»¡äº†æ€ä¹ˆåŠ">4.2ã€redis å†…å­˜æ»¡äº†æ€ä¹ˆåŠ</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_4-3ã€redis-ç¼“å­˜æ·˜æ±°ç­–ç•¥">4.3ã€redis ç¼“å­˜æ·˜æ±°ç­–ç•¥</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#_5ã€redis-lru-ç®—æ³•">5ã€redis LRU ç®—æ³•</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_5-1ã€lru-ç®—æ³•ç®€ä»‹">5.1ã€LRU ç®—æ³•ç®€ä»‹</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_5-2ã€lru-ç®—æ³•é¢˜æ¥æº">5.2ã€LRU ç®—æ³•é¢˜æ¥æº</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_5-3ã€lru-ç®—æ³•è®¾è®¡æ€æƒ³">5.3ã€LRU ç®—æ³•è®¾è®¡æ€æƒ³</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_5-4ã€lru-ç®—æ³•ç¼–ç å®ç°">5.4ã€LRU ç®—æ³•ç¼–ç å®ç°</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#åŸç†">åŸç†</a></li><!----><!--]--></ul></li><!--]--></ul><div class="vp-toc-marker" style="top:-1.7rem;"></div></div><!----></aside></div><!----><div class="theme-hope-content"><h2 id="_1ã€redis-6-0-8" tabindex="-1"><a class="header-anchor" href="#_1ã€redis-6-0-8"><span>1ã€Redis 6.0.8</span></a></h2><blockquote><p>ç¬”è®°å‚è€ƒï¼šhttps://blog.csdn.net/oneby1314/article/details/113789412</p></blockquote><h3 id="_1-1ã€redis-6-0-8-ç‰ˆæœ¬" tabindex="-1"><a class="header-anchor" href="#_1-1ã€redis-6-0-8-ç‰ˆæœ¬"><span>1.1ã€Redis 6.0.8 ç‰ˆæœ¬</span></a></h3><blockquote><p><strong>å®˜ç½‘åœ°å€</strong></p></blockquote><ol><li><p>å®˜ç½‘åœ°å€ï¼š<a href="https://redis.io/" target="_blank" rel="noopener noreferrer">https://redis.io/</a></p></li><li><p>ä¸­æ–‡å®˜ç½‘åœ°å€ï¼š<a href="http://www.redis.cn/" target="_blank" rel="noopener noreferrer">http://www.redis.cn/</a></p></li></ol><blockquote><p>TODO å›¾ç‰‡å¤ªå¤šï¼ŒåæœŸæ›¿æ¢åˆ æ‰ <strong>ä¸ºä»€ä¹ˆè¦ä½¿ç”¨ Redis 6.0.8</strong></p></blockquote><p>Redisçªç„¶å‘å¸ƒäº†ç´§æ€¥ç‰ˆæœ¬ 6.0.8 ï¼Œä¹‹å‰æ¶ˆæ¯ç§° 6.0.7 è¢«ç§°ä½œæœ€åä¸€ä¸ª 6.x ç‰ˆæœ¬ï¼Œä½† Redis å›¢é˜Ÿè¡¨ç¤º 6.0.8 ç‰ˆæœ¬å‡çº§è¿«åˆ‡æ€§ç­‰çº§ä¸ºé«˜ï¼šä»»ä½•å°† Redis 6.0.7 ä¸ <a href="https://so.csdn.net/so/search?q=Sentinel&amp;spm=1001.2101.3001.7020" target="_blank" rel="noopener noreferrer">Sentinel</a> æˆ– CONFIG REWRITE å‘½ä»¤é…åˆä½¿ç”¨çš„äººéƒ½ä¼šå—åˆ°å½±å“ï¼Œåº”å°½å¿«å‡çº§ã€‚</p><figure><img src="/assets/img/24afba3710eecc8f2225fdec39063d40.6383b8a3.png" alt="image-20210126163514224" tabindex="0" loading="lazy"><figcaption>image-20210126163514224</figcaption></figure><hr><p>ä»å®˜æ–¹ç»™å‡ºçš„ä¿¡æ¯æ¥çœ‹ï¼Œä¼°è®¡æ˜¯å‡ºç°äº†Bugï¼Œå…·ä½“æ›´æ–°çš„å†…å®¹å¦‚ä¸‹ï¼š</p><p><strong>1ã€Bugä¿®å¤</strong></p><ol><li>CONFIG REWRITEåœ¨é€šè¿‡CONFIGè®¾ç½®<strong>oom-score-adj-values</strong>åï¼Œå¯ä»¥é€šè¿‡CONFIGè®¾ç½®æˆ–ä»é…ç½®æ–‡ä»¶ä¸­åŠ è½½ï¼Œä¼šç”Ÿæˆä¸€ä¸ªæŸåçš„é…ç½®æ–‡ä»¶ã€‚å°†ä¼šå¯¼è‡´Redisæ— æ³•å¯åŠ¨</li><li>ä¿®æ­£MacOSä¸Šredis-cli --pipeçš„é—®é¢˜ã€‚</li><li>åœ¨ä¸å­˜åœ¨çš„å¯†é’¥ä¸Šï¼Œä¿®å¤HKEYS/HVALSçš„RESP3å“åº”ã€‚</li><li>å„ç§å°çš„é”™è¯¯ä¿®å¤</li></ol><p><strong>2ã€æ–°åŠŸèƒ½</strong></p><ol><li>å½“è®¾ç½®ä¸ºmadviseæ—¶ï¼Œç§»é™¤THPè­¦å‘Šã€‚</li><li>å…è®¸åœ¨ç¾¤é›†ä¸­åªè¯»å‰¯æœ¬ä¸Šä½¿ç”¨è¯»å‘½ä»¤è¿›è¡ŒEXECã€‚</li><li>åœ¨redis-cli-clusterè°ƒç”¨å‘½ä»¤ä¸­å¢åŠ master/replicasé€‰é¡¹ã€‚</li></ol><p><strong>3ã€æ¨¡å—åŒ–API</strong></p><p>æ·»åŠ RedisModule_ThreadSafeContextTryLockã€‚</p><h3 id="_1-2ã€å®‰è£…-redis-6-0-8" tabindex="-1"><a class="header-anchor" href="#_1-2ã€å®‰è£…-redis-6-0-8"><span>1.2ã€å®‰è£… Redis 6.0.8</span></a></h3><blockquote><p><strong>å‚è€ƒèµ„æ–™</strong></p></blockquote><ol><li><a href="https://www.cnblogs.com/heqiuyong/p/10463334.html" target="_blank" rel="noopener noreferrer">Centos7å®‰è£…Redis</a></li><li><a href="https://blog.csdn.net/qq_42021376/article/details/109260130" target="_blank" rel="noopener noreferrer">CentOS7.3ç¯å¢ƒä¸‹å®‰è£…Redis 6.0.8 ç¼–è¯‘æŠ¥é”™</a></li></ol><blockquote><p><strong>åœ¨ Linux ä¸‹å®‰è£… Redis 6.0.8 ç‰ˆæœ¬</strong></p></blockquote><p><strong>1ã€æŸ¥çœ‹ gcc ç‰ˆæœ¬</strong></p><p>ç”±äº redis æ˜¯ç”¨ C è¯­è¨€å¼€å‘ï¼Œå®‰è£…ä¹‹å‰å¿…å…ˆç¡®è®¤æ˜¯å¦å®‰è£… gcc ç¯å¢ƒï¼ˆ<code>gcc -v</code>ï¼‰ï¼Œå¦‚æœæ²¡æœ‰å®‰è£…ï¼Œæ‰§è¡Œä»¥ä¸‹å‘½ä»¤è¿›è¡Œå®‰è£…ï¼Œæˆ‘æœ¬æœºç‰ˆæœ¬ä¸º 4.8.5ï¼Œå¾ˆæ˜æ˜¾ä¸ç¬¦åˆ redis 6.0.8 ç‰ˆæœ¬çš„è¦æ±‚</p><p><strong>æ³¨æ„</strong>ï¼šå½“ä½ ä¸‹è½½redisæœ€æ–°ç‰ˆæœ¬6.0.8çš„æ—¶å€™ä¼šå‘ç°<code>make</code>çš„æ—¶å€™ä¼šæŠ¥é”™ï¼Œç®€å•æ¥è¯´å°±æ˜¯æœ€æ–°ç‰ˆçš„redisç”¨åˆ°äº†c11 ï¼Œä½ çš„ç³»ç»Ÿgccç‰ˆæœ¬ä½äº†ï¼Œç³»ç»Ÿè‡ªå¸¦gccç‰ˆæœ¬æ˜¯4.8.5ï¼Œåªéœ€è¦æ›´æ–°ä¸‹gccåˆ°5.4ä»¥ä¸Šå³å¯ï¼ŒåŒæ—¶ç¼–è¯‘redisæ—¶å¸¦ä¸Šgccç‰ˆæœ¬çš„ä½¿ç”¨å‚æ•°ï¼Œä¸å½±å“ç³»ç»Ÿè‡ªå¸¦gccï¼</p><pre><code>[heygo@localhost redis-6.0.8]$ gcc -v
ä½¿ç”¨å†…å»º specsã€‚
COLLECT_GCC=gcc
COLLECT_LTO_WRAPPER=/usr/libexec/gcc/x86_64-redhat-linux/4.8.5/lto-wrapper
ç›®æ ‡ï¼šx86_64-redhat-linux
é…ç½®ä¸ºï¼š../configure --prefix=/usr --mandir=/usr/share/man --infodir=/usr/share/info --with-bugurl=http://bugzilla.redhat.com/bugzilla --enable-bootstrap --enable-shared --enable-threads=posix --enable-checking=release --with-system-zlib --enable-__cxa_atexit --disable-libunwind-exceptions --enable-gnu-unique-object --enable-linker-build-id --with-linker-hash-style=gnu --enable-languages=c,c++,objc,obj-c++,java,fortran,ada,go,lto --enable-plugin --enable-initfini-array --disable-libgcj --with-isl=/builddir/build/BUILD/gcc-4.8.5-20150702/obj-x86_64-redhat-linux/isl-install --with-cloog=/builddir/build/BUILD/gcc-4.8.5-20150702/obj-x86_64-redhat-linux/cloog-install --enable-gnu-indirect-function --with-tune=generic --with-arch_32=x86-64 --build=x86_64-redhat-linux
çº¿ç¨‹æ¨¡å‹ï¼šposix
gcc ç‰ˆæœ¬ 4.8.5 20150623 (Red Hat 4.8.5-44) (GCC) 
</code></pre><hr><p><strong>2ã€å®‰è£… gcc ç¯å¢ƒ</strong></p><p>ä½¿ç”¨ yum æ›´æ–° gccï¼Œä¾æ¬¡æ‰§è¡Œå¦‚ä¸‹æŒ‡ä»¤å³å¯</p><pre><code>yum -y install centos-release-scl
yum -y install devtoolset-9-gcc devtoolset-9-gcc-c++ devtoolset-9-binutils
scl enable devtoolset-9 bash
</code></pre><p>å®‰è£…åå†æ¬¡ä½¿ç”¨ <code>gcc -v</code> æŸ¥çœ‹æœ¬æœº gcc ç‰ˆæœ¬</p><pre><code>[heygo@localhost redis-6.0.8]$ gcc -v
Using built-in specs.
COLLECT_GCC=gcc
COLLECT_LTO_WRAPPER=/opt/rh/devtoolset-9/root/usr/libexec/gcc/x86_64-redhat-linux/9/lto-wrapper
Target: x86_64-redhat-linux
Configured with: ../configure --enable-bootstrap --enable-languages=c,c++,fortran,lto --prefix=/opt/rh/devtoolset-9/root/usr --mandir=/opt/rh/devtoolset-9/root/usr/share/man --infodir=/opt/rh/devtoolset-9/root/usr/share/info --with-bugurl=http://bugzilla.redhat.com/bugzilla --enable-shared --enable-threads=posix --enable-checking=release --enable-multilib --with-system-zlib --enable-__cxa_atexit --disable-libunwind-exceptions --enable-gnu-unique-object --enable-linker-build-id --with-gcc-major-version-only --with-linker-hash-style=gnu --with-default-libstdcxx-abi=gcc4-compatible --enable-plugin --enable-initfini-array --with-isl=/builddir/build/BUILD/gcc-9.3.1-20200408/obj-x86_64-redhat-linux/isl-install --disable-libmpx --enable-gnu-indirect-function --with-tune=generic --with-arch_32=x86-64 --build=x86_64-redhat-linux
Thread model: posix
gcc version 9.3.1 20200408 (Red Hat 9.3.1-2) (GCC) 
</code></pre><hr><p><strong>3ã€ä¸‹è½½å¹¶è§£å‹å®‰è£…åŒ…</strong></p><p>ä½¿ç”¨ <code>wget</code> å‘½ä»¤ä¸‹è½½ <code>.tar.gz</code> å‹ç¼©åŒ…ï¼ˆæˆ‘çš„å¤©ï¼Œå¤ªæ…¢äº†ï¼Œä¸‹æ¬¡æ‰¾é•œåƒï¼‰ï¼Œå¹¶ä½¿ç”¨ <code>tar</code> æŒ‡ä»¤å°†å…¶è§£å‹</p><pre><code>wget http://download.redis.io/releases/redis-6.0.8.tar.gz
tar -zxvf redis-6.0.8.tar.gz
</code></pre><p><strong>4ã€æ‰§è¡Œç¼–è¯‘</strong></p><p>ä¸‹è½½ä»¥åŠè§£å‹çš„ Redis å®‰è£…åŒ…ä½ç½®å¦‚å›¾æ‰€ç¤º</p><p><code>cd</code> åˆ‡æ¢åˆ° redis è§£å‹ç›®å½•ä¸‹ï¼Œæ‰§è¡Œç¼–è¯‘</p><pre><code>cd redis-6.0.8/
make
</code></pre><p><strong>5ã€å®‰è£… redis</strong></p><p>å°† redis å®‰è£…åˆ°æŒ‡å®šç›®å½•</p><pre><code>make install PREFIX=/usr/local/redis
</code></pre><blockquote><p><strong>æµ‹è¯•å®‰è£…æ˜¯å¦æˆåŠŸ</strong></p></blockquote><p>åˆ‡æ¢åˆ° redis å®‰è£…ç›®å½•ä¸‹</p><pre><code>cd /usr/local/redis/bin/
</code></pre><p>å¯åŠ¨ redis æœåŠ¡ç«¯</p><pre><code>./redis-server
</code></pre><p>é€šè¿‡ redis å®¢æˆ·ç«¯è¿æ¥ redis æœåŠ¡ç«¯</p><pre><code>./redis-cli -h 127.0.0.1 -p 6379
</code></pre><p>èƒ½å¤Ÿé€šè¿‡å®¢æˆ·ç«¯è¿æ¥å·¥å…·è¿æ¥ä¸Š redis æœåŠ¡å™¨ï¼Œåˆ™è¯´æ˜å®‰è£…æˆåŠŸ</p><figure><img src="/assets/img/a5baa77a4b087e96a406f2bea5295e5c.7cbdbf74.png" alt="image-20210124234956650" tabindex="0" loading="lazy"><figcaption>image-20210124234956650</figcaption></figure><blockquote><p><strong>æŸ¥çœ‹ redis ç‰ˆæœ¬</strong></p></blockquote><p>1ã€åœ¨ Linux å‘½ä»¤è¡Œä¸‹ï¼šåœ¨ redis å®‰è£…ç›®å½•ä¸‹æ‰§è¡Œ <code>redis-server -version</code> å‘½ä»¤</p><figure><img src="/assets/img/b16aa21090e64bd6ccdbab58e78db6f5.334e55de.png" alt="image-20210124235611841" tabindex="0" loading="lazy"><figcaption>image-20210124235611841</figcaption></figure><p>2ã€åœ¨ redis å‘½ä»¤è¡Œä¸‹ï¼šæ‰§è¡Œ <code>info</code> å‘½ä»¤</p><figure><img src="/assets/img/59dbaf6cd24c579ea268a2c59e9c55e6.402c67f6.png" alt="image-20210124235228022" tabindex="0" loading="lazy"><figcaption>image-20210124235228022</figcaption></figure><h3 id="_1-3ã€å®‰è£…åçš„é…ç½®" tabindex="-1"><a class="header-anchor" href="#_1-3ã€å®‰è£…åçš„é…ç½®"><span>1.3ã€å®‰è£…åçš„é…ç½®</span></a></h3><blockquote><p><strong>è®¾ç½® redis æœåŠ¡åå°è¿è¡Œ</strong></p></blockquote><p>ä» redis çš„æºç ç›®å½•ä¸­å¤åˆ¶ redis.conf åˆ° redis çš„å®‰è£…ç›®å½•</p><pre><code>cp redis-6.0.8/redis.conf /usr/local/redis/bin/
</code></pre><p>ä½¿ç”¨ vim ç¼–è¾‘å™¨ç¼–è¾‘ redis.conf é…ç½®æ–‡ä»¶</p><pre><code>vim /usr/local/redis/bin/redis.conf
</code></pre><p>ä¿®æ”¹ redis.conf æ–‡ä»¶ï¼ŒæŠŠ <code>daemonize no</code> æ”¹ä¸º <code>daemonize yes</code></p><figure><img src="/assets/img/8edb107c6732977f40d1c6cf45cf1b11.60e9bc51.png" alt="image-20210124233439884" tabindex="0" loading="lazy"><figcaption>image-20210124233439884</figcaption></figure><blockquote><p><strong>è®¾ç½® redis å¼€æœºè‡ªå¯åŠ¨</strong></p></blockquote><p>ä½¿ç”¨ vim ç¼–è¾‘ <code>/etc/systemd/system/redis.service</code> é…ç½®æ–‡ä»¶</p><pre><code>vim /etc/systemd/system/redis.service
</code></pre><p>æ·»åŠ å¦‚ä¸‹é…ç½®ï¼š</p><pre><code>[Unit]
Description=redis-server
After=network.target

[Service]
Type=forking
ExecStart=/usr/local/redis/bin/redis-server /usr/local/redis/bin/redis.conf
PrivateTmp=true

[Install]
WantedBy=multi-user.target
</code></pre><blockquote><p>æˆ‘æ˜¯dockerå®‰è£…çš„ï¼Œè®¿é—®å…¥ä¸‹ï¼š</p></blockquote><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" data-title="shell" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-dark:#7F848E;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;">#1ã€è¿›å…¥rediså®¹å™¨ï¼š</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">docker</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> exec</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -it</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> [pid] bash</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-dark:#7F848E;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;">#2ã€é€‰æ‹©è¿æ¥çš„redis ipå’Œç«¯å£ï¼š</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">redis-cli</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -h</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 127.0.0.1</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -p</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 6379</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-dark:#7F848E;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;">#3ã€è¾“å…¥ </span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">auth</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> [rediså¯†ç ]</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_1-4ã€redis-å‘½ä»¤å¤§å…¨" tabindex="-1"><a class="header-anchor" href="#_1-4ã€redis-å‘½ä»¤å¤§å…¨"><span>1.4ã€Redis å‘½ä»¤å¤§å…¨</span></a></h3><blockquote><p><strong><a href="http://www.redis.cn/commands.html" target="_blank" rel="noopener noreferrer">å®˜ç½‘å‘½ä»¤å¤§å…¨</a></strong></p></blockquote><p>ç›´æ¥æœç´¢å³å¯</p><figure><img src="/assets/img/bc0857fd16e54b47f2e2762d8c7405c7.f27edd88.png" alt="image-20210126222802272" tabindex="0" loading="lazy"><figcaption>image-20210126222802272</figcaption></figure><p><strong>æ³¨</strong>ï¼šå‘½ä»¤ä¸åŒºåˆ†å¤§å°å†™ï¼Œè€Œkeyæ˜¯åŒºåˆ†å¤§å°å†™çš„ï¼Œå¯ä½¿ç”¨ <code>help @ç±»å‹åè¯</code> æŸ¥çœ‹</p><h2 id="_2ã€redis-åŸºæœ¬æ•°æ®ç±»å‹" tabindex="-1"><a class="header-anchor" href="#_2ã€redis-åŸºæœ¬æ•°æ®ç±»å‹"><span>2ã€Redis åŸºæœ¬æ•°æ®ç±»å‹</span></a></h2><h3 id="_2-1ã€8-å¤§ç±»å‹" tabindex="-1"><a class="header-anchor" href="#_2-1ã€8-å¤§ç±»å‹"><span>2.1ã€8 å¤§ç±»å‹</span></a></h3><blockquote><p><strong>ä»¥å‰æ˜¯ 5 ç§æ•°æ®ç±»å‹ï¼Œç°åœ¨æ˜¯ 8 ç§å•¦~</strong></p></blockquote><ol><li>String(å­—ç¬¦ç±»å‹)</li><li>Hash(æ•£åˆ—ç±»å‹)</li><li>List(åˆ—è¡¨ç±»å‹)</li><li>Set(é›†åˆç±»å‹)</li><li>SortedSet(æœ‰åºé›†åˆç±»å‹ï¼Œç®€ç§°zset)</li><li>Bitmap(ä½å›¾)</li><li>HyperLogLog(ç»Ÿè®¡)</li><li>GEO(åœ°ç†)</li></ol><h3 id="_2-2ã€string" tabindex="-1"><a class="header-anchor" href="#_2-2ã€string"><span>2.2ã€string</span></a></h3><blockquote><p><strong>è·å–/è®¾ç½®å•ä¸ªå€¼</strong></p></blockquote><p><strong>è®¾ç½®</strong>ï¼š<code>SET key value</code></p><p><strong>è·å–</strong>ï¼š<code>SET key</code></p><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" data-title="shell" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">127.0.0.1:6379</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt; </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">set</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> name</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> jiang</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">OK</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">127.0.0.1:6379</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt; </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">get</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> name</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">&quot;jiang&quot;</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">127.0.0.1:6379</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><hr><p><strong>æ³¨æ„äº‹é¡¹</strong>ï¼šæ‰§è¡Œ redis æŒ‡ä»¤å¯èƒ½ä¼šå‡ºç°å¦‚ä¸‹é”™è¯¯ï¼š(error) MISCONF Redis is configured to save RDB snapshots, but it is currently not able to persist on disk. Commands that may modify the data set are disabled, because this instance is configured to report errors during writes if RDB snapshotting fails (stop-writes-on-bgsave-error option). Please check the Redis logs for details about the RDB error.</p><p><strong>åŸå› åˆ†æ</strong>ï¼šç©¶å…¶åŸå› æ˜¯å› ä¸ºå¼ºåˆ¶æŠŠ redis å¿«ç…§å…³é—­äº†å¯¼è‡´ä¸èƒ½æŒä¹…åŒ–çš„é—®é¢˜ï¼Œåœ¨ç½‘ä¸ŠæŸ¥äº†ä¸€äº›ç›¸å…³è§£å†³æ–¹æ¡ˆï¼Œé€šè¿‡ stop-writes-on-bgsave-error å€¼è®¾ç½®ä¸º no å³å¯é¿å…è¿™ç§é—®é¢˜ã€‚</p><p><strong>è§£å†³æ–¹æ¡ˆä¸€</strong>ï¼šé€šè¿‡ redis å‘½ä»¤è¡Œä¿®æ”¹ï¼Œåœ¨ redis å‘½ä»¤è¡Œæ‰§è¡Œ <code>config set stop-writes-on-bgsave-error no</code> æŒ‡ä»¤</p><p><strong>è§£å†³æ–¹æ¡ˆäºŒ</strong>ï¼šç›´æ¥ä¿®æ”¹ redis.conf é…ç½®æ–‡ä»¶ï¼Œä½¿ç”¨ vim ç¼–è¾‘å™¨æ‰“å¼€ redis-server é…ç½®çš„ redis.conf æ–‡ä»¶ï¼Œç„¶åä½¿ç”¨å¿«æ·åŒ¹é…æ¨¡å¼ï¼š/stop-writes-on-bgsave-error å®šä½åˆ° stop-writes-on-bgsave-error å­—ç¬¦ä¸²æ‰€åœ¨ä½ç½®ï¼Œæ¥ç€æŠŠåé¢çš„ yes è®¾ç½®ä¸º no å³å¯ã€‚</p><blockquote><p><strong>åŒæ—¶è®¾ç½®/è·å–å¤šä¸ªé”®å€¼</strong></p></blockquote><p><strong>è®¾ç½®</strong>ï¼š<code>MSET key value [key value ....]</code></p><p><strong>è·å–</strong>ï¼š<code>MGET key [key ....]</code></p><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" data-title="shell" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">127.0.0.1:6379</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt; </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">mset</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> k1</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> v1</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> k2</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> v2</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> k3</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> v3</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">OK</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">127.0.0.1:6379</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt; </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">mget</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> k1</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> k2</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> k3</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">1</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;v1&quot;</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">2</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;v2&quot;</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">3</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;v3&quot;</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">127.0.0.1:6379</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><blockquote><p><strong>æ•°å€¼å¢å‡</strong></p></blockquote><p><strong>é€’å¢æ•°å­—</strong>ï¼š<code>INCR key</code></p><p><strong>å¢åŠ æŒ‡å®šçš„æ•´æ•°</strong>ï¼š<code>INCRBY key increment</code></p><p><strong>é€’å‡æ•°å€¼</strong>ï¼š<code>DECR key</code></p><p><strong>å‡å°‘æŒ‡å®šçš„æ•´æ•°</strong>ï¼š<code>DECRBY key decrement</code></p><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" data-title="shell" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">127.0.0.1:6379</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt; </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">INCR</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> a1</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">integer</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">1</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">127.0.0.1:6379</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt; </span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">127.0.0.1:6379</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt; </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">INCR</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> a1</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">integer</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">2</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">127.0.0.1:6379</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt; </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">INCR</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> a1</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">integer</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">3</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">127.0.0.1:6379</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt; </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">INCR</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> a1</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">integer</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">4</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">127.0.0.1:6379</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt; </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">INCR</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> a1</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">integer</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">5</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">127.0.0.1:6379</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt; </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">decr</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> a1</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">integer</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">4</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">127.0.0.1:6379</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt; </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">incrby</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> a1</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 5</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">integer</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">9</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">127.0.0.1:6379</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt; </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">decrby</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> a1</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 3</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">integer</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">6</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">127.0.0.1:6379</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><blockquote><p><strong>è·å–å­—ç¬¦ä¸²é•¿åº¦</strong></p></blockquote><p><strong>å­—ç¬¦ä¸²é•¿åº¦</strong>ï¼š<code>STRLEN key</code></p><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" data-title="shell" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">127.0.0.1:6379</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt; </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">strlen</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> name</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">integer</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">5</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">127.0.0.1:6379</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><blockquote><p><strong>åˆ†å¸ƒå¼é”</strong></p></blockquote><p><strong>è®¾ç½®åˆ†å¸ƒå¼é”</strong>ï¼š<code>set key value [Ex seconds][PX milliseconds][NX|XX]</code></p><p><strong>å‚æ•°è§£é‡Š</strong>ï¼š</p><ol><li>EXï¼škey åœ¨å¤šå°‘ç§’ä¹‹åè¿‡æœŸ</li><li>PXï¼škey åœ¨å¤šå°‘æ¯«ç§’ä¹‹åè¿‡æœŸ</li><li>NXï¼šå½“ key ä¸å­˜åœ¨çš„æ—¶å€™ï¼Œæ‰åˆ›å»º keyï¼Œæ•ˆæœç­‰åŒäº<code>setnx key value</code></li><li>XXï¼šå½“ key å­˜åœ¨çš„æ—¶å€™ï¼Œè¦†ç›– key</li></ol><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" data-title="shell" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">127.0.0.1:6379</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt; </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">set</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> k1</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> v1</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> EX</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 10</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">OK</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">127.0.0.1:6379</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt; </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">ttl</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> k1</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">integer</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">6</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">127.0.0.1:6379</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt; </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">get</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> l1</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">nil</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">127.0.0.1:6379</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><blockquote><p><strong>åº”ç”¨åœºæ™¯</strong></p></blockquote><p><strong>1ã€å•†å“ç¼–å·ã€è®¢å•å·é‡‡ç”¨ INCR å‘½ä»¤ç”Ÿæˆ</strong></p><p><strong>2ã€æ–‡ç« é˜…è¯»é‡ã€ç‚¹èµæ•°å’Œåœ¨çœ‹æ•°</strong></p><figure><img src="/assets/img/7da43d9cdde95fff5b50c4119302fddc.7ce491e8.png" alt="image-20210127235408326" tabindex="0" loading="lazy"><figcaption>image-20210127235408326</figcaption></figure><h3 id="_2-3ã€hash" tabindex="-1"><a class="header-anchor" href="#_2-3ã€hash"><span>2.3ã€hash</span></a></h3><blockquote><p><strong>è·å–/è®¾ç½®å•ä¸ªå­—æ®µå€¼</strong></p></blockquote><p>redis ä¸­çš„ hash ç±»ä¼¼äº java ä¸­çš„ <code>Map&lt;String,Map&lt;Object,object&gt;&gt;</code> æ•°æ®ç»“æ„ï¼Œå³ä»¥å­—ç¬¦ä¸²ä¸º keyï¼Œä»¥ Map å¯¹è±¡ä¸º value</p><p><strong>æ·»åŠ ä¸€ä¸ª hash å¯¹è±¡</strong>ï¼š<code>HSET key field value</code></p><p><strong>è·å– hash å¯¹è±¡çš„å­—æ®µå€¼</strong>ï¼š<code>HGET key field</code></p><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" data-title="shell" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">127.0.0.1:6379</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt; </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">hset</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> person</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> oneby</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 25</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">integer</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">1</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">127.0.0.1:6379</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt; </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">hget</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> person</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> oneby</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">&quot;25&quot;</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">127.0.0.1:6379</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><blockquote><p><strong>åŒæ—¶è®¾ç½®/è·å–å¤šä¸ªå­—æ®µå€¼</strong></p></blockquote><p><strong>æ·»åŠ å¤šä¸ª hash å¯¹è±¡</strong>ï¼š<code>HMSET key field value [field value ...]</code></p><p><strong>è·å–å¤šä¸ª hash å¯¹è±¡çš„å­—æ®µå€¼</strong>ï¼š<code>HMGET key field [field ....]</code></p><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" data-title="shell" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">127.0.0.1:6379</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt; </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">hmset</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> persion</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> score</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 98</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> brith</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 20201010</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">OK</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">127.0.0.1:6379</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt; </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">hgetall</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> persion</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">1</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;score&quot;</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">2</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;98&quot;</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">3</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;brith&quot;</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">4</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;20201010&quot;</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">127.0.0.1:6379</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><blockquote><p><strong>è·å–æ‰€æœ‰å­—æ®µå€¼</strong></p></blockquote><p>è·å– key æ‰€å¯¹åº”æ‰€æœ‰çš„ hash å¯¹è±¡ï¼š<code>HGETALL key</code></p><figure><img src="/assets/img/ffcc3ef64ee95628f23f5140e1b1b699.fc1f9c48.png" alt="image-20210128205025070" tabindex="0" loading="lazy"><figcaption>image-20210128205025070</figcaption></figure><blockquote><p><strong>è·å–æŸä¸ª key å†…çš„å…¨éƒ¨æ•°é‡</strong></p></blockquote><p>è·å– key å¯¹åº”çš„æ‰€æœ‰ hash å¯¹è±¡ä¸ªæ•°ï¼š<code>HLEN key</code></p><figure><img src="/assets/img/352ab1f790c84068478b02117fed96d8.a1af99e5.png" alt="image-20210128205524945" tabindex="0" loading="lazy"><figcaption>image-20210128205524945</figcaption></figure><blockquote><p><strong>åˆ¤æ–­æ˜¯å¦å­˜åœ¨</strong></p></blockquote><p>åˆ¤æ–­å­—æ®µåä¸º field çš„ hash å¯¹è±¡æ˜¯å¦å­˜åœ¨ï¼š<code>HEXISTS key field</code></p><figure><img src="/assets/img/83e89ecbc6e2d1df2063d83acbaff6b1.2c65cf5b.png" alt="image-20210128211618862" tabindex="0" loading="lazy"><figcaption>image-20210128211618862</figcaption></figure><blockquote><p><strong>åˆ é™¤ä¸€ä¸ª key</strong></p></blockquote><p>åˆ é™¤ä¸€ä¸ª hash å¯¹è±¡ï¼š<code>HDEL key</code></p><figure><img src="/assets/img/81fd91d767519b31f23a7b5e28bfb389.504efee3.png" alt="image-20210128205619662" tabindex="0" loading="lazy"><figcaption>image-20210128205619662</figcaption></figure><blockquote><p><strong>æ•°å€¼å¢å‡</strong></p></blockquote><p>å¦‚ä½• key å’Œ field ä¸å­˜åœ¨ï¼Œåˆ™åˆå§‹å€¼ä¸º 0ï¼Œå¦åˆ™åœ¨ä¹‹å‰çš„æ•°å€¼ä¸Šé€’å¢ï¼š<code>HINCRBY key field increment</code></p><figure><img src="/assets/img/b9e802af5a3ea40d97418bd3c0c183d2.9d97719a.png" alt="image-20210128211850894" tabindex="0" loading="lazy"><figcaption>image-20210128211850894</figcaption></figure><blockquote><p><strong>åº”ç”¨åœºæ™¯</strong></p></blockquote><p>è´­ç‰©è½¦æ—©æœŸç‰ˆæœ¬ï¼Œå¯åœ¨å°ä¸­å‚é¡¹ç›®ä¸­ä½¿ç”¨</p><ol><li>æ–°å¢å•†å“ï¼š<code>hset shopcar:uid1024 334488 1</code></li><li>æ–°å¢å•†å“ï¼š<code>hset shopcar:uid1024 334477 1</code></li><li>å¢åŠ å•†å“æ•°é‡ï¼š<code>hincrby shopcar:uid1024 334477 1</code></li><li>å•†å“æ€»æ•°ï¼š<code>hlen shopcar:uid1024</code></li><li>å…¨éƒ¨é€‰æ‹©ï¼š<code>hgetall shopcar:uid1024</code></li></ol><figure><img src="/assets/img/d1b66d90dfbaab24679e9684c1802d73.7e77ca8d.png" alt="image-20210128211421555" tabindex="0" loading="lazy"><figcaption>image-20210128211421555</figcaption></figure><h3 id="_2-4ã€list" tabindex="-1"><a class="header-anchor" href="#_2-4ã€list"><span>2.4ã€list</span></a></h3><p>ä¸å…¶è¯´ list æ˜¯ä¸ªé›†åˆï¼Œè¿˜ä¸å¦‚è¯´ list æ˜¯ä¸ªåŒç«¯é˜Ÿåˆ—</p><blockquote><p><strong>æ·»åŠ å…ƒç´  &amp; æŸ¥çœ‹åˆ—è¡¨</strong></p></blockquote><ol><li>å‘ list å·¦è¾¹æ·»åŠ å…ƒç´ ï¼Œå¦‚æœ list ä¸å­˜åœ¨åˆ™åˆ›å»ºè¯¥ listï¼š<code>LPUSH key value [value ...]</code></li><li>å‘ list å³è¾¹æ·»åŠ å…ƒç´ ï¼Œå¦‚æœ list ä¸å­˜åœ¨åˆ™åˆ›å»ºè¯¥ listï¼š<code>RPUSH key value [value ....]</code></li><li>æŸ¥çœ‹ list ä¸­åŒ…å«çš„å…ƒç´ ï¼š<code>LRANGE key start stop</code>ï¼Œæ³¨ï¼š<code>LRANGE key 0 -1</code> è¡¨ç¤ºæŸ¥çœ‹ list ä¸­æ‰€æœ‰çš„å…ƒç´ </li></ol><figure><img src="/assets/img/7f580a6cf272354b90607944949877b2.31f85b3d.png" alt="image-20210128212718522" tabindex="0" loading="lazy"><figcaption>image-20210128212718522</figcaption></figure><blockquote><p><strong>åˆ é™¤å…ƒç´ </strong></p></blockquote><ol><li>ä»å·¦è¾¹å‡ºé˜Ÿï¼š<code>LPOP key</code></li><li>ä»å³è¾¹å‡ºé˜Ÿï¼š<code>RPOP key</code></li></ol><figure><img src="/assets/img/f6eb9f2358ddfab7abe98fa7f95e02cb.77fcf67b.png" alt="image-20210128213910671" tabindex="0" loading="lazy"><figcaption>image-20210128213910671</figcaption></figure><blockquote><p><strong>è·å–åˆ—è¡¨ä¸­å…ƒç´ çš„ä¸ªæ•°</strong></p></blockquote><p>æŸ¥çœ‹ list ä¸­åŒ…å«å‡ ä¸ªå…ƒç´ ï¼š<code>LLEN key</code></p><figure><img src="/assets/img/239eb8c4809522426c2a475719283acd.64b3bf9d.png" alt="image-20210128212830391" tabindex="0" loading="lazy"><figcaption>image-20210128212830391</figcaption></figure><blockquote><p><strong>åº”ç”¨åœºæ™¯</strong></p></blockquote><p>å¾®ä¿¡æ–‡ç« è®¢é˜…å…¬ä¼—å·</p><ol><li>æ¯”å¦‚æˆ‘è®¢é˜…äº†å¦‚ä¸‹ä¸¤ä¸ªå…¬ä¼—å·ï¼Œä»–ä»¬å‘å¸ƒäº†ä¸¤ç¯‡æ–‡ç« ï¼Œæ–‡ç«  ID åˆ†åˆ«ä¸º 666 å’Œ 888ï¼Œå¯ä»¥é€šè¿‡æ‰§è¡Œ <code>LPUSH likearticle:onebyId 666 888</code> å‘½ä»¤æ¨é€ç»™æˆ‘</li><li>æŸ¥çœ‹æˆ‘è‡ªå·±çš„å·è®¢é˜…çš„å…¨éƒ¨æ–‡ç« ï¼Œç±»ä¼¼åˆ†é¡µï¼Œä¸‹é¢0~10å°±æ˜¯ä¸€æ¬¡æ˜¾ç¤º10æ¡ï¼š<code>LPUSH likearticle:onebyId 0 10</code></li></ol><figure><img src="/assets/img/6603fe66ea435add800602cc3afc4b6a.862e297d.png" alt="image-20210128213123998" tabindex="0" loading="lazy"><figcaption>image-20210128213123998</figcaption></figure><h3 id="_2-5ã€set" tabindex="-1"><a class="header-anchor" href="#_2-5ã€set"><span>2.5ã€set</span></a></h3><blockquote><p><strong>æ·»åŠ å…ƒç´  &amp; åˆ é™¤å…ƒç´  &amp; æŸ¥çœ‹å…ƒç´ </strong></p></blockquote><ol><li>å‘ set ä¸­æ·»åŠ ä¸€ä¸ªå…ƒç´ ï¼š<code>SADD key member[member ...]</code></li><li>åˆ é™¤ set ä¸­çš„æŒ‡å®šå…ƒç´ ï¼š<code>SREM key member [member ...]</code></li><li>è·å– set ä¸­çš„æ‰€æœ‰å…ƒç´ ï¼š<code>SMEMBERS key</code></li></ol><figure><img src="/assets/img/86aba03de0215b26efc68004cc085a8e.dbd32079.png" alt="image-20210128214344652" tabindex="0" loading="lazy"><figcaption>image-20210128214344652</figcaption></figure><blockquote><p><strong>åˆ¤æ–­å…ƒç´ æ˜¯å¦åœ¨é›†åˆä¸­</strong></p></blockquote><p>åˆ¤æ–­æŒ‡å®šå…ƒç´ æ˜¯å¦åœ¨ set ä¸­ï¼š<code>SISMEMBER key member</code></p><figure><img src="/assets/img/dcb378d391f6df59419ff51cf4b06472.6bf18333.png" alt="image-20210128224102125" tabindex="0" loading="lazy"><figcaption>image-20210128224102125</figcaption></figure><blockquote><p><strong>è·å–é›†åˆä¸­çš„å…ƒç´ ä¸ªæ•°</strong></p></blockquote><p>è·å– set ä¸­å…ƒç´ çš„ä¸ªæ•°ï¼š<code>SCARD key</code></p><figure><img src="/assets/img/8cdf34a73521918eb0e3b4aacb78e265.884d5740.png" alt="image-20210128224221240" tabindex="0" loading="lazy"><figcaption>image-20210128224221240</figcaption></figure><blockquote><p><strong>ä»é›†åˆä¸­éšæœºå¼¹å‡ºå…ƒç´ </strong></p></blockquote><ol><li>ä»é›†åˆä¸­éšæœºå¼¹å‡ºå…ƒç´ ï¼Œå…ƒç´ ä¸åˆ é™¤ï¼š<code>SRANDMEMBER key [æ•°å­—]</code></li><li>ä»é›†åˆä¸­éšæœºå¼¹å‡ºä¸€ä¸ªå…ƒç´ ï¼Œå‡ºå‡ ä¸ªåˆ å‡ ä¸ªï¼š<code>SPOP key[æ•°å­—]</code></li></ol><figure><img src="/assets/img/faa0e20de00b6ebed72e61e48be9cb6b.0cf8dcf1.png" alt="image-20210128225505073" tabindex="0" loading="lazy"><figcaption>image-20210128225505073</figcaption></figure><blockquote><p><strong>é›†åˆè¿ç®—</strong></p></blockquote><ol><li>é›†åˆçš„å·®é›†è¿ç®—A-Bï¼š<code>SDIFF key [key ...]</code>ï¼Œå±äºAä½†ä¸å±äºBçš„å…ƒç´ æ„æˆçš„é›†åˆ</li><li>é›†åˆçš„äº¤é›†è¿ç®—Aâˆ©Bï¼š<code>SINTER key [key ...]</code>ï¼Œå±äºAåŒæ—¶ä¹Ÿå±äºBçš„å…±åŒæ‹¥æœ‰çš„å…ƒç´ æ„æˆçš„é›†åˆ</li><li>é›†åˆçš„å¹¶é›†è¿ç®—AUBï¼š<code>SUNION key [key ...]</code>ï¼Œå±äºAæˆ–è€…å±äºBçš„å…ƒç´ åˆå¹¶åçš„é›†åˆ</li></ol><figure><img src="/assets/img/46eb101fdddd1aebf2e6562ba16b12c2.a729f28f.png" alt="image-20210128224623392" tabindex="0" loading="lazy"><figcaption>image-20210128224623392</figcaption></figure><blockquote><p><strong>åº”ç”¨åœºæ™¯</strong></p></blockquote><p><strong>1ã€å¾®ä¿¡æŠ½å¥–å°ç¨‹åº</strong></p><ol><li>å¦‚æœæŸä¸ªç”¨æˆ·ç‚¹å‡»äº†ç«‹å³å‚ä¸æŒ‰é’®ï¼Œåˆ™æ‰§è¡Œ <code>sadd key useId</code> å‘½ä»¤å°†è¯¥ç”¨æˆ· ID æ·»åŠ è‡³ set ä¸­</li><li>æ˜¾ç¤ºå·²ç»æœ‰å¤šå°‘äººå‚ä¸äº†æŠ½å¥–ï¼š<code>SCARD key</code></li><li>æŠ½å¥–(ä»setä¸­ä»»æ„é€‰å–Nä¸ªä¸­å¥–äºº) <ol><li>éšæœºæŠ½å¥–2ä¸ªäººï¼Œå…ƒç´ ä¸åˆ é™¤ï¼š<code>SRANDMEMBER key 2</code></li><li>éšæœºæŠ½å¥–3ä¸ªäººï¼Œå…ƒç´ ä¼šåˆ é™¤ï¼š<code>SPOP key 3</code></li></ol></li></ol><figure><img src="/assets/img/e4b8bef2d792bfc0236812aea3b7f029.8bf6b4d9.png" alt="image-20210128225210254" tabindex="0" loading="lazy"><figcaption>image-20210128225210254</figcaption></figure><hr><p><strong>2ã€å¾®ä¿¡æœ‹å‹åœˆç‚¹èµ</strong></p><ol><li>æ–°å¢ç‚¹èµï¼š<code>SADD pub:msgID ç‚¹èµç”¨æˆ·ID1 ç‚¹èµç”¨æˆ·ID2</code></li><li>å–æ¶ˆç‚¹èµï¼š<code>SREM pub:msgID ç‚¹èµç”¨æˆ·ID</code></li><li>å±•ç°æ‰€æœ‰ç‚¹èµè¿‡çš„ç”¨æˆ·ï¼š<code>SMEMBERS pub:msgID</code></li><li>ç‚¹èµç”¨æˆ·æ•°ç»Ÿè®¡ï¼Œå°±æ˜¯å¸¸è§çš„ç‚¹èµçº¢è‰²æ•°å­—ï¼š<code>SCARD pub.msgID</code></li><li>åˆ¤æ–­æŸä¸ªæœ‹å‹æ˜¯å¦å¯¹æ¥¼ä¸»ç‚¹èµè¿‡ï¼š<code>SISMEMBER pub:msgID ç”¨æˆ·ID</code></li></ol><figure><img src="/assets/img/dbcc8ec2d6c163169a2cba99af38b542.894430ed.png" alt="image-20210128230328171" tabindex="0" loading="lazy"><figcaption>image-20210128230328171</figcaption></figure><hr><p><strong>3ã€Bilibili å…±åŒå…³æ³¨çš„å¥½å‹</strong></p><p>å…±åŒå…³æ³¨çš„å¥½å‹ï¼š<code>SINTER æˆ‘å…³æ³¨çš„äºº Taå…³æ³¨çš„äºº</code></p><figure><img src="/assets/img/879b3fce7f6204feec766738d9ec5a60.0b6b9581.png" alt="image-20210128230413453" tabindex="0" loading="lazy"><figcaption>image-20210128230413453</figcaption></figure><hr><p><strong>4ã€QQå†…æ¨å¯èƒ½è®¤è¯†çš„äºº</strong></p><p>QQ å…±åŒå¥½å‹ï¼š<code>SINTER æˆ‘çš„å¥½å‹ Taçš„å¥½å‹</code></p><figure><img src="/assets/img/e89122a368917a5fcd4bf0675efcdeb5.21c72632.png" alt="image-20210128230723385" tabindex="0" loading="lazy"><figcaption>image-20210128230723385</figcaption></figure><h3 id="_2-6ã€zset" tabindex="-1"><a class="header-anchor" href="#_2-6ã€zset"><span>2.6ã€zset</span></a></h3><p>å½¢è±¡ç†è§£ zsetï¼šå‘æœ‰åºé›†åˆä¸­åŠ å…¥ä¸€ä¸ªå…ƒç´ å’Œè¯¥å…ƒç´ çš„åˆ†æ•°</p><blockquote><p><strong>æ·»åŠ å…ƒç´  &amp; åˆ é™¤å…ƒç´  &amp; è·å–å…ƒç´ </strong></p></blockquote><ol><li>å‘ zset ä¸­æ·»åŠ ä¸€ä¸ªå¸¦åˆ†æ•°ï¼ˆæƒå€¼ï¼‰çš„å…ƒç´ ï¼š<code>ZADD key score member [score member ...]</code></li><li>åˆ é™¤ zset ä¸­çš„æŒ‡å®šå…ƒç´ ï¼š<code>ZREM key member [member ...]</code></li><li>è¿”å›ç´¢å¼•ä»startåˆ°stopä¹‹é—´çš„æ‰€æœ‰å…ƒç´ ï¼Œå¹¶æŒ‰ç…§å…ƒç´ åˆ†æ•°ä»å°åˆ°å¤§çš„é¡ºåºï¼š<code>ZRANGE key start stop [WITHSCORES]</code>ï¼Œæ³¨ï¼šå¦‚æœæƒ³è¦è·å–æ‰€æœ‰å…ƒç´ å¹¶ä¸”ä»å°åˆ°å¤§æ’åºï¼Œå¯å†™ä¸º <code>ZRANGE key 0 -1</code></li></ol><figure><img src="/assets/img/35176a1cb1602f9bb0a44fe7e187082e.765fa4d9.png" alt="image-20210128231731769" tabindex="0" loading="lazy"><figcaption>image-20210128231731769</figcaption></figure><blockquote><p><strong>è·å–å…ƒç´ çš„åˆ†æ•°</strong></p></blockquote><p>è·å–æŒ‡å®šå…ƒç´ çš„åˆ†æ•°ï¼š<code>ZSCORE key member</code></p><figure><img src="/assets/img/eb712eda46427d7529b260e26a637dd6.3995fb5a.png" alt="image-20210128231849177" tabindex="0" loading="lazy"><figcaption>image-20210128231849177</figcaption></figure><blockquote><p><strong>è·å–æŒ‡å®šåˆ†æ•°èŒƒå›´çš„å…ƒç´ </strong></p></blockquote><p>è·å–æŒ‡å®šåˆ†æ•°èŒƒå›´çš„å…ƒç´ ï¼š<code>ZRANGEBYSCORE key min max [WITHSCORES] [LIMIT offset count]</code></p><figure><img src="/assets/img/a67748e43f96fde8e87e0a103e2f8690.b2f579b2.png" alt="image-20210128232342877" tabindex="0" loading="lazy"><figcaption>image-20210128232342877</figcaption></figure><blockquote><p><strong>è·å–é›†åˆä¸­å…ƒç´ çš„æ•°é‡</strong></p></blockquote><p>è·å–é›†åˆä¸­å…ƒç´ çš„æ•°é‡ï¼š<code>ZCARD key</code></p><figure><img src="/assets/img/bb317a5f15255d035058455688289299.2d9c7fb6.png" alt="image-20210128232512729" tabindex="0" loading="lazy"><figcaption>image-20210128232512729</figcaption></figure><blockquote><p><strong>è·å¾—æŒ‡å®šåˆ†æ•°èŒƒå›´å†…çš„å…ƒç´ ä¸ªæ•°</strong></p></blockquote><p>è·å¾—æŒ‡å®šåˆ†æ•°èŒƒå›´å†…çš„å…ƒç´ ä¸ªæ•°ï¼š<code>ZCOUNT key min max</code></p><figure><img src="/assets/img/204cf6417f93af82056167b1172862e4.7d2410b8.png" alt="image-20210128232651755" tabindex="0" loading="lazy"><figcaption>image-20210128232651755</figcaption></figure><blockquote><p><strong>å¢åŠ æŸä¸ªå…ƒç´ çš„åˆ†æ•°</strong></p></blockquote><p>å¢åŠ æŸä¸ªå…ƒç´ çš„åˆ†æ•°ï¼š<code>ZINCRBY key increment member</code></p><figure><img src="/assets/img/3b83d15a8f5b36f835dc73674b3a60cb.a4c0e096.png" alt="image-20210128232819305" tabindex="0" loading="lazy"><figcaption>image-20210128232819305</figcaption></figure><blockquote><p><strong>æŒ‰ç…§æ’åèŒƒå›´åˆ é™¤å…ƒç´ </strong></p></blockquote><p>æŒ‰ç…§æ’åèŒƒå›´åˆ é™¤å…ƒç´ ï¼š<code>ZREMRANGEBYRANK key start stop</code></p><figure><img src="/assets/img/2b5477fea034095745d5dc30065028f8.4bd5a6f3.png" alt="image-20210128233059793" tabindex="0" loading="lazy"><figcaption>image-20210128233059793</figcaption></figure><blockquote><p><strong>è·å–å…ƒç´ çš„æ’å</strong></p></blockquote><p>ä»å°åˆ°å¤§ï¼š<code>ZRANK key member</code></p><p>ä»å¤§åˆ°å°ï¼š<code>ZREVRANK key member</code></p><figure><img src="/assets/img/2818e8b6901ff314c33cbcd192d15ecc.618cf025.png" alt="image-20210128233322102" tabindex="0" loading="lazy"><figcaption>image-20210128233322102</figcaption></figure><blockquote><p><strong>åº”ç”¨åœºæ™¯</strong></p></blockquote><p><strong>1ã€æ ¹æ®å•†å“é”€å”®å¯¹å•†å“è¿›è¡Œæ’åºæ˜¾ç¤º</strong></p><p>æ€è·¯:å®šä¹‰å•†å“é”€å”®æ’è¡Œæ¦œ(sorted seté›†åˆ)ï¼Œkeyä¸ºgoods:sellsortï¼Œåˆ†æ•°ä¸ºå•†å“é”€å”®æ•°é‡ã€‚</p><ol><li>å•†å“ç¼–å·1001çš„é”€é‡æ˜¯9ï¼Œå•†å“ç¼–å·1002çš„é”€é‡æ˜¯15ï¼š<code>ZADD goods:sellsort 9 1001 15 1002</code></li><li>æœ‰ä¸€ä¸ªå®¢æˆ·åˆä¹°äº†2ä»¶å•†å“1001ï¼Œå•†å“ç¼–å·1001é”€é‡åŠ 2ï¼š<code>ZINCRBY goods:sellsort 2 1001</code></li><li>æ±‚å•†å“é”€é‡å‰10åï¼š<code>ZRANGE goods:sellsort 0 10 WITHSCORES</code></li></ol><figure><img src="/assets/img/414653aa0aa091a76a9e4c27d521d63c.78514892.png" alt="image-20210128233926925" tabindex="0" loading="lazy"><figcaption>image-20210128233926925</figcaption></figure><hr><p><strong>2ã€æŠ–éŸ³çƒ­æœ</strong></p><ol><li><p>ç‚¹å‡»è§†é¢‘å¢åŠ æ’­æ”¾é‡ï¼š<code>ZINCRBY hotvcr:20200919 1å…«ä½°</code>ï¼Œ<code>ZINCRBY hotvcr:20200919 15 å…«ä½° 2 èŠ±æœ¨å…°</code></p></li><li><p>å±•ç¤ºå½“æ—¥æ’è¡Œå‰10æ¡ï¼š<code>ZREVRANGE hotvcr:20200919 0 9 WITHSCORES</code></p></li></ol><figure><img src="/assets/img/6f6411bd597f0901680f981c6361191a.e9925473.png" alt="image-20210128233458432" tabindex="0" loading="lazy"><figcaption>image-20210128233458432</figcaption></figure><h2 id="_3ã€redis-åˆ†å¸ƒå¼é”" tabindex="-1"><a class="header-anchor" href="#_3ã€redis-åˆ†å¸ƒå¼é”"><span>3ã€Redis åˆ†å¸ƒå¼é”</span></a></h2><blockquote><p><strong>é¢è¯•å®˜ï¼šä¸­é—¨æ¥å¯¹ç‹™</strong></p></blockquote><p>çŸ¥é“åˆ†å¸ƒå¼é”å—ï¼Ÿæœ‰å“ªäº›å®ç°æ–¹æ¡ˆï¼Ÿ ä½ è°ˆè°ˆå¯¹redisåˆ†å¸ƒå¼é”çš„ç†è§£ï¼Œ åˆ keyçš„æ—¶å€™æœ‰ä»€ä¹ˆé—®é¢˜ï¼Ÿ 1ã€MySQL 2ã€zookeeper 3ã€redis</p><p>ä¸€èˆ¬çš„äº’è”å…¬å¸ç”¨çš„rediså®ç°ã€‚</p><h3 id="_3-1ã€åˆ†å¸ƒå¼é”çš„é¢è¯•é¢˜" tabindex="-1"><a class="header-anchor" href="#_3-1ã€åˆ†å¸ƒå¼é”çš„é¢è¯•é¢˜"><span>3.1ã€åˆ†å¸ƒå¼é”çš„é¢è¯•é¢˜</span></a></h3><blockquote><p><strong>åˆ†å¸ƒå¼é”çš„å¸¸è§é¢è¯•é¢˜</strong></p></blockquote><ol><li><p>Redisé™¤äº†æ‹¿æ¥åšç¼“å­˜ï¼Œä½ è¿˜è§è¿‡åŸºäºRedisçš„ä»€ä¹ˆç”¨æ³•?</p></li><li><p>Redisåšåˆ†å¸ƒå¼é”çš„æ—¶å€™æœ‰éœ€è¦æ³¨æ„çš„é—®é¢˜?</p></li><li><p>å¦‚æœæ˜¯Redisæ˜¯å•ç‚¹éƒ¨ç½²çš„ï¼Œä¼šå¸¦æ¥ä»€ä¹ˆé—®é¢˜? é‚£ä½ å‡†å¤‡æ€ä¹ˆè§£å†³å•ç‚¹é—®é¢˜å‘¢?</p></li><li><p>é›†ç¾¤æ¨¡å¼ä¸‹ï¼Œæ¯”å¦‚ä¸»ä»æ¨¡å¼ï¼Œæœ‰æ²¡æœ‰ä»€ä¹ˆé—®é¢˜å‘¢?</p></li><li><p>é‚£ä½ ç®€å•çš„ä»‹ç»ä¸€ä¸‹Redlockå§? ä½ ç®€å†ä¸Šå†™redissonï¼Œä½ è°ˆè°ˆ</p></li><li><p>Redisåˆ†å¸ƒå¼é”å¦‚ä½•ç»­æœŸ?çœ‹é—¨ç‹—çŸ¥é“å—?</p></li></ol><h3 id="_3-2ã€æ­å»ºè¶…å–å·¥ç¨‹" tabindex="-1"><a class="header-anchor" href="#_3-2ã€æ­å»ºè¶…å–å·¥ç¨‹"><span>3.2ã€æ­å»ºè¶…å–å·¥ç¨‹</span></a></h3><h4 id="_3-2-1ã€centos-å›ºå®š-ip-åœ°å€" tabindex="-1"><a class="header-anchor" href="#_3-2-1ã€centos-å›ºå®š-ip-åœ°å€"><span>3.2.1ã€CentOS å›ºå®š IP åœ°å€</span></a></h4><blockquote><p><strong>å‡†å¤‡å·¥ä½œï¼šCentOS å›ºå®š IP è®¾ç½®</strong></p></blockquote><p><strong>å‰è¨€</strong>ï¼šæœ¬æ¥ä¸æƒ³é…ç½®ï¼Œç»“æœç¡äº†ä¸€è§‰èµ·æ¥ï¼ŒCentOS çš„ IP åœ°å€å°±å˜äº†</p><hr><p><strong>å‚è€ƒèµ„æ–™</strong>ï¼š</p><ol><li><a href="https://www.cnblogs.com/lfhappy/p/10798400.html" target="_blank" rel="noopener noreferrer">centOS7è™šæ‹Ÿæœºè®¾ç½®å›ºå®šIP</a></li><li><a href="https://blog.csdn.net/sjhuangx/article/details/79618865" target="_blank" rel="noopener noreferrer">centos7è®¾ç½®é™æ€IPåœ°å€</a></li></ol><hr><p><strong>1ã€è®¾ç½®è™šæ‹Ÿæœºçš„ç½‘ç»œè¿æ¥æ–¹å¼ä¸º NAT æ¨¡å¼</strong></p><figure><img src="/assets/img/a11a318ca8d15247d7f3dd12de2a88a4.6fa29ed3.png" alt="image-20210203100155618" tabindex="0" loading="lazy"><figcaption>image-20210203100155618</figcaption></figure><p><strong>2ã€é…ç½®è™šæ‹Ÿæœº NAT æ¨¡å¼çš„ç½‘ç»œå‚æ•°</strong></p><p>é€‰æ‹©ã€ç¼–è¾‘ã€‘â€“&gt;ã€è™šæ‹Ÿç½‘ç»œç¼–è¾‘å™¨ã€‘ï¼Œç‚¹å‡»ã€æ›´æ”¹è®¾ç½®ã€‘</p><figure><img src="/assets/img/99dca919fa054dba43b004c6c4ad9573.ba98e8c7.png" alt="image-20210203100644717" tabindex="0" loading="lazy"><figcaption>image-20210203100644717</figcaption></figure><p>é€‰æ‹©ã€NAT æ¨¡å¼ã€‘çš„ VMnet8</p><ol><li>å–æ¶ˆå‹¾é€‰ã€ä½¿ç”¨æœ¬åœ°DHCPæœåŠ¡å°†IPåœ°å€åˆ†é…ç»™è™šæ‹Ÿæœºã€‘ï¼Œç¦ç”¨è‡ªåŠ¨åˆ†é… IP åœ°å€çš„åŠŸèƒ½</li><li>è®¾ç½®ã€å­ç½‘ IPã€‘ä¸º 192.168.152.0</li><li>è®¾ç½®ã€å­ç½‘æ©ç ã€‘ä¸º 255.255.255.0ï¼Œè¡¨ç¤ºæœ€å 8 ä½ä¸ºä¸»æœºä½</li><li>ç‚¹å‡»ã€NAT è®¾ç½®ã€‘æŸ¥çœ‹å­ç½‘ç½‘å…³</li></ol><figure><img src="/assets/img/c482e04f9939102dfdb2b173f966344c.d223ee16.png" alt="image-20210203100855976" tabindex="0" loading="lazy"><figcaption>image-20210203100855976</figcaption></figure><p>å–ï¼Œç‚¹å‡»ã€NAT è®¾ç½®ã€‘æŸ¥çœ‹å­ç½‘ç½‘å…³ï¼ˆä¸è¦æ”¹è¿™ä¸ªè®¾ç½®ï¼Œæˆ‘æ”¹äº†å°±æŠŠæˆ‘è‡ªå·±å®³æƒ¨äº†ã€‚ã€‚ã€‚ï¼‰</p><figure><img src="/assets/img/7b2122f54bbfcc997beed0cefced1df6.7d25ac1e.png" alt="image-20210203101220750" tabindex="0" loading="lazy"><figcaption>image-20210203101220750</figcaption></figure><hr><p><strong>3ã€ä¿®æ”¹ CentOS ç½‘å¡å¯¹åº”çš„é…ç½®æ–‡ä»¶</strong></p><p>centos7 çš„ç½‘ç»œ IP åœ°å€é…ç½®æ–‡ä»¶åœ¨ <code>/etc/sysconfig/network-scripts</code> æ–‡ä»¶å¤¹ä¸‹ï¼Œä½¿ç”¨ <code>ifconfig</code> å‘½ä»¤æŸ¥çœ‹å½“å‰ç½‘å¡åç§°ï¼šens33</p><figure><img src="/assets/img/c507b046f7362d9fb22b6fed2f4bacad.fc1fb969.png" alt="image-20210203101957577" tabindex="0" loading="lazy"><figcaption>image-20210203101957577</figcaption></figure><p>ens33 ç½‘å¡å¯¹åº”çš„é…ç½®æ–‡ä»¶ä¸º ifcfg-ens33</p><figure><img src="/assets/img/9483896f4256714689c6b2871e7c1ffd.af086bd3.png" alt="image-20210203101719410" tabindex="0" loading="lazy"><figcaption>image-20210203101719410</figcaption></figure><p>ä½¿ç”¨ <code>vim ifcfg-ens33</code> æŒ‡ä»¤ç¼–è¾‘é…ç½®æ–‡ä»¶ï¼Œå¡«å…¥å¦‚ä¸‹é…ç½®å†…å®¹ï¼ˆå¦‚æœæœ‰å°±ä¿®æ”¹ï¼Œæ²¡æœ‰å°±æ–°å¢ï¼‰</p><pre><code>BOOTPROTO=static        #å¼€æœºåè®®ï¼Œæœ‰dhcpåŠstaticï¼›
ONBOOT=yes              #è®¾ç½®ä¸ºå¼€æœºå¯åŠ¨ï¼›
DNS1=114.114.114.114    #è¿™ä¸ªæ˜¯å›½å†…çš„DNSåœ°å€ï¼Œæ˜¯å›ºå®šçš„ï¼›
IPADDR=192.168.152.233  #ä½ æƒ³è¦è®¾ç½®çš„å›ºå®šIPï¼Œç†è®ºä¸Š192.168.2.2-255ä¹‹é—´éƒ½å¯ä»¥ï¼Œè¯·è‡ªè¡ŒéªŒè¯ï¼›
NETMASK=255.255.255.0   #å­ç½‘æ©ç ï¼Œä¸éœ€è¦ä¿®æ”¹ï¼›
GATEWAY=192.168.152.5     #ç½‘å…³åœ°å€
</code></pre><figure><img src="/assets/img/ee772b76b0b21a725861a8d8b33b819b.6351657b.png" alt="image-20210203154554548" tabindex="0" loading="lazy"><figcaption>image-20210203154554548</figcaption></figure><p>å®Œæ•´çš„é…ç½®å¦‚ä¸‹ï¼Œä¸‹æ¬¡ç”¨çš„æ—¶å€™å°±å¯ä»¥ç›´æ¥å¤åˆ¶ç²˜è´´å•¦</p><pre><code>TYPE=Ethernet
PROXY_METHOD=none
BROWSER_ONLY=no
BOOTPROTO=static
DEFROUTE=yes
IPV4_FAILURE_FATAL=no
IPV6INIT=yes
IPV6_AUTOCONF=yes
IPV6_DEFROUTE=yes
IPV6_FAILURE_FATAL=no
IPV6_ADDR_GEN_MODE=stable-privacy
NAME=ens33
UUID=b15652db-78af-49cc-8f4e-ff601a1d5c5d
DEVICE=ens33
ONBOOT=yes
DNS1=114.114.114.114
IPADDR=192.168.152.233
NETMASK=255.255.255.0
GATEWAY=192.168.152.2
</code></pre><hr><p><strong>4ã€é‡å¯ç”Ÿæ•ˆ</strong></p><p>ä½¿ç”¨ <code>service network restart</code> é‡å¯ç½‘ç»œæœåŠ¡ï¼Œç„¶åä½¿ç”¨ <code>ifconfig</code> å‘½ä»¤æŸ¥çœ‹æœ¬æœº IP åœ°å€ï¼Œå·²ç»å˜ä¸º 192.168.152.233</p><figure><img src="/assets/img/5a6512a2051b32500a476c1a161bbee7.a57722aa.png" alt="image-20210203154705836" tabindex="0" loading="lazy"><figcaption>image-20210203154705836</figcaption></figure><p>åœ¨ CentOS ä¸­èƒ½å¤Ÿ ping é€š Windows</p><figure><img src="/assets/img/1b199001057efeb6dde12f5384257af2.a5951366.png" alt="image-20210203114750273" tabindex="0" loading="lazy"><figcaption>image-20210203114750273</figcaption></figure><p>åœ¨ Windows ä¸­ä¹Ÿèƒ½ ping é€š CentOS</p><figure><img src="/assets/img/8a3fdd284b4bc8106843bc0abe8e90cb.5f7277a2.png" alt="image-20210203103443246" tabindex="0" loading="lazy"><figcaption>image-20210203103443246</figcaption></figure><h4 id="_3-2-2ã€è¶…å–å·¥ç¨‹æµ‹è¯•è¯´æ˜" tabindex="-1"><a class="header-anchor" href="#_3-2-2ã€è¶…å–å·¥ç¨‹æµ‹è¯•è¯´æ˜"><span>3.2.2ã€è¶…å–å·¥ç¨‹æµ‹è¯•è¯´æ˜</span></a></h4><blockquote><p><strong>Redis åˆ†å¸ƒå¼é”æµ‹è¯•è¯´æ˜</strong></p></blockquote><p><strong>æµ‹è¯•ç›®çš„</strong>ï¼šå¤šä¸ªæœåŠ¡é—´ä¿è¯åŒä¸€æ—¶åˆ»åŒä¸€æ—¶é—´æ®µå†…åŒä¸€ç”¨æˆ·åªèƒ½æœ‰ä¸€ä¸ªè¯·æ±‚(é˜²æ­¢å…³é”®ä¸šåŠ¡å‡ºç°å¹¶å‘æ”»å‡»)</p><p><strong>ä¸¤ä¸ª Module</strong>ï¼šboot_redis01 å’Œ boot_redis02</p><figure><img src="/assets/img/40140d85d0c7a0450f98b7ff3b86e3aa.0d2ddfb3.png" alt="image-20210202184529015" tabindex="0" loading="lazy"><figcaption>image-20210202184529015</figcaption></figure><h4 id="_3-2-3ã€æ­å»º-springboot-å·¥ç¨‹" tabindex="-1"><a class="header-anchor" href="#_3-2-3ã€æ­å»º-springboot-å·¥ç¨‹"><span>3.2.3ã€æ­å»º SpringBoot å·¥ç¨‹</span></a></h4><blockquote><p><strong>æ­å»º SpringBoot å·¥ç¨‹çš„æ­¥éª¤</strong></p></blockquote><ol><li>æ–°å»º Module æˆ–è€… Maven å­å·¥ç¨‹</li><li>ç¼–å†™ pom.xml ç®¡ç†å·¥ç¨‹ä¾èµ–</li><li>ç¼–å†™ application.yml é…ç½®æ–‡ä»¶ï¼ˆæˆ–è€… application.properties é…ç½®æ–‡ä»¶ï¼‰</li><li>ç¼–å†™ä¸»å¯åŠ¨ç±»</li><li>ç¼–å†™é…ç½®ç±»</li><li>ç¼–å†™ä¸šåŠ¡ç±»</li><li>ä»£ç æµ‹è¯•</li></ol><blockquote><p><strong>boot_redis01 å·¥ç¨‹</strong></p></blockquote><ol><li><p>ä¿®æ”¹ pom.xnl æ–‡ä»¶</p><pre><code>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;project xmlns=&quot;http://maven.apache.org/POM/4.0.0&quot;
         xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;
         xsi:schemaLocation=&quot;http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd&quot;&gt;
    &lt;parent&gt;
        &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
        &lt;artifactId&gt;spring-boot-starter-parent&lt;/artifactId&gt;
        &lt;version&gt;2.3.3.RELEASE&lt;/version&gt;
        &lt;relativePath/&gt; &lt;!-- lookup parent from repository --&gt;
    &lt;/parent&gt;
    &lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt;

    &lt;groupId&gt;com.oneby&lt;/groupId&gt;
    &lt;artifactId&gt;boot_redis01&lt;/artifactId&gt;
    &lt;version&gt;1.0-SNAPSHOT&lt;/version&gt;

    &lt;properties&gt;
        &lt;java.version&gt;1.8&lt;/java.version&gt;
    &lt;/properties&gt;

    &lt;dependencies&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
            &lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt;
        &lt;/dependency&gt;

        &lt;!-- https://mvnrepository.com/artifact/org.springframework.boot/spring-boot-starter-actuator --&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
            &lt;artifactId&gt;spring-boot-starter-actuator&lt;/artifactId&gt;
        &lt;/dependency&gt;

        &lt;!-- https://mvnrepository.com/artifact/org.springframework.boot/spring-boot-starter-data-redis --&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
            &lt;artifactId&gt;spring-boot-starter-data-redis&lt;/artifactId&gt;
        &lt;/dependency&gt;

        &lt;!-- https://mvnrepository.com/artifact/org.apache.commons/commons-pool2 --&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;org.apache.commons&lt;/groupId&gt;
            &lt;artifactId&gt;commons-pool2&lt;/artifactId&gt;
        &lt;/dependency&gt;

        &lt;!-- https://mvnrepository.com/artifact/redis.clients/jedis --&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;redis.clients&lt;/groupId&gt;
            &lt;artifactId&gt;jedis&lt;/artifactId&gt;
            &lt;version&gt;3.1.0&lt;/version&gt;
        &lt;/dependency&gt;

        &lt;!-- https://mvnrepository.com/artifact/org.springframework.boot/spring-boot-starter-aop --&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
            &lt;artifactId&gt;spring-boot-starter-aop&lt;/artifactId&gt;
        &lt;/dependency&gt;

        &lt;!-- https://mvnrepository.com/artifact/org.redisson/redisson --&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;org.redisson&lt;/groupId&gt;
            &lt;artifactId&gt;redisson&lt;/artifactId&gt;
            &lt;version&gt;3.13.4&lt;/version&gt;
        &lt;/dependency&gt;

        &lt;dependency&gt;
            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
            &lt;artifactId&gt;spring-boot-devtools&lt;/artifactId&gt;
            &lt;scope&gt;runtime&lt;/scope&gt;
            &lt;optional&gt;true&lt;/optional&gt;
        &lt;/dependency&gt;

        &lt;dependency&gt;
            &lt;groupId&gt;org.projectlombok&lt;/groupId&gt;
            &lt;artifactId&gt;lombok&lt;/artifactId&gt;
            &lt;optional&gt;true&lt;/optional&gt;
        &lt;/dependency&gt;

        &lt;dependency&gt;
            &lt;groupId&gt;junit&lt;/groupId&gt;
            &lt;artifactId&gt;junit&lt;/artifactId&gt;
            &lt;version&gt;4.12&lt;/version&gt;
        &lt;/dependency&gt;
    &lt;/dependencies&gt;

    &lt;build&gt;
        &lt;plugins&gt;
            &lt;plugin&gt;
                &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
                &lt;artifactId&gt;spring-boot-maven-plugin&lt;/artifactId&gt;
            &lt;/plugin&gt;
        &lt;/plugins&gt;
    &lt;/build&gt;

&lt;/project&gt;
</code></pre></li><li><p>æ–°å»º application.properties é…ç½®æ–‡ä»¶</p><pre><code>server.port=1111

spring.redis.database=0
spring.redis.host=
spring.redis.port=6379
#è¿æ¥æ± æœ€å¤§è¿æ¥æ•°ï¼ˆä½¿ç”¨è´Ÿå€¼è¡¨ç¤ºæ²¡æœ‰é™åˆ¶ï¼‰é»˜è®¤8
spring.redis.lettuce.pool.max-active=8
#è¿æ¥æ± æœ€å¤§é˜»å¡ç­‰å¾…æ—¶é—´ï¼ˆä½¿ç”¨è´Ÿå€¼è¡¨ç¤ºæ²¡æœ‰é™åˆ¶ï¼‰é»˜è®¤-1
spring.redis.lettuce.pool.max-wait=-1
#è¿æ¥æ± ä¸­çš„æœ€å¤§ç©ºé—²è¿æ¥é»˜è®¤8
spring.redis.lettuce.pool.max-idle=8
#è¿æ¥æ± ä¸­çš„æœ€å°ç©ºé—²è¿æ¥é»˜è®¤0
spring.redis.lettuce.pool.min-idle=0
</code></pre></li><li><p>æ–°å»º <code>BootRedis01Application</code> ä¸»å¯åŠ¨ç±»</p><pre><code>/**
 * @ClassName BootRedis01Application
 * @Description TODO
 * @Author Oneby
 * @Date 2021/2/2 18:54
 * @Version 1.0
 */
@SpringBootApplication(exclude = {DataSourceAutoConfiguration.class})
public class BootRedis01Application {
    public static void main(String[] args) {
        SpringApplication.run(BootRedis01Application.class);
    }
}
</code></pre></li><li><p>æ–°å»º <code>RedisConfig</code> é…ç½®ç±»ï¼Œç”¨äºè·å– <code>RedisTemplate</code> å¯¹è±¡</p><pre><code>/**
 * @ClassName RedisConfig
 * @Description TODO
 * @Author Oneby
 * @Date 2021/2/2 18:55
 * @Version 1.0
 */
@Configuration
public class RedisConfig {

    @Bean
    public RedisTemplate&lt;String, Serializable&gt; redisTemplate(LettuceConnectionFactory connectionFactory){
        // æ–°å»º RedisTemplate å¯¹è±¡ï¼Œkey ä¸º String å¯¹è±¡ï¼Œvalue ä¸º Serializableï¼ˆå¯åºåˆ—åŒ–çš„ï¼‰å¯¹è±¡
        RedisTemplate&lt;String, Serializable&gt; redisTemplate = new RedisTemplate&lt;&gt;();
        // key å€¼ä½¿ç”¨å­—ç¬¦ä¸²åºåˆ—åŒ–å™¨
        redisTemplate.setKeySerializer(new StringRedisSerializer());
        // value å€¼ä½¿ç”¨ json åºåˆ—åŒ–å™¨
        redisTemplate.setValueSerializer(new GenericJackson2JsonRedisSerializer());
        // ä¼ å…¥è¿æ¥å·¥å‚
        redisTemplate.setConnectionFactory(connectionFactory);
        // è¿”å› redisTemplate å¯¹è±¡
        return redisTemplate;
    }

}
</code></pre></li><li><p>æ–°å»º <code>GoodController</code> ä¸šåŠ¡ç±»ï¼Œç”¨äºè´©å–å•†å“</p><pre><code>/**
 * @ClassName GoodController
 * @Description TODO
 * @Author Oneby
 * @Date 2021/2/2 18:59
 * @Version 1.0
 */
@RestController
public class GoodController {

    @Autowired
    private StringRedisTemplate stringRedisTemplate;

    @Value(&quot;${server.port}&quot;)
    private String serverPort;

    @GetMapping(&quot;/buy_goods&quot;)
    public String buy_Goods() {
        // ä» redis ä¸­è·å–å•†å“çš„å‰©ä½™æ•°é‡
        String result = stringRedisTemplate.opsForValue().get(&quot;goods:001&quot;);
        int goodsNumber = result == null ? 0 : Integer.parseInt(result);
        String retStr = null;

        // å•†å“æ•°é‡å¤§äºé›¶æ‰èƒ½å‡ºå”®
        if (goodsNumber &gt; 0) {
            int realNumber = goodsNumber - 1;
            stringRedisTemplate.opsForValue().set(&quot;goods:001&quot;, realNumber + &quot;&quot;);
            retStr = &quot;ä½ å·²ç»æˆåŠŸç§’æ€å•†å“ï¼Œæ­¤æ—¶è¿˜å‰©ä½™ï¼š&quot; + realNumber + &quot;ä»¶&quot; + &quot;\t æœåŠ¡å™¨ç«¯å£: &quot; + serverPort;
        } else {
            retStr = &quot;å•†å“å·²ç»å”®ç½„/æ´»åŠ¨ç»“æŸ/è°ƒç”¨è¶…æ—¶ï¼Œæ¬¢è¿ä¸‹æ¬¡å…‰ä¸´&quot; + &quot;\t æœåŠ¡å™¨ç«¯å£: &quot; + serverPort;
        }
        System.out.println(retStr);
        return retStr;
    }

}
</code></pre></li></ol><blockquote><p><strong>boot_redis02 å·¥ç¨‹</strong></p></blockquote><p>boot_redis02 å·¥ç¨‹çš„ç«¯å£å·ä¸º 2222ï¼Œå…¶ä»–é…ç½®å‡ä¸ boot_redis01 ç›¸åŒ</p><h4 id="_3-2-4ã€demo-å·¥ç¨‹ä»£ç æµ‹è¯•" tabindex="-1"><a class="header-anchor" href="#_3-2-4ã€demo-å·¥ç¨‹ä»£ç æµ‹è¯•"><span>3.2.4ã€Demo å·¥ç¨‹ä»£ç æµ‹è¯•</span></a></h4><blockquote><p><strong>ä»£ç æµ‹è¯•</strong></p></blockquote><p><strong>æŠ›å¼‚å¸¸ï¼š<code>Unable to connect to Redis</code></strong></p><p>å¯åŠ¨ SpringBoot åº”ç”¨ï¼ŒäºŒè¯ä¸è¯´ç›´æ¥æŠ›äº†ä¸ªå¼‚å¸¸ï¼š<code>org.springframework.data.redis.RedisConnectionFailureException: Unable to connect to Redis; nested exception is org.springframework.data.redis.connection.PoolException: Could not get a resource from the pool; nested exception is io.lettuce.core.RedisConnectionException: Unable to connect to 192.168.152.233:6379</code>ï¼Œ</p><p>é‡ç‚¹çœ‹ï¼š<code>Unable to connect to Redis</code>ï¼Œæ˜æ˜ IP åœ°å€å’Œç«¯å£å·éƒ½é…ç½®æ­£ç¡®äº†ï¼Œè¿˜è¿æ¥ä¸ä¸Šï¼Œå°±è¦è€ƒè™‘æ˜¯é˜²ç«å¢™çš„é—®é¢˜äº†~</p><p><strong>è§£å†³é—®é¢˜ï¼šå…³é—­ CentOS é˜²ç«å¢™</strong></p><p>æ‰§è¡Œ <code>systemctl stop firewalld.service</code> å‘½ä»¤å…³é—­ CentOS é˜²ç«å¢™ï¼Œç„¶åä½¿ç”¨ <code>systemctl status firewalld.service</code> æŸ¥çœ‹é˜²ç«å¢™çŠ¶æ€ï¼Œå‡ºç° dead å­—æ ·å°±è¡¨ç¤ºé˜²ç«å¢™å·²ç»å…³é—­</p><figure><img src="/assets/img/ed6d07951cc7b8671f1c3699295a4fa5.b1042a31.png" alt="image-20210202201824435" tabindex="0" loading="lazy"><figcaption>image-20210202201824435</figcaption></figure><p>PSï¼šä¸Šé¢çš„æ–¹æ³•ï¼Œä¸€æ—¦é‡å¯æ“ä½œç³»ç»Ÿï¼Œé˜²ç«å¢™å°±è‡ªåŠ¨å¼€å¯äº†ï¼Œè¯¥æ€ä¹ˆè®¾ç½®æ‰èƒ½æ°¸ä¹…å…³é—­é˜²ç«å¢™å‘¢ï¼Ÿä½¿ç”¨ <code>systemctl disable firewalld.service</code> å‘½ä»¤å¯ç¦ç”¨é˜²ç«å¢™</p><hr><p><strong>å†æ¬¡æŠ›å¼‚å¸¸ï¼š<code>DENIED Redis is running in protected mode because protected mode is enabled</code></strong></p><p>å½“è®¿é—®é¡µé¢æ—¶ï¼ŒäºŒè¯ä¸è¯´åˆç›´æ¥æŠ›äº†ä¸ªå¼‚å¸¸ï¼š<code>io.lettuce.core.RedisConnectionException: DENIED Redis is running in protected mode because protected mode is enabled, no bind address was specified, no authentication password is requested to clients. In this mode connections are only accepted from the loopback interface. If you want to connect from external computers to Redis you may adopt one of the following solutions: 1) Just disable protected mode sending the command &#39;CONFIG SET protected-mode no&#39; from the loopback interface by connecting to Redis from the same host the server is running, however MAKE SURE Redis is not publicly accessible from internet if you do so. Use CONFIG REWRITE to make this change permanent. 2) Alternatively you can just disable the protected mode by editing the Redis configuration file, and setting the protected mode option to &#39;no&#39;, and then restarting the server. 3) If you started the server manually just for testing, restart it with the &#39;--protected-mode no&#39; option. 4) Setup a bind address or an authentication password. NOTE: You only need to do one of the above things in order for the server to start accepting connections from the outside.</code></p><p>Redis protected-mode æ˜¯3.2 ä¹‹ååŠ å…¥çš„æ–°ç‰¹æ€§ï¼Œåœ¨ Redis.conf çš„æ³¨é‡Šä¸­ï¼Œæˆ‘ä»¬å¯ä»¥äº†è§£åˆ°ï¼Œä»–çš„å…·ä½“ä½œç”¨å’Œå¯ç”¨æ¡ä»¶ã€‚é“¾æ¥ redis æ—¶åªèƒ½é€šè¿‡æœ¬åœ° localhostï¼ˆ127.0.0.1ï¼‰è¿™ä¸ªæ¥é“¾æ¥ï¼Œè€Œä¸èƒ½ç”¨ç½‘ç»œ ipï¼ˆ192.168â€¦ï¼‰è¿™ä¸ªé“¾æ¥ï¼Œå¦‚æœç”¨ç½‘ç»œ ip é“¾æ¥ä¼šæŠ¥é”™</p><p>æˆ‘ä»¬éœ€è¦å»ä¿®æ”¹ redis.conf é…ç½®æ–‡ä»¶ï¼šå°† <code>protected-mode</code> å­—æ®µè®¾ç½®ä¸º <code>no</code>ï¼Œå°† <code>bind</code> å­—æ®µçš„é…ç½®æ³¨é‡Šæ‰</p><figure><img src="/assets/img/2cd0346e3625cc841558ecf427df7972.c407b31a.png" alt="image-20210202205851770" tabindex="0" loading="lazy"><figcaption>image-20210202205851770</figcaption></figure><p><strong>è§£å†³é—®é¢˜ï¼šå°† <code>protected-mode</code> å­—æ®µè®¾ç½®ä¸º <code>no</code></strong></p><p>æ‰“å¼€ redis.conf é…ç½®æ–‡ä»¶ï¼Œå°† <code>protected-mode</code> å­—æ®µè®¾ç½®ä¸º <code>no</code></p><figure><img src="/assets/img/a8515ae66bb2bc82b84ca43edbf84fe3.f74e4b44.png" alt="image-20210202203048701" tabindex="0" loading="lazy"><figcaption>image-20210202203048701</figcaption></figure><p>æ¥ç€å°† <code>bind</code> å­—æ®µçš„é…ç½®æ³¨é‡Šæ‰</p><figure><img src="/assets/img/f30942a588eed365caaa2a4855d6dde9.110df102.png" alt="image-20210202205803979" tabindex="0" loading="lazy"><figcaption>image-20210202205803979</figcaption></figure><p>ä½¿ç”¨ <code>ps aux | grep redis</code> å‘½ä»¤æŸ¥æ‰¾ redis ç›¸å…³çš„åå°æœåŠ¡ï¼Œå¹¶ä½¿ç”¨ <code>kill -9 è¿›ç¨‹ID</code> å…³é—­ redis åå°è¿›ç¨‹ï¼Œç„¶åé‡å¯ redis æœåŠ¡</p><figure><img src="/assets/img/e5eedb67f5f4a5048f842bd2bbec5bea.b9ddb816.png" alt="image-20210202205736970" tabindex="0" loading="lazy"><figcaption>image-20210202205736970</figcaption></figure><hr><p><strong>å†å†æ¬¡æŠ›å¼‚å¸¸ï¼š<code>MISCONF Redis is configured to save RDB snapshots, but it is currently not able to persist on disk</code></strong></p><p>å½“è®¿é—®é¡µé¢æ—¶ï¼ŒäºŒè¯ä¸è¯´åˆåˆç›´æ¥æŠ›äº†ä¸ªå¼‚å¸¸ï¼š<code>io.lettuce.core.RedisCommandExecutionException: MISCONF Redis is configured to save RDB snapshots, but it is currently not able to persist on disk. Commands that may modify the data set are disabled, because this instance is configured to report errors during writes if RDB snapshotting fails (stop-writes-on-bgsave-error option). Please check the Redis logs for details about the RDB error.</code></p><p>å—¨å‘€ï¼Œå¥½ç†Ÿæ‚‰çš„å¼‚å¸¸ï¼Œè¿™ä¸æ˜¯ä¹‹å‰è§åˆ°è¿‡çš„å˜›~ç©¶å…¶åŸå› æ˜¯å› ä¸ºå¼ºåˆ¶æŠŠ redis å¿«ç…§å…³é—­äº†å¯¼è‡´ä¸èƒ½æŒä¹…åŒ–çš„é—®é¢˜ï¼Œé€šè¿‡å°† <code>stop-writes-on-bgsave-error</code> å­—æ®µçš„å€¼è®¾ç½®ä¸º <code>no</code> å³å¯é¿å…è¿™ç§é—®é¢˜ã€‚</p><p>**è§£å†³é—®é¢˜ï¼šå°† <code>stop-writes-on-bgsave-error</code> å­—æ®µçš„å€¼è®¾ç½®ä¸º <code>no</code> **</p><p>æ‰“å¼€ redis.conf é…ç½®æ–‡ä»¶ï¼Œå°† <code>stop-writes-on-bgsave-error</code> å­—æ®µçš„å€¼è®¾ç½®ä¸º <code>no</code>ï¼Œç„¶åé‡å¯ redis æœåŠ¡</p><figure><img src="/assets/img/9c102b1b76aec7b591c5f5209586f578.6592ed3a.png" alt="image-20210202223424915" tabindex="0" loading="lazy"><figcaption>image-20210202223424915</figcaption></figure><hr><p><strong>ä»£ç æµ‹è¯•</strong></p><p>åœ¨ Windows æµè§ˆå™¨ä¸­è®¿é—® <code>http://192.168.1.6:1111/buy_goods</code> å’Œ <code>http://192.168.1.6:2222/buy_goods</code> èƒ½å¾—åˆ°å¦‚ä¸‹ç»“æœ</p><figure><img src="/assets/img/fb0dd135e27e04a5c5331882ffdae350.7f550b01.png" alt="image-20210203155231974" tabindex="0" loading="lazy"><figcaption>image-20210203155231974</figcaption></figure><p>åœ¨ CentOS æµè§ˆå™¨ä¸­è®¿é—® <code>http://192.168.1.6:1111/buy_goods</code> å’Œ <code>http://192.168.1.6:2222/buy_goods</code> èƒ½å¾—åˆ°å¦‚ä¸‹ç»“æœ</p><figure><img src="/assets/img/7dc743e7047a5850de8a02953246bf40.273615b3.png" alt="image-20210203155224900" tabindex="0" loading="lazy"><figcaption>image-20210203155224900</figcaption></figure><h3 id="_3-3ã€æµ‹è¯•-æ‰¾èŒ¬" tabindex="-1"><a class="header-anchor" href="#_3-3ã€æµ‹è¯•-æ‰¾èŒ¬"><span>3.3ã€æµ‹è¯• &amp; æ‰¾èŒ¬</span></a></h3><h4 id="_3-3-1ã€å•æœºç‰ˆ" tabindex="-1"><a class="header-anchor" href="#_3-3-1ã€å•æœºç‰ˆ"><span>3.3.1ã€å•æœºç‰ˆ</span></a></h4><blockquote><p><strong>1ã€å•æœºç‰ˆç¨‹åºæ²¡åŠ é”å­˜åœ¨ä»€ä¹ˆé—®é¢˜ï¼Ÿ</strong></p></blockquote><p><strong>é—®é¢˜</strong>ï¼šå•æœºç‰ˆç¨‹åºæ²¡æœ‰åŠ é”ï¼Œåœ¨å¹¶å‘æµ‹è¯•ä¸‹æ•°å­—ä¸å¯¹ï¼Œä¼šå‡ºç°è¶…å–ç°è±¡</p><p><strong>è§£å†³</strong>ï¼šåŠ é”ï¼Œé‚£ä¹ˆé—®é¢˜åˆæ¥äº†ï¼ŒåŠ  <code>synchronized</code> é”è¿˜æ˜¯ <code>ReentrantLock</code> é”å‘¢ï¼Ÿ</p><ol><li><code>synchronized</code>ï¼šä¸è§ä¸æ•£ï¼Œç­‰ä¸åˆ°é”å°±ä¼šæ­»ç­‰</li><li><code>ReentrantLock</code>ï¼šè¿‡æ—¶ä¸å€™ï¼Œ<code>lock.tryLock()</code> æä¾›ä¸€ä¸ªè¿‡æ—¶æ—¶é—´çš„å‚æ•°ï¼Œæ—¶é—´ä¸€åˆ°è‡ªåŠ¨æ”¾å¼ƒé”</li></ol><p><strong>å¦‚ä½•é€‰æ‹©</strong>ï¼šæ ¹æ®ä¸šåŠ¡éœ€æ±‚æ¥é€‰ï¼Œå¦‚æœéè¦æŠ¢åˆ°é”ä¸å¯ï¼Œå°±ä½¿ç”¨ <code>synchronized</code> é”ï¼›å¦‚æœå¯ä»¥æš‚æ—¶æ”¾å¼ƒé”ï¼Œç­‰ä¼šå†æ¥å¼ºï¼Œå°±ä½¿ç”¨ <code>ReentrantLock</code> é”</p><blockquote><p><strong>2.0 ç‰ˆæœ¬çš„ä»£ç ï¼šä½¿ç”¨ <code>synchronized</code> é”ä¿è¯å•æœºç‰ˆç¨‹åºåœ¨å¹¶å‘ä¸‹çš„å®‰å…¨æ€§</strong></p></blockquote><p>Ctrl + Alt + T ï¼Œç”¨ <code>synchronized</code> é”å°†æ–¹æ³•ä½“ä¸­çš„ä»£ç åŒ…è£¹èµ·æ¥</p><pre><code>/**
 * @ClassName GoodController
 * @Description TODO
 * @Author Oneby
 * @Date 2021/2/2 18:59
 * @Version 2.0
 */
@RestController
public class GoodController {

    @Autowired
    private StringRedisTemplate stringRedisTemplate;

    @Value(&quot;${server.port}&quot;)
    private String serverPort;

    @GetMapping(&quot;/buy_goods&quot;)
    public String buy_Goods() {
        synchronized (this) {
            // ä» redis ä¸­è·å–å•†å“çš„å‰©ä½™æ•°é‡
            String result = stringRedisTemplate.opsForValue().get(&quot;goods:001&quot;);
            int goodsNumber = result == null ? 0 : Integer.parseInt(result);
            String retStr = null;

            // å•†å“æ•°é‡å¤§äºé›¶æ‰èƒ½å‡ºå”®
            if (goodsNumber &gt; 0) {
                int realNumber = goodsNumber - 1;
                stringRedisTemplate.opsForValue().set(&quot;goods:001&quot;, realNumber + &quot;&quot;);
                retStr = &quot;ä½ å·²ç»æˆåŠŸç§’æ€å•†å“ï¼Œæ­¤æ—¶è¿˜å‰©ä½™ï¼š&quot; + realNumber + &quot;ä»¶&quot; + &quot;\t æœåŠ¡å™¨ç«¯å£: &quot; + serverPort;
            } else {
                retStr = &quot;å•†å“å·²ç»å”®ç½„/æ´»åŠ¨ç»“æŸ/è°ƒç”¨è¶…æ—¶ï¼Œæ¬¢è¿ä¸‹æ¬¡å…‰ä¸´&quot; + &quot;\t æœåŠ¡å™¨ç«¯å£: &quot; + serverPort;
            }
            System.out.println(retStr);
            return retStr;
        }
    }

}
</code></pre><blockquote><p><strong>æ³¨æ„äº‹é¡¹</strong></p></blockquote><ol><li><p>åœ¨å•æœºç¯å¢ƒä¸‹ï¼Œå¯ä»¥ä½¿ç”¨ <code>synchronized</code> é”æˆ– <code>Lock</code> é”æ¥å®ç°ã€‚</p></li><li><p>ä½†æ˜¯åœ¨åˆ†å¸ƒå¼ç³»ç»Ÿä¸­ï¼Œå› ä¸ºç«äº‰çš„çº¿ç¨‹å¯èƒ½ä¸åœ¨åŒä¸€ä¸ªèŠ‚ç‚¹ä¸Šï¼ˆåŒä¸€ä¸ª jvm ä¸­ï¼‰ï¼Œæ‰€ä»¥éœ€è¦ä¸€ä¸ªè®©æ‰€æœ‰è¿›ç¨‹éƒ½èƒ½è®¿é—®åˆ°çš„é”æ¥å®ç°ï¼Œæ¯”å¦‚ redis æˆ–è€… zookeeper æ¥æ„å»º;</p></li><li><p>ä¸åŒè¿›ç¨‹ jvm å±‚é¢çš„é”å°±ä¸ç®¡ç”¨äº†ï¼Œé‚£ä¹ˆå¯ä»¥åˆ©ç”¨ç¬¬ä¸‰æ–¹çš„ä¸€ä¸ªç»„ä»¶ï¼Œæ¥è·å–é”ï¼Œæœªè·å–åˆ°é”ï¼Œåˆ™é˜»å¡å½“å‰æƒ³è¦è¿è¡Œçš„çº¿ç¨‹</p></li></ol><h4 id="_3-3-2ã€åˆ†å¸ƒå¼ç‰ˆ" tabindex="-1"><a class="header-anchor" href="#_3-3-2ã€åˆ†å¸ƒå¼ç‰ˆ"><span>3.3.2ã€åˆ†å¸ƒå¼ç‰ˆ</span></a></h4><blockquote><p><strong>2ã€åˆ†å¸ƒå¼éƒ¨ç½²ä¹‹åï¼Œå•æœºç‰ˆçš„é”å¤±æ•ˆ</strong></p></blockquote><p><strong>é—®é¢˜</strong>ï¼š</p><p>åˆ†å¸ƒå¼éƒ¨ç½²ä¹‹åï¼Œå•æœºç‰ˆçš„é”å¤±æ•ˆï¼Œå•æœºç‰ˆçš„é”è¿˜æ˜¯ä¼šå¯¼è‡´è¶…å–ç°è±¡ï¼Œè¿™æ—¶å°±éœ€è¦éœ€è¦åˆ†å¸ƒå¼é”</p><p>å¦‚ä¸‹ï¼Œåœ¨æˆ‘ä»¬çš„ä¸¤ä¸ªå¾®æœåŠ¡ä¹‹ä¸Šï¼ŒæŒ¡äº†ä¸€ä¸ª nginx æœåŠ¡å™¨ï¼Œç”¨äºå®ç°è´Ÿè½½å‡è¡¡çš„åŠŸèƒ½</p><figure><img src="/assets/img/5a13a86d6601989f39f0bbb0be267a61.dd5d55ba.png" alt="image-20210202230229310" tabindex="0" loading="lazy"><figcaption>image-20210202230229310</figcaption></figure><blockquote><p><strong>å®‰è£… nginx</strong></p></blockquote><p>å“ˆå“ˆï¼Œæˆ‘è¿˜æ²¡å­¦è¿‡ nginxï¼Œé‚£å°±ç°å­¦ç°å–ä¸€æ³¢å§ï¼Œå‚è€ƒèµ„æ–™ï¼š<a href="https://www.cnblogs.com/boonya/p/7907999.html" target="_blank" rel="noopener noreferrer">CentOS7å®‰è£…nginx</a>ã€<a href="https://blog.csdn.net/qq_37345604/article/details/90034424" target="_blank" rel="noopener noreferrer">centOS7å®‰è£…nginxåŠnginxé…ç½®</a></p><p><strong>1ã€å®‰è£… gcc</strong></p><p>å®‰è£… nginx éœ€è¦å…ˆå°†å®˜ç½‘ä¸‹è½½çš„æºç è¿›è¡Œç¼–è¯‘ï¼Œç¼–è¯‘ä¾èµ– gcc ç¯å¢ƒï¼Œå¦‚æœæ²¡æœ‰ gcc ç¯å¢ƒï¼Œåˆ™éœ€è¦å®‰è£…ï¼š</p><pre><code>yum install gcc-c++
</code></pre><p><strong>2ã€PCRE pcre-devel å®‰è£…</strong></p><p>PCREï¼ˆPerl Compatible Regular Expressionsï¼‰æ˜¯ä¸€ä¸ª Perl åº“ï¼ŒåŒ…æ‹¬ perl å…¼å®¹çš„æ­£åˆ™è¡¨è¾¾å¼åº“ã€‚nginx çš„ http æ¨¡å—ä½¿ç”¨ pcre æ¥è§£ææ­£åˆ™è¡¨è¾¾å¼ï¼Œæ‰€ä»¥éœ€è¦åœ¨ linux ä¸Šå®‰è£… pcre åº“ï¼Œpcre-devel æ˜¯ä½¿ç”¨ pcre å¼€å‘çš„ä¸€ä¸ªäºŒæ¬¡å¼€å‘åº“ã€‚nginxä¹Ÿéœ€è¦æ­¤åº“ã€‚å®‰è£…å‘½ä»¤ä¸ºï¼š</p><pre><code>yum install -y pcre pcre-devel
</code></pre><p><strong>3ã€zlib å®‰è£…</strong></p><p>zlib åº“æä¾›äº†å¾ˆå¤šç§å‹ç¼©å’Œè§£å‹ç¼©çš„æ–¹å¼ï¼Œ nginx ä½¿ç”¨ zlib å¯¹ http åŒ…çš„å†…å®¹è¿›è¡Œ gzip ï¼Œæ‰€ä»¥éœ€è¦åœ¨ CentOS ä¸Šå®‰è£… zlib åº“ã€‚</p><pre><code>yum install -y zlib zlib-devel
</code></pre><p><strong>4ã€OpenSSL å®‰è£…</strong><br> OpenSSL æ˜¯ä¸€ä¸ªå¼ºå¤§çš„å®‰å…¨å¥—æ¥å­—å±‚å¯†ç åº“ï¼Œå›Šæ‹¬ä¸»è¦çš„å¯†ç ç®—æ³•ã€å¸¸ç”¨çš„å¯†é’¥å’Œè¯ä¹¦å°è£…ç®¡ç†åŠŸèƒ½åŠ SSL åè®®ï¼Œå¹¶æä¾›ä¸°å¯Œçš„åº”ç”¨ç¨‹åºä¾›æµ‹è¯•æˆ–å…¶å®ƒç›®çš„ä½¿ç”¨ã€‚nginx ä¸ä»…æ”¯æŒ http åè®®ï¼Œè¿˜æ”¯æŒ httpsï¼ˆå³åœ¨sslåè®®ä¸Šä¼ è¾“httpï¼‰ï¼Œæ‰€ä»¥éœ€è¦åœ¨ Centos å®‰è£… OpenSSL åº“ã€‚</p><pre><code>yum install -y openssl openssl-devel
</code></pre><p><strong>5ã€ä¸‹è½½ nginx å®‰è£…åŒ…</strong></p><p>ä½¿ç”¨ <code>wget</code> å‘½ä»¤ä¸‹è½½ nginx å®‰è£…åŒ…ï¼Œç¡®ä¿ç³»ç»Ÿå·²ç»å®‰è£…äº†<code>wget</code>ï¼Œå¦‚æœæ²¡æœ‰å®‰è£…ï¼Œæ‰§è¡Œ <code>yum install wget</code> å®‰è£…</p><pre><code>wget -c https://nginx.org/download/nginx-1.12.0.tar.gz
</code></pre><p><strong>6ã€è§£å‹å®‰è£…åŒ…</strong></p><p>ä½¿ç”¨ <code>tar -zxvf</code> æŒ‡ä»¤è§£å‹ä¸‹è½½å¥½çš„å®‰è£…åŒ…ï¼Œå¹¶è¿›å…¥è§£å‹åçš„ç›®å½•</p><pre><code>tar -zxvf nginx-1.12.0.tar.gz
cd nginx-1.12.0
</code></pre><p><strong>7ã€é…ç½® nginx</strong></p><p>å…¶å®åœ¨ nginx-1.12.0 ç‰ˆæœ¬ä¸­ä½ å°±ä¸éœ€è¦å»é…ç½®ç›¸å…³ä¸œè¥¿ï¼Œé»˜è®¤å°±å¯ä»¥äº†ã€‚å½“ç„¶ï¼Œå¦‚æœä½ è¦è‡ªå·±é…ç½®ç›®å½•ä¹Ÿæ˜¯å¯ä»¥çš„ã€‚æˆ‘è¿™é‡Œé‡‡ç”¨é»˜è®¤é…ç½®ï¼Œåœ¨ nginx å®‰è£…åŒ…ç›®å½•ä¸‹æ‰§è¡Œå¦‚ä¸‹æŒ‡ä»¤ï¼š</p><pre><code>./configure
</code></pre><p>æ‰§è¡Œå®Œ <code>./configure</code> å‘½ä»¤ä¹‹åä¼šç”Ÿæˆ Makefile æ–‡ä»¶ï¼Œæˆ‘ä»¬ç¼–è¯‘å®‰è£…ç¨‹åºå°±éœ€è¦å®ƒ</p><figure><img src="/assets/img/9115cf21e6183645336d12af5a886e51.b30f0dad.png" alt="image-20210202234656410" tabindex="0" loading="lazy"><figcaption>image-20210202234656410</figcaption></figure><p><strong>8ã€ç¼–è¯‘ &amp; å®‰è£…</strong></p><p><code>make</code> å’Œ <code>make install</code> æ‰“ä¸€å¥—</p><pre><code>make
make install
</code></pre><p><strong>9ã€æŸ¥çœ‹ nginx å®‰è£…ç›®å½•</strong></p><p>ä½¿ç”¨ <code>whereis nginx</code> å‘½ä»¤æŸ¥çœ‹ nginx çš„é»˜è®¤å®‰è£…ç›®å½•</p><figure><img src="/assets/img/9f75a8ef48c400b83af03ccccf803ef9.e1fb9cea.png" alt="image-20210202235207546" tabindex="0" loading="lazy"><figcaption>image-20210202235207546</figcaption></figure><blockquote><p><strong>å¯åŠ¨ nginx</strong></p></blockquote><p>é¦–å…ˆè¿›å…¥ nginx å®‰è£…ç›®å½•ä¸‹çš„å¯æ‰§è¡Œæ–‡ä»¶å­˜æ”¾çš„ç›®å½•</p><pre><code>cd /usr/local/nginx/sbin/
</code></pre><p>å¯åŠ¨ nginx</p><pre><code>./nginx                # å¯åŠ¨ nginx æœåŠ¡å™¨
./nginx -s stop        # æ­¤æ–¹å¼ç›¸å½“äºå…ˆæŸ¥å‡ºnginxè¿›ç¨‹idå†ä½¿ç”¨killå‘½ä»¤å¼ºåˆ¶æ€æ‰è¿›ç¨‹ã€‚
./nginx -s quit        # æ­¤æ–¹å¼åœæ­¢æ­¥éª¤æ˜¯å¾…nginxè¿›ç¨‹å¤„ç†ä»»åŠ¡å®Œæ¯•è¿›è¡Œåœæ­¢ã€‚
./nginx -s reload      # é‡å¯nginxæœåŠ¡
</code></pre><p>è®¿é—® <code>http://localhost/</code>ï¼ˆnginx é»˜è®¤æ˜¯ 80 ç«¯å£ï¼‰ï¼Œå¦‚å‡ºç°å¦‚ä¸‹é¡µé¢åˆ™è¯´æ˜å¯åŠ¨æˆåŠŸ</p><figure><img src="/assets/img/7341394899d9da5f67ac1eb42e913c94.fce7aedb.png" alt="image-20210202235806986" tabindex="0" loading="lazy"><figcaption>image-20210202235806986</figcaption></figure><blockquote><p><strong>nginx çš„å…¶ä»–ç»†èŠ‚</strong></p></blockquote><p>æŸ¥è¯¢ nginx è¿›ç¨‹ï¼š</p><pre><code>ps aux|grep nginx
</code></pre><hr><p>**é‡å¯ nginx **</p><p>1ã€å…ˆåœæ­¢å†å¯åŠ¨ï¼ˆæ¨èï¼‰ï¼š</p><p>å¯¹ nginx è¿›è¡Œé‡å¯ç›¸å½“äºå…ˆåœæ­¢å†å¯åŠ¨ï¼Œå³å…ˆæ‰§è¡Œåœæ­¢å‘½ä»¤å†æ‰§è¡Œå¯åŠ¨å‘½ä»¤ã€‚å¦‚ä¸‹ï¼š</p><pre><code>./nginx -s quit
./nginx
</code></pre><p>2ã€é‡æ–°åŠ è½½é…ç½®æ–‡ä»¶ï¼š</p><p>å½“ nginx çš„é…ç½®æ–‡ä»¶ nginx.conf ä¿®æ”¹åï¼Œè¦æƒ³è®©é…ç½®ç”Ÿæ•ˆéœ€è¦é‡å¯ nginxï¼Œä½¿ç”¨<code>-s reload</code> å¯ä»¥ä¸ç”¨åœæ­¢ nginx æœåŠ¡ï¼Œå³å¯å°†é…ç½®ä¿¡æ¯åœ¨ nginx ä¸­ç”Ÿæ•ˆï¼Œå¦‚ä¸‹ï¼š</p><pre><code>./nginx -s reload
</code></pre><hr><p><strong>æŒ‡å®šå¯åŠ¨é…ç½®æ–‡ä»¶</strong></p><p>åœ¨ <code>nginx</code> å‘½ä»¤åå¸¦ä¸Š <code>-c</code> å‚æ•°ï¼Œå¹¶è·Ÿä¸Šé…ç½®æ–‡ä»¶çš„è·¯å¾„å³å¯</p><pre><code>/usr/local/nginx/sbin/nginx -c /usr/local/nginx/conf/nginx.conf
</code></pre><blockquote><p><strong>nginx é…ç½®è´Ÿè½½å‡è¡¡</strong></p></blockquote><p><strong>1ã€ç¼–å†™é…ç½®æ–‡ä»¶</strong></p><p>é¦–å…ˆè¿›å…¥ <code>/usr/local/nginx/conf/</code>ï¼Œè¯¥æ–‡ä»¶ä¸­åŒ…å« nginx çš„é…ç½®æ–‡ä»¶ï¼šnginx.conf</p><pre><code>cd /usr/local/nginx/conf/
</code></pre><figure><img src="/assets/img/b45838412833649dbdeb094a9e1f2439.c657775a.png" alt="image-20210203110830602" tabindex="0" loading="lazy"><figcaption>image-20210203110830602</figcaption></figure><p>ä½¿ç”¨ <code>vim nginx.conf</code> å‘½ä»¤ç¼–è¾‘é…ç½®æ–‡ä»¶</p><pre><code>    #gzip  on;

    upstream mynginx{
        server 192.168.1.6:1111 weight=1;
        server 192.168.1.6:2222 weight=1;
    }

    server {
        listen       80;
        server_name  localhost;

        #charset koi8-r;

        #access_log  logs/host.access.log  main;

        location / {
            #root   html;
            proxy_pass http://mynginx;
            index index.html index.htm;
        }

        #error_page  404              /404.html;

        # redirect server error pages to the static page /50x.html
        #
        error_page   500 502 503 504  /50x.html;
        location = /50x.html {
            root   html;
        }
    
    	# ...
</code></pre><p><strong>2ã€é‡å¯ nginx æœåŠ¡</strong></p><p>æ‰§è¡Œ <code>./nginx -s reload</code> å‘½ä»¤é‡å¯ nginx æœåŠ¡</p><p><strong>3ã€è®¿é—® nginx</strong></p><p>è®¿é—® <code>http://192.168.152.233/buy_goods</code> ç½‘å€èƒ½å¤Ÿå¾—åˆ°å¦‚ä¸‹ä»£ç ï¼Œæˆ‘ä»¬åœ¨ nginx é…ç½®çš„æƒé‡ç›¸ç­‰ï¼Œé»˜è®¤æ˜¯è½®è¯¢è®¿é—®</p><figure><img src="/assets/img/5a4d451ec702e8d136dc9ea410a3335d.30370bb1.png" alt="image-20210203155818647" tabindex="0" loading="lazy"><figcaption>image-20210203155818647</figcaption></figure><blockquote><p><strong>ä½¿ç”¨ jmeter è¿›è¡Œå‹æµ‹</strong></p></blockquote><p><strong>1ã€jmeter ä¸‹è½½åœ°å€</strong></p><p><a href="https://jmeter.apache.org/" target="_blank" rel="noopener noreferrer">jmeter å®˜ç½‘</a>ï¼šè¿™ä¸‹è½½é€Ÿåº¦åˆ°çŒ´å¹´é©¬æœˆæ‰èƒ½ä¸‹è½½å®Œæˆ</p><p><a href="https://mirrors.tuna.tsinghua.edu.cn/apache/" target="_blank" rel="noopener noreferrer">æ¸…åå¤§å­¦é•œåƒ</a>ï¼šæ¨èä¸‹è½½åœ°å€~~~</p><hr><p><strong>2ã€é…ç½® jmeter</strong></p><p>ç‚¹å‡»ã€binã€‘ç›®å½•ä¸‹çš„ã€jmeter.batã€‘æ‰¹å¤„ç†è„šæœ¬å¯åŠ¨ jmeter</p><figure><img src="/assets/img/0bbf1990e7279517825c37c4ef8c299b.f75f0b0b.png" alt="image-20210203161248838" tabindex="0" loading="lazy"><figcaption>image-20210203161248838</figcaption></figure><p>åœ¨ã€Test Planã€‘ä¸Šå³å‡»ï¼Œé€‰æ‹©ã€Addã€‘â€“&gt;ã€Threadsã€‘â€“&gt;ã€Thread Groupã€‘ï¼Œæ·»åŠ çº¿ç¨‹ç»„</p><figure><img src="/assets/img/e4d6b2ed44b89da2c84cfb09f36264a8.578a51b0.png" alt="image-20210203162823331" tabindex="0" loading="lazy"><figcaption>image-20210203162823331</figcaption></figure><p>è®¾ç½®å¦‚ä¸‹å››ä¸ªå‚æ•°</p><ol><li>Nameï¼šçº¿ç¨‹ç»„çš„åç§°</li><li>Number of Threads(users)ï¼šæ‰“å‡ºå»çš„çº¿ç¨‹æ•°é‡</li><li>Ramp-up period(seconds)ï¼šåœ¨å¤šé•¿æ—¶é—´å†…éœ€è¦å°†è¿™äº›çº¿ç¨‹æ‰“å‡ºå»</li><li>Loop Countï¼šå¾ªç¯æ¬¡æ•°ï¼Œé€‰æ‹© Infinite è¡¨ç¤ºæ— é™é‡å¤æ‰§è¡Œ</li></ol><figure><img src="/assets/img/b1e863033f19bdb657250ee8fb45ee29.08148929.png" alt="image-20210203163001306" tabindex="0" loading="lazy"><figcaption>image-20210203163001306</figcaption></figure><p>åœ¨çº¿ç¨‹ç»„ä¹‹ä¸Šå³å‡»ï¼Œé€‰æ‹©ã€Addã€‘â€“&gt;ã€Samplerã€‘â€“&gt;ã€HTTP Requestã€‘ï¼Œæ·»åŠ  HTTP è¯·æ±‚</p><figure><img src="/assets/img/5b9d7bf3051f37d30d4c8a28732a1dd4.d19a8721.png" alt="image-20210203163132246" tabindex="0" loading="lazy"><figcaption>image-20210203163132246</figcaption></figure><p>è®¾ç½®å¦‚ä¸‹ä¸‰ä¸ªå‚æ•°</p><ol><li>Server Name or IPï¼šæœåŠ¡å™¨åç§°æˆ–è€… IP åœ°å€</li><li>Port Numberï¼šè®¿é—®çš„ç«¯å£å·</li><li>Pathï¼šè®¿é—®çš„è·¯å¾„</li></ol><figure><img src="/assets/img/9c1d98be7c3db41fde39d7ff67309ecd.64152d2a.png" alt="image-20210203163305729" tabindex="0" loading="lazy"><figcaption>image-20210203163305729</figcaption></figure><p>ä¿å­˜æ­¤ HTTP Request åæ‰èƒ½è¿›è¡Œå‹æµ‹</p><figure><img src="/assets/img/3f16af7936752594f3556f9a27149265.1157551a.png" alt="image-20210203163403879" tabindex="0" loading="lazy"><figcaption>image-20210203163403879</figcaption></figure><p>ç‚¹å‡»ã€Startã€‘æŒ‰é’®å¼€å§‹è¿›è¡Œå‹æµ‹</p><figure><img src="/assets/img/ab8c6f0961b406285792df6c375a7d42.06dc7224.png" alt="image-20210203163447144" tabindex="0" loading="lazy"><figcaption>image-20210203163447144</figcaption></figure><p><strong>3ã€å‹æµ‹ç»“æœ</strong></p><p>å¯ä»¥çœ‹åˆ°ï¼Œç›¸åŒçš„å•†å“è¢«å‡ºå”®ä¸¤æ¬¡ï¼Œå‡ºç°è¶…å–ç°è±¡</p><figure><img src="/assets/img/69a506bf7f3d584cf7b4bb7d352eedeb.5fcac89e.png" alt="image-20210203163846600" tabindex="0" loading="lazy"><figcaption>image-20210203163846600</figcaption></figure><blockquote><p><strong>3.0 ç‰ˆæœ¬çš„ä»£ç ï¼šä½¿ç”¨ redis åˆ†å¸ƒå¼é”</strong></p></blockquote><p><strong>1ã€<a href="https://redis.io/commands/set" target="_blank" rel="noopener noreferrer">SET å‘½ä»¤</a></strong></p><p>Rediså…·æœ‰æé«˜çš„æ€§èƒ½ï¼Œä¸”å…¶å‘½ä»¤å¯¹åˆ†å¸ƒå¼é”æ”¯æŒå‹å¥½ï¼Œå€ŸåŠ© SET å‘½ä»¤å³å¯å®ç°åŠ é”å¤„ç†</p><p>The <a href="https://redis.io/commands/set" target="_blank" rel="noopener noreferrer">SET</a> command supports a set of options that modify its behavior:</p><ol><li><code>EX</code> <em>seconds</em> â€“ Set the specified expire time, in seconds.</li><li><code>PX</code> <em>milliseconds</em> â€“ Set the specified expire time, in milliseconds.</li><li><code>EXAT</code> <em>timestamp-seconds</em> â€“ Set the specified Unix time at which the key will expire, in seconds.</li><li><code>PXAT</code> <em>timestamp-milliseconds</em> â€“ Set the specified Unix time at which the key will expire, in milliseconds.</li><li><code>NX</code> â€“ Only set the key if it does not already exist.</li><li><code>XX</code> â€“ Only set the key if it already exist.</li><li><code>KEEPTTL</code> â€“ Retain the time to live associated with the key.</li><li><a href="https://redis.io/commands/get" target="_blank" rel="noopener noreferrer">GET</a> â€“ Return the old value stored at key, or nil when key did not exist.</li></ol><hr><p><strong>2ã€åœ¨ä»£ç ä¸­ä½¿ç”¨åˆ†å¸ƒå¼é”</strong></p><p>ä½¿ç”¨å½“å‰è¯·æ±‚çš„ UUID + çº¿ç¨‹åä½œä¸ºåˆ†å¸ƒå¼é”çš„ valueï¼Œæ‰§è¡Œ <code>stringRedisTemplate.opsForValue().setIfAbsent(REDIS_LOCK_KEY, value)</code> æ–¹æ³•å°è¯•æŠ¢å é”ï¼Œå¦‚æœæŠ¢å å¤±è´¥ï¼Œåˆ™è¿”å›å€¼ä¸º falseï¼›å¦‚æœæŠ¢å æˆåŠŸï¼Œåˆ™è¿”å›å€¼ä¸º trueã€‚æœ€åè®°å¾—è°ƒç”¨ <code>stringRedisTemplate.delete(REDIS_LOCK_KEY)</code> æ–¹æ³•é‡Šæ”¾åˆ†å¸ƒå¼é”</p><pre><code>/**
 * @ClassName GoodController
 * @Description TODO
 * @Author Oneby
 * @Date 2021/2/2 18:59
 * @Version 2.0
 */
@RestController
public class GoodController {

    private static final String REDIS_LOCK_KEY = &quot;lockOneby&quot;;

    @Autowired
    private StringRedisTemplate stringRedisTemplate;

    @Value(&quot;${server.port}&quot;)
    private String serverPort;

    @GetMapping(&quot;/buy_goods&quot;)
    public String buy_Goods() {
        // å½“å‰è¯·æ±‚çš„ UUID + çº¿ç¨‹å
        String value = UUID.randomUUID().toString()+Thread.currentThread().getName();
        // setIfAbsent() å°±ç›¸å½“äº setnxï¼Œå¦‚æœä¸å­˜åœ¨å°±æ–°å»ºé”
        Boolean lockFlag = stringRedisTemplate.opsForValue().setIfAbsent(REDIS_LOCK_KEY, value);

        // æŠ¢é”å¤±è´¥
        if(lockFlag == false){
            return &quot;æŠ¢é”å¤±è´¥ o(â•¥ï¹â•¥)o&quot;;
        }

        // ä» redis ä¸­è·å–å•†å“çš„å‰©ä½™æ•°é‡
        String result = stringRedisTemplate.opsForValue().get(&quot;goods:001&quot;);
        int goodsNumber = result == null ? 0 : Integer.parseInt(result);
        String retStr = null;

        // å•†å“æ•°é‡å¤§äºé›¶æ‰èƒ½å‡ºå”®
        if (goodsNumber &gt; 0) {
            int realNumber = goodsNumber - 1;
            stringRedisTemplate.opsForValue().set(&quot;goods:001&quot;, realNumber + &quot;&quot;);
            retStr = &quot;ä½ å·²ç»æˆåŠŸç§’æ€å•†å“ï¼Œæ­¤æ—¶è¿˜å‰©ä½™ï¼š&quot; + realNumber + &quot;ä»¶&quot; + &quot;\t æœåŠ¡å™¨ç«¯å£: &quot; + serverPort;
        } else {
            retStr = &quot;å•†å“å·²ç»å”®ç½„/æ´»åŠ¨ç»“æŸ/è°ƒç”¨è¶…æ—¶ï¼Œæ¬¢è¿ä¸‹æ¬¡å…‰ä¸´&quot; + &quot;\t æœåŠ¡å™¨ç«¯å£: &quot; + serverPort;
        }
        System.out.println(retStr);
        stringRedisTemplate.delete(REDIS_LOCK_KEY); // é‡Šæ”¾åˆ†å¸ƒå¼é”
        return retStr;
    }

}
</code></pre><p><strong>3ã€ä»£ç æµ‹è¯•</strong></p><p>åŠ ä¸Šåˆ†å¸ƒå¼é”ä¹‹åï¼Œè§£å†³äº†è¶…å–ç°è±¡</p><figure><img src="/assets/img/7ae1096a15daceb386af7c4ee327c89d.5e2704ad.png" alt="image-20210203165907616" tabindex="0" loading="lazy"><figcaption>image-20210203165907616</figcaption></figure><h4 id="_3-3-3ã€finally-ç‰ˆ" tabindex="-1"><a class="header-anchor" href="#_3-3-3ã€finally-ç‰ˆ"><span>3.3.3ã€finally ç‰ˆ</span></a></h4><blockquote><p><strong>å­˜åœ¨çš„é—®é¢˜</strong></p></blockquote><p>å¦‚æœä»£ç åœ¨æ‰§è¡Œçš„è¿‡ç¨‹ä¸­å‡ºç°å¼‚å¸¸ï¼Œé‚£ä¹ˆå°±å¯èƒ½æ— æ³•é‡Šæ”¾é”ï¼Œå› æ­¤å¿…é¡»è¦åœ¨ä»£ç å±‚é¢åŠ ä¸Š <code>finally</code> ä»£ç å—ï¼Œä¿è¯é”çš„é‡Šæ”¾</p><blockquote><p><strong>4.0 ç‰ˆæœ¬çš„ä»£ç ï¼šä¿è¯é”çš„é‡Šæ”¾</strong></p></blockquote><p>åŠ å…¥ finally ä»£ç å—ï¼Œä¿è¯é”çš„é‡Šæ”¾</p><pre><code>/**
 * @ClassName GoodController
 * @Description TODO
 * @Author Oneby
 * @Date 2021/2/2 18:59
 * @Version 1.0
 */
@RestController
public class GoodController {

    private static final String REDIS_LOCK_KEY = &quot;lockOneby&quot;;

    @Autowired
    private StringRedisTemplate stringRedisTemplate;

    @Value(&quot;${server.port}&quot;)
    private String serverPort;

    @GetMapping(&quot;/buy_goods&quot;)
    public String buy_Goods() {
        // å½“å‰è¯·æ±‚çš„ UUID + çº¿ç¨‹å
        String value = UUID.randomUUID().toString() + Thread.currentThread().getName();
        try {
            // setIfAbsent() å°±ç›¸å½“äº setnxï¼Œå¦‚æœä¸å­˜åœ¨å°±æ–°å»ºé”
            Boolean lockFlag = stringRedisTemplate.opsForValue().setIfAbsent(REDIS_LOCK_KEY, value);

            // æŠ¢é”å¤±è´¥
            if (lockFlag == false) {
                return &quot;æŠ¢é”å¤±è´¥ o(â•¥ï¹â•¥)o&quot;;
            }

            // ä» redis ä¸­è·å–å•†å“çš„å‰©ä½™æ•°é‡
            String result = stringRedisTemplate.opsForValue().get(&quot;goods:001&quot;);
            int goodsNumber = result == null ? 0 : Integer.parseInt(result);
            String retStr = null;

            // å•†å“æ•°é‡å¤§äºé›¶æ‰èƒ½å‡ºå”®
            if (goodsNumber &gt; 0) {
                int realNumber = goodsNumber - 1;
                stringRedisTemplate.opsForValue().set(&quot;goods:001&quot;, realNumber + &quot;&quot;);
                retStr = &quot;ä½ å·²ç»æˆåŠŸç§’æ€å•†å“ï¼Œæ­¤æ—¶è¿˜å‰©ä½™ï¼š&quot; + realNumber + &quot;ä»¶&quot; + &quot;\t æœåŠ¡å™¨ç«¯å£: &quot; + serverPort;
            } else {
                retStr = &quot;å•†å“å·²ç»å”®ç½„/æ´»åŠ¨ç»“æŸ/è°ƒç”¨è¶…æ—¶ï¼Œæ¬¢è¿ä¸‹æ¬¡å…‰ä¸´&quot; + &quot;\t æœåŠ¡å™¨ç«¯å£: &quot; + serverPort;
            }
            System.out.println(retStr);
            return retStr;
        } finally {
            stringRedisTemplate.delete(REDIS_LOCK_KEY); // é‡Šæ”¾åˆ†å¸ƒå¼é”
        }
    }

}
</code></pre><h4 id="_3-3-4ã€è¿‡æœŸæ—¶é—´ç‰ˆ" tabindex="-1"><a class="header-anchor" href="#_3-3-4ã€è¿‡æœŸæ—¶é—´ç‰ˆ"><span>3.3.4ã€è¿‡æœŸæ—¶é—´ç‰ˆ</span></a></h4><blockquote><p><strong>å­˜åœ¨çš„é—®é¢˜</strong></p></blockquote><p>å‡è®¾éƒ¨ç½²äº†å¾®æœåŠ¡ jar åŒ…çš„æœåŠ¡å™¨æŒ‚äº†ï¼Œä»£ç å±‚é¢æ ¹æœ¬æ²¡æœ‰èµ°åˆ° finally è¿™å—ï¼Œä¹Ÿæ²¡åŠæ³•ä¿è¯è§£é”ã€‚è¿™ä¸ª key æ²¡æœ‰è¢«åˆ é™¤ï¼Œå…¶ä»–å¾®æœåŠ¡å°±ä¸€ç›´æŠ¢ä¸åˆ°é”ï¼Œå› æ­¤æˆ‘ä»¬éœ€è¦åŠ å…¥ä¸€ä¸ªè¿‡æœŸæ—¶é—´é™å®šçš„ key</p><blockquote><p><strong>5.0 ç‰ˆæœ¬çš„ä»£ç ï¼šè®¾ç½®å¸¦è¿‡æœŸæ—¶é—´çš„ key</strong></p></blockquote><p>æ‰§è¡Œ <code>stringRedisTemplate.expire(REDIS_LOCK_KEY, 10L, TimeUnit.SECONDS);</code> æ–¹æ³•ä¸ºåˆ†å¸ƒå¼é”è®¾ç½®è¿‡æœŸæ—¶é—´ï¼Œä¿è¯é”çš„é‡Šæ”¾</p><pre><code>/**
 * @ClassName GoodController
 * @Description TODO
 * @Author Oneby
 * @Date 2021/2/2 18:59
 * @Version 1.0
 */
@RestController
public class GoodController {

    private static final String REDIS_LOCK_KEY = &quot;lockOneby&quot;;

    @Autowired
    private StringRedisTemplate stringRedisTemplate;

    @Value(&quot;${server.port}&quot;)
    private String serverPort;

    @GetMapping(&quot;/buy_goods&quot;)
    public String buy_Goods() {
        // å½“å‰è¯·æ±‚çš„ UUID + çº¿ç¨‹å
        String value = UUID.randomUUID().toString() + Thread.currentThread().getName();
        try {
            // setIfAbsent() å°±ç›¸å½“äº setnxï¼Œå¦‚æœä¸å­˜åœ¨å°±æ–°å»ºé”
            Boolean lockFlag = stringRedisTemplate.opsForValue().setIfAbsent(REDIS_LOCK_KEY, value);
            // è®¾ç½®è¿‡æœŸæ—¶é—´ä¸º 10s
            stringRedisTemplate.expire(REDIS_LOCK_KEY, 10L, TimeUnit.SECONDS);

            // æŠ¢é”å¤±è´¥
            if (lockFlag == false) {
                return &quot;æŠ¢é”å¤±è´¥ o(â•¥ï¹â•¥)o&quot;;
            }

            // ä» redis ä¸­è·å–å•†å“çš„å‰©ä½™æ•°é‡
            String result = stringRedisTemplate.opsForValue().get(&quot;goods:001&quot;);
            int goodsNumber = result == null ? 0 : Integer.parseInt(result);
            String retStr = null;

            // å•†å“æ•°é‡å¤§äºé›¶æ‰èƒ½å‡ºå”®
            if (goodsNumber &gt; 0) {
                int realNumber = goodsNumber - 1;
                stringRedisTemplate.opsForValue().set(&quot;goods:001&quot;, realNumber + &quot;&quot;);
                retStr = &quot;ä½ å·²ç»æˆåŠŸç§’æ€å•†å“ï¼Œæ­¤æ—¶è¿˜å‰©ä½™ï¼š&quot; + realNumber + &quot;ä»¶&quot; + &quot;\t æœåŠ¡å™¨ç«¯å£: &quot; + serverPort;
            } else {
                retStr = &quot;å•†å“å·²ç»å”®ç½„/æ´»åŠ¨ç»“æŸ/è°ƒç”¨è¶…æ—¶ï¼Œæ¬¢è¿ä¸‹æ¬¡å…‰ä¸´&quot; + &quot;\t æœåŠ¡å™¨ç«¯å£: &quot; + serverPort;
            }
            System.out.println(retStr);
            return retStr;
        } finally {
            stringRedisTemplate.delete(REDIS_LOCK_KEY); // é‡Šæ”¾åˆ†å¸ƒå¼é”
        }
    }

}
</code></pre><h4 id="_3-3-5ã€åŠ é”åŸå­ç‰ˆ" tabindex="-1"><a class="header-anchor" href="#_3-3-5ã€åŠ é”åŸå­ç‰ˆ"><span>3.3.5ã€åŠ é”åŸå­ç‰ˆ</span></a></h4><blockquote><p><strong>å­˜åœ¨çš„é—®é¢˜</strong></p></blockquote><p>åŠ é”ä¸è®¾ç½®è¿‡æœŸæ—¶é—´çš„æ“ä½œåˆ†å¼€äº†ï¼Œå‡è®¾æœåŠ¡å™¨åˆšåˆšæ‰§è¡Œäº†åŠ é”æ“ä½œï¼Œç„¶åå®•æœºäº†ï¼Œä¹Ÿæ²¡åŠæ³•ä¿è¯è§£é”ã€‚</p><blockquote><p><strong>6.0 ç‰ˆæœ¬çš„ä»£ç ï¼šä¿è¯åŠ é”å’Œè®¾ç½®è¿‡æœŸæ—¶é—´ä¸ºåŸå­æ“ä½œ</strong></p></blockquote><p>ä½¿ç”¨ <code>stringRedisTemplate.opsForValue().setIfAbsent(REDIS_LOCK_KEY, value, 10L, TimeUnit.SECONDS)</code> æ–¹æ³•ï¼Œåœ¨åŠ é”çš„åŒæ—¶è®¾ç½®è¿‡æœŸæ—¶é—´ï¼Œä¿è¯è¿™ä¸¤ä¸ªæ“ä½œçš„åŸå­æ€§</p><pre><code>/**
 * @ClassName GoodController
 * @Description TODO
 * @Author Oneby
 * @Date 2021/2/2 18:59
 * @Version 1.0
 */
@RestController
public class GoodController {

    private static final String REDIS_LOCK_KEY = &quot;lockOneby&quot;;

    @Autowired
    private StringRedisTemplate stringRedisTemplate;

    @Value(&quot;${server.port}&quot;)
    private String serverPort;

    @GetMapping(&quot;/buy_goods&quot;)
    public String buy_Goods() {
        // å½“å‰è¯·æ±‚çš„ UUID + çº¿ç¨‹å
        String value = UUID.randomUUID().toString() + Thread.currentThread().getName();
        try {
            // setIfAbsent() å°±ç›¸å½“äº setnxï¼Œå¦‚æœä¸å­˜åœ¨å°±æ–°å»ºé”ï¼ŒåŒæ—¶åŠ ä¸Šè¿‡æœŸæ—¶é—´ä¿è¯åŸå­æ€§
            Boolean lockFlag = stringRedisTemplate.opsForValue().setIfAbsent(REDIS_LOCK_KEY, value, 10L, TimeUnit.SECONDS);

            // æŠ¢é”å¤±è´¥
            if (lockFlag == false) {
                return &quot;æŠ¢é”å¤±è´¥ o(â•¥ï¹â•¥)o&quot;;
            }

            // ä» redis ä¸­è·å–å•†å“çš„å‰©ä½™æ•°é‡
            String result = stringRedisTemplate.opsForValue().get(&quot;goods:001&quot;);
            int goodsNumber = result == null ? 0 : Integer.parseInt(result);
            String retStr = null;

            // å•†å“æ•°é‡å¤§äºé›¶æ‰èƒ½å‡ºå”®
            if (goodsNumber &gt; 0) {
                int realNumber = goodsNumber - 1;
                stringRedisTemplate.opsForValue().set(&quot;goods:001&quot;, realNumber + &quot;&quot;);
                retStr = &quot;ä½ å·²ç»æˆåŠŸç§’æ€å•†å“ï¼Œæ­¤æ—¶è¿˜å‰©ä½™ï¼š&quot; + realNumber + &quot;ä»¶&quot; + &quot;\t æœåŠ¡å™¨ç«¯å£: &quot; + serverPort;
            } else {
                retStr = &quot;å•†å“å·²ç»å”®ç½„/æ´»åŠ¨ç»“æŸ/è°ƒç”¨è¶…æ—¶ï¼Œæ¬¢è¿ä¸‹æ¬¡å…‰ä¸´&quot; + &quot;\t æœåŠ¡å™¨ç«¯å£: &quot; + serverPort;
            }
            System.out.println(retStr);
            return retStr;
        } finally {
            stringRedisTemplate.delete(REDIS_LOCK_KEY); // é‡Šæ”¾åˆ†å¸ƒå¼é”
        }
    }

}
</code></pre><h4 id="_3-3-6ã€åŠ¨è‡ªå·±å¥¶é…ªç‰ˆ" tabindex="-1"><a class="header-anchor" href="#_3-3-6ã€åŠ¨è‡ªå·±å¥¶é…ªç‰ˆ"><span>3.3.6ã€åŠ¨è‡ªå·±å¥¶é…ªç‰ˆ</span></a></h4><blockquote><p><strong>å­˜åœ¨çš„é—®é¢˜</strong></p></blockquote><p>å¼ å† ææˆ´ï¼Œåˆ é™¤äº†åˆ«äººçš„é”ï¼šæˆ‘ä»¬æ— æ³•ä¿è¯ä¸€ä¸ªä¸šåŠ¡çš„æ‰§è¡Œæ—¶é—´ï¼Œæœ‰å¯èƒ½æ˜¯ 10sï¼Œæœ‰å¯èƒ½æ˜¯ 20sï¼Œä¹Ÿæœ‰å¯èƒ½æ›´é•¿ã€‚å› ä¸ºæ‰§è¡Œä¸šåŠ¡çš„æ—¶å€™å¯èƒ½ä¼šè°ƒç”¨å…¶ä»–æœåŠ¡ï¼Œæˆ‘ä»¬å¹¶ä¸èƒ½ä¿è¯å…¶ä»–æœåŠ¡çš„è°ƒç”¨æ—¶é—´ã€‚å¦‚æœè®¾ç½®çš„é”è¿‡æœŸäº†ï¼Œå½“å‰ä¸šåŠ¡è¿˜æ­£åœ¨æ‰§è¡Œï¼Œé‚£ä¹ˆå°±æœ‰å¯èƒ½å‡ºç°è¶…å–é—®é¢˜ï¼Œå¹¶ä¸”è¿˜æœ‰å¯èƒ½å‡ºç°å½“å‰ä¸šåŠ¡æ‰§è¡Œå®Œæˆåï¼Œé‡Šæ”¾äº†å…¶ä»–ä¸šåŠ¡çš„é”</p><p>å¦‚ä¸‹å›¾ï¼Œå‡è®¾è¿›ç¨‹ A åœ¨ T2 æ—¶åˆ»è®¾ç½®äº†ä¸€æŠŠè¿‡æœŸæ—¶é—´ä¸º 30s çš„é”ï¼Œåœ¨ T5 æ—¶åˆ»è¯¥é”è¿‡æœŸè¢«é‡Šæ”¾ï¼Œåœ¨ T5 å’Œ T6 æœŸé—´ï¼ŒTest è¿™æŠŠé”å·²ç»å¤±æ•ˆäº†ï¼Œå¹¶ä¸èƒ½ä¿è¯è¿›ç¨‹ A ä¸šåŠ¡çš„åŸå­æ€§äº†ã€‚äºæ˜¯è¿›ç¨‹ B åœ¨ T6 æ—¶åˆ»èƒ½å¤Ÿè·å– Test è¿™æŠŠé”ï¼Œä½†æ˜¯è¿›ç¨‹ A åœ¨ T7 æ—¶åˆ»åˆ é™¤äº†è¿›ç¨‹ B åŠ çš„é”ï¼Œè¿›ç¨‹ B åœ¨ T8 æ—¶åˆ»åˆ é™¤é”çš„æ—¶å€™å°±è’™è”½äº†ï¼Œæˆ‘ TM é”å‘¢ï¼Ÿ</p><figure><img src="/assets/img/7779829b07787062d2fb57a8f91bb5ce.309b3436.png" alt="image-20210204161115030" tabindex="0" loading="lazy"><figcaption>image-20210204161115030</figcaption></figure><blockquote><p><strong>7.0 ç‰ˆæœ¬çš„ä»£ç ï¼šåªå…è®¸åˆ é™¤è‡ªå·±çš„é”ï¼Œä¸å…è®¸åˆ é™¤åˆ«äººçš„é”</strong></p></blockquote><p>åœ¨é‡Šæ”¾é”ä¹‹å‰ï¼Œæ‰§è¡Œ <code>value.equalsIgnoreCase(stringRedisTemplate.opsForValue().get(REDIS_LOCK_KEY))</code> æ–¹æ³•åˆ¤æ–­æ˜¯å¦ä¸ºè‡ªå·±åŠ çš„é”</p><pre><code>/**
 * @ClassName GoodController
 * @Description TODO
 * @Author Oneby
 * @Date 2021/2/2 18:59
 * @Version 1.0
 */
@RestController
public class GoodController {

    private static final String REDIS_LOCK_KEY = &quot;lockOneby&quot;;

    @Autowired
    private StringRedisTemplate stringRedisTemplate;

    @Value(&quot;${server.port}&quot;)
    private String serverPort;

    @GetMapping(&quot;/buy_goods&quot;)
    public String buy_Goods() {
        // å½“å‰è¯·æ±‚çš„ UUID + çº¿ç¨‹å
        String value = UUID.randomUUID().toString() + Thread.currentThread().getName();
        try {
            // setIfAbsent() å°±ç›¸å½“äº setnxï¼Œå¦‚æœä¸å­˜åœ¨å°±æ–°å»ºé”ï¼ŒåŒæ—¶åŠ ä¸Šè¿‡æœŸæ—¶é—´ä¿è¯åŸå­æ€§
            Boolean lockFlag = stringRedisTemplate.opsForValue().setIfAbsent(REDIS_LOCK_KEY, value, 10L, TimeUnit.SECONDS);

            // æŠ¢é”å¤±è´¥
            if (lockFlag == false) {
                return &quot;æŠ¢é”å¤±è´¥ o(â•¥ï¹â•¥)o&quot;;
            }

            // ä» redis ä¸­è·å–å•†å“çš„å‰©ä½™æ•°é‡
            String result = stringRedisTemplate.opsForValue().get(&quot;goods:001&quot;);
            int goodsNumber = result == null ? 0 : Integer.parseInt(result);
            String retStr = null;

            // å•†å“æ•°é‡å¤§äºé›¶æ‰èƒ½å‡ºå”®
            if (goodsNumber &gt; 0) {
                int realNumber = goodsNumber - 1;
                stringRedisTemplate.opsForValue().set(&quot;goods:001&quot;, realNumber + &quot;&quot;);
                retStr = &quot;ä½ å·²ç»æˆåŠŸç§’æ€å•†å“ï¼Œæ­¤æ—¶è¿˜å‰©ä½™ï¼š&quot; + realNumber + &quot;ä»¶&quot; + &quot;\t æœåŠ¡å™¨ç«¯å£: &quot; + serverPort;
            } else {
                retStr = &quot;å•†å“å·²ç»å”®ç½„/æ´»åŠ¨ç»“æŸ/è°ƒç”¨è¶…æ—¶ï¼Œæ¬¢è¿ä¸‹æ¬¡å…‰ä¸´&quot; + &quot;\t æœåŠ¡å™¨ç«¯å£: &quot; + serverPort;
            }
            System.out.println(retStr);
            return retStr;
        } finally {
            // åˆ¤æ–­æ˜¯å¦æ˜¯è‡ªå·±åŠ çš„é”
            if(value.equalsIgnoreCase(stringRedisTemplate.opsForValue().get(REDIS_LOCK_KEY))){
                stringRedisTemplate.delete(REDIS_LOCK_KEY); // é‡Šæ”¾åˆ†å¸ƒå¼é”
            }
        }
    }

}
</code></pre><h4 id="_3-3-7ã€è§£é”åŸå­ç‰ˆ" tabindex="-1"><a class="header-anchor" href="#_3-3-7ã€è§£é”åŸå­ç‰ˆ"><span>3.3.7ã€è§£é”åŸå­ç‰ˆ</span></a></h4><blockquote><p><strong>å­˜åœ¨çš„é—®é¢˜</strong></p></blockquote><p>åœ¨ finally ä»£ç å—ä¸­çš„åˆ¤æ–­ä¸åˆ é™¤å¹¶ä¸æ˜¯åŸå­æ“ä½œï¼Œå‡è®¾æ‰§è¡Œ <code>if</code> åˆ¤æ–­çš„æ—¶å€™ï¼Œè¿™æŠŠé”è¿˜æ˜¯å±äºå½“å‰ä¸šåŠ¡ï¼Œä½†æ˜¯æœ‰å¯èƒ½åˆšæ‰§è¡Œå®Œ <code>if</code> åˆ¤æ–­ï¼Œè¿™æŠŠé”å°±è¢«å…¶ä»–ä¸šåŠ¡ç»™é‡Šæ”¾äº†ï¼Œè¿˜æ˜¯ä¼šå‡ºç°è¯¯åˆ é”çš„æƒ…å†µ</p><pre><code>try {
    // ...
}
finally {
    // åˆ¤æ–­åŠ é”ä¸è§£é”æ˜¯ä¸æ˜¯åŒä¸€ä¸ªå®¢æˆ·ç«¯
    if (value.equalsIgnoreCase(stringRedisTemplate.opsForValue().get(REDIS_LOCK_KEY))){
        // è‹¥åœ¨æ­¤æ—¶ï¼Œè¿™æŠŠé”çªç„¶ä¸æ˜¯è¿™ä¸ªå®¢æˆ·ç«¯çš„ï¼Œåˆ™ä¼šè¯¯è§£é”
        stringRedisTemplate.delete(REDIS_LOCK_KEY);//é‡Šæ”¾é”
    }
}
</code></pre><blockquote><p><strong>8.1 ç‰ˆæœ¬çš„ä»£ç ï¼šä½¿ç”¨ redis è‡ªèº«äº‹åŠ¡ä¿è¯åŸå­æ€§æ“ä½œ</strong></p></blockquote><p><strong>redis äº‹åŠ¡ç›¸å…³å‘½ä»¤å¤ä¹ </strong></p><p><strong>1ã€äº‹åŠ¡ä»‹ç»</strong></p><ol><li>Redisçš„äº‹åŠ¡æ˜¯é€šè¿‡MULTlï¼ŒEXECï¼ŒDISCARDå’ŒWATCHè¿™å››ä¸ªå‘½ä»¤æ¥å®Œæˆã€‚</li><li>Redisçš„å•ä¸ªå‘½ä»¤éƒ½æ˜¯åŸå­æ€§çš„ï¼Œæ‰€ä»¥è¿™é‡Œç¡®ä¿äº‹åŠ¡æ€§çš„å¯¹è±¡æ˜¯å‘½ä»¤é›†åˆã€‚</li><li>Rediså°†å‘½ä»¤é›†åˆåºåˆ—åŒ–å¹¶ç¡®ä¿å¤„äºä¸€äº‹åŠ¡çš„å‘½ä»¤é›†åˆè¿ç»­ä¸”ä¸è¢«æ‰“æ–­çš„æ‰§è¡Œã€‚</li><li>Redisä¸æ”¯æŒå›æ»šçš„æ“ä½œã€‚</li></ol><p><strong>2ã€ç›¸å…³å‘½ä»¤</strong></p><ol><li><code>MULTI</code><ol><li>ç”¨äºæ ‡è®°äº‹åŠ¡å—çš„å¼€å§‹ã€‚</li><li>Redisä¼šå°†åç»­çš„å‘½ä»¤é€ä¸ªæ”¾å…¥é˜Ÿåˆ—ä¸­ï¼Œç„¶åä½¿ç”¨EXECå‘½ä»¤åŸå­åŒ–åœ°æ‰§è¡Œè¿™ä¸ªå‘½ä»¤åºåˆ—ã€‚</li><li>è¯­æ³•ï¼š<code>MULTI</code></li></ol></li><li><code>EXEC</code><ol><li>åœ¨ä¸€ä¸ªäº‹åŠ¡ä¸­æ‰§è¡Œæ‰€æœ‰å…ˆå‰æ”¾å…¥é˜Ÿåˆ—çš„å‘½ä»¤ï¼Œç„¶åæ¢å¤æ­£å¸¸çš„è¿æ¥çŠ¶æ€ã€‚</li><li>è¯­æ³•ï¼š<code>EXEC</code></li></ol></li><li><code>DISCARD</code><ol><li>æ¸…é™¤æ‰€æœ‰å…ˆå‰åœ¨ä¸€ä¸ªäº‹åŠ¡ä¸­æ”¾å…¥é˜Ÿåˆ—çš„å‘½ä»¤ï¼Œç„¶åæ¢å¤æ­£å¸¸çš„è¿æ¥çŠ¶æ€ã€‚</li><li>è¯­æ³•ï¼š<code>DISCARD</code></li></ol></li><li>WATCH <ol><li>å½“æŸä¸ªäº‹åŠ¡éœ€è¦æŒ‰æ¡ä»¶æ‰§è¡Œæ—¶ï¼Œå°±è¦ä½¿ç”¨è¿™ä¸ªå‘½ä»¤å°†ç»™å®šçš„é”®è®¾ç½®ä¸ºå—ç›‘æ§çš„çŠ¶æ€ã€‚</li><li>è¯­æ³•ï¼š<code>WATCH key[key..â€¦]</code>æ³¨ï¼šè¯¥å‘½ä»¤å¯ä»¥å®ç°redisçš„ä¹è§‚é”</li></ol></li><li><code>UNWATCH</code><ol><li>æ¸…é™¤æ‰€æœ‰å…ˆå‰ä¸ºä¸€ä¸ªäº‹åŠ¡ç›‘æ§çš„é”®ã€‚</li><li>è¯­æ³•ï¼š<code>UNWATCH</code></li></ol></li></ol><hr><p><strong>æ¼”ç¤ºäº‹åŠ¡çš„ä½¿ç”¨</strong></p><p>ClienA ä½¿ç”¨ <code>MULTI</code> å‘½ä»¤å¼€å¯ä¸€ä¸ªäº‹åŠ¡ï¼Œå¹¶æ‰§è¡Œ <code>SET lock 1</code> å‘½ä»¤ï¼Œå½“å¼€å¯äº‹åŠ¡ä¹‹åï¼Œæ‰§è¡Œå‘½ä»¤è¿”å› QUEUEDï¼Œè¡¨ç¤ºå·²ç»å°†è¯¥å‘½ä»¤å‹å…¥é˜Ÿåˆ—</p><figure><img src="/assets/img/02ef0afa6b319cbbfed109f1cf6ba25c.74e0eda8.png" alt="image-20210204170555664" tabindex="0" loading="lazy"><figcaption>image-20210204170555664</figcaption></figure><p>ClientB æ‰§è¡Œ <code>SET lock 2</code> å‘½ä»¤å°† <code>lock</code> çš„å€¼è®¾ç½®ä¸º <code>2</code></p><figure><img src="/assets/img/05f0b85658fe29d813689d9333f654d2.2739feec.png" alt="image-20210204170725293" tabindex="0" loading="lazy"><figcaption>image-20210204170725293</figcaption></figure><p>ClientA æ‰§è¡Œ <code>EXEC</code> å‘½ä»¤æäº¤äº‹åŠ¡ï¼Œæ‰§è¡Œ <code>get lock</code> å‘½ä»¤è·å–åˆ° <code>lock</code> çš„å€¼ä¸º <code>1</code>ï¼ˆClientB è™½ç„¶åŠ å¡ï¼Œä½†ä¸å½±å“ ClientA çš„äº‹åŠ¡ï¼Œä½†è¿™ä¸æ˜¯æˆ‘ä»¬æƒ³è¦çš„æ•ˆæœï¼‰</p><figure><img src="/assets/img/6bd44e45f51bb7d463d267cdb4cecc71.f7783609.png" alt="image-20210204170845237" tabindex="0" loading="lazy"><figcaption>image-20210204170845237</figcaption></figure><hr><p><strong>æ¼”ç¤º WATCH çš„ä½¿ç”¨</strong></p><p>ClientA å…ˆä½¿ç”¨ <code>WATCH lock</code> å‘½ä»¤è§ç›‘è§† <code>lock</code> è¿™æŠŠé”ï¼Œç„¶åä½¿ç”¨ <code>MULTI</code> å‘½ä»¤å¼€å¯äº‹åŠ¡ä¿®æ”¹ <code>lock</code> çš„å€¼</p><figure><img src="/assets/img/daba90cf633e4ea3e1a2eed5c21bd920.164706ad.png" alt="image-20210204171141855" tabindex="0" loading="lazy"><figcaption>image-20210204171141855</figcaption></figure><p>ClientB æ‰§è¡Œ <code>set lock 4</code> å‘½ä»¤å°† <code>lock</code> çš„å€¼ä¿®æ”¹ä¸º <code>4</code></p><figure><img src="/assets/img/5c830ded1144b17988d27ecd895165dc.88e5a09b.png" alt="image-20210204171209116" tabindex="0" loading="lazy"><figcaption>image-20210204171209116</figcaption></figure><p>ClientA æ‰§è¡Œ <code>EXEC</code> å‘½ä»¤æäº¤äº‹åŠ¡ï¼Œå‘ç°å‘½ä»¤çš„è¿”å›å€¼ä¸º <code>nil</code>ï¼Œè¡¨ç¤ºäº‹åŠ¡æ‰§è¡Œå¤±è´¥ï¼Œä½¿ç”¨ <code>GET lock</code> è·å– <code>lock</code> å˜é‡çš„å€¼ä¸º <code>4</code>ï¼ˆä¿®æ”¹å¤±è´¥ï¼‰ï¼Œ<code>WATCH</code> ä¹‹åè®°å¾—ä½¿ç”¨ <code>UNWATCH</code> è§£é™¤ç›‘è§†</p><figure><img src="/assets/img/a97327452ab3fe4eee61256b2c1ab5e2.2d1be343.png" alt="image-20210204171426866" tabindex="0" loading="lazy"><figcaption>image-20210204171426866</figcaption></figure><hr><p><strong>ä»£ç </strong></p><p>å¼€å¯äº‹åŠ¡ä¸æ–­ç›‘è§† <code>REDIS_LOCK_KEY</code> è¿™æŠŠé”æœ‰æ²¡æœ‰è¢«åˆ«äººåŠ¨è¿‡ï¼Œå¦‚æœå·²ç»è¢«åˆ«äººåŠ¨è¿‡äº†ï¼Œé‚£ä¹ˆç»§ç»­é‡æ–°æ‰§è¡Œåˆ é™¤æ“ä½œï¼Œå¦åˆ™å°±è§£é™¤ç›‘è§†</p><pre><code>/**
 * @ClassName GoodController
 * @Description TODO
 * @Author Oneby
 * @Date 2021/2/2 18:59
 * @Version 1.0
 */
@RestController
public class GoodController {

    private static final String REDIS_LOCK_KEY = &quot;lockOneby&quot;;

    @Autowired
    private StringRedisTemplate stringRedisTemplate;

    @Value(&quot;${server.port}&quot;)
    private String serverPort;

    @GetMapping(&quot;/buy_goods&quot;)
    public String buy_Goods() {
        // å½“å‰è¯·æ±‚çš„ UUID + çº¿ç¨‹å
        String value = UUID.randomUUID().toString() + Thread.currentThread().getName();
        try {
            // setIfAbsent() å°±ç›¸å½“äº setnxï¼Œå¦‚æœä¸å­˜åœ¨å°±æ–°å»ºé”ï¼ŒåŒæ—¶åŠ ä¸Šè¿‡æœŸæ—¶é—´ä¿è¯åŸå­æ€§
            Boolean lockFlag = stringRedisTemplate.opsForValue().setIfAbsent(REDIS_LOCK_KEY, value, 10L, TimeUnit.SECONDS);

            // æŠ¢é”å¤±è´¥
            if (lockFlag == false) {
                return &quot;æŠ¢é”å¤±è´¥ o(â•¥ï¹â•¥)o&quot;;
            }

            // ä» redis ä¸­è·å–å•†å“çš„å‰©ä½™æ•°é‡
            String result = stringRedisTemplate.opsForValue().get(&quot;goods:001&quot;);
            int goodsNumber = result == null ? 0 : Integer.parseInt(result);
            String retStr = null;

            // å•†å“æ•°é‡å¤§äºé›¶æ‰èƒ½å‡ºå”®
            if (goodsNumber &gt; 0) {
                int realNumber = goodsNumber - 1;
                stringRedisTemplate.opsForValue().set(&quot;goods:001&quot;, realNumber + &quot;&quot;);
                retStr = &quot;ä½ å·²ç»æˆåŠŸç§’æ€å•†å“ï¼Œæ­¤æ—¶è¿˜å‰©ä½™ï¼š&quot; + realNumber + &quot;ä»¶&quot; + &quot;\t æœåŠ¡å™¨ç«¯å£: &quot; + serverPort;
            } else {
                retStr = &quot;å•†å“å·²ç»å”®ç½„/æ´»åŠ¨ç»“æŸ/è°ƒç”¨è¶…æ—¶ï¼Œæ¬¢è¿ä¸‹æ¬¡å…‰ä¸´&quot; + &quot;\t æœåŠ¡å™¨ç«¯å£: &quot; + serverPort;
            }
            System.out.println(retStr);
            return retStr;
        } finally {
            while (true) {
                //åŠ äº‹åŠ¡ï¼Œä¹è§‚é”
                stringRedisTemplate.watch(REDIS_LOCK_KEY);
                // åˆ¤æ–­æ˜¯å¦æ˜¯è‡ªå·±åŠ çš„é”
                if (value.equalsIgnoreCase(stringRedisTemplate.opsForValue().get(REDIS_LOCK_KEY))) {
                    // å¼€å¯äº‹åŠ¡
                    stringRedisTemplate.setEnableTransactionSupport(true);
                    stringRedisTemplate.multi();
                    stringRedisTemplate.delete(REDIS_LOCK_KEY);
                    // åˆ¤æ–­äº‹åŠ¡æ˜¯å¦æ‰§è¡ŒæˆåŠŸï¼Œå¦‚æœç­‰äº nullï¼Œå°±æ˜¯æ²¡æœ‰åˆ æ‰ï¼Œåˆ é™¤å¤±è´¥ï¼Œå†å›å» while å¾ªç¯é‚£å†é‡æ–°æ‰§è¡Œåˆ é™¤
                    List&lt;Object&gt; list = stringRedisTemplate.exec();
                    if (list == null) {
                        continue;
                    }
                }
                //å¦‚æœåˆ é™¤æˆåŠŸï¼Œé‡Šæ”¾ç›‘æ§å™¨ï¼Œå¹¶ä¸” break è·³å‡ºå½“å‰å¾ªç¯
                stringRedisTemplate.unwatch();
                break;
            }
        }
    }

}
</code></pre><blockquote><p><strong>8.1 ç‰ˆæœ¬çš„ä»£ç ï¼šä½¿ç”¨ lua è„šæœ¬ä¿è¯åŸå­æ€§æ“ä½œ</strong></p></blockquote><p><a href="https://redis.io/commands/set" target="_blank" rel="noopener noreferrer">lua è„šæœ¬</a></p><p>redis å¯ä»¥é€šè¿‡ <code>eval</code> å‘½ä»¤ä¿è¯ä»£ç æ‰§è¡Œçš„åŸå­æ€§</p><figure><img src="/assets/img/f8dda21727ecd0a9163b9c4e216a6ea5.f3816348.png" alt="image-20210204173538862" tabindex="0" loading="lazy"><figcaption>image-20210204173538862</figcaption></figure><hr><p><strong>ä»£ç </strong></p><p><strong>1ã€<code>RedisUtils</code> å·¥å…·ç±»</strong></p><p><code>getJedis()</code> æ–¹æ³•ç”¨äºä» <code>jedisPool</code> ä¸­è·å–ä¸€ä¸ªè¿æ¥å—å¯¹è±¡</p><pre><code>/**
 * @ClassName RedisUtils
 * @Description TODO
 * @Author Oneby
 * @Date 2021/2/4 17:41
 * @Version 1.0
 */
public class RedisUtils {

    private static JedisPool jedisPool;

    private static String hostAddr = &quot;192.168.152.233&quot;;

    static {
        JedisPoolConfig jedisPoolConfig = new JedisPoolConfig();
        jedisPoolConfig.setMaxTotal(20);
        jedisPoolConfig.setMaxIdle(10);
        jedisPool = new JedisPool(jedisPoolConfig, hostAddr, 6379, 100000);
    }

    public static Jedis getJedis() throws Exception {
        if (null != jedisPool) {
            return jedisPool.getResource();
        }
        throw new Exception(&quot;Jedispool is not ok&quot;);
    }

}
</code></pre><p><strong>2ã€ä½¿ç”¨ lua è„šæœ¬ä¿è¯è§£é”æ“ä½œçš„åŸå­æ€§</strong></p><pre><code>/**
 * @ClassName GoodController
 * @Description TODO
 * @Author Oneby
 * @Date 2021/2/2 18:59
 * @Version 1.0
 */
@RestController
public class GoodController {

    private static final String REDIS_LOCK_KEY = &quot;lockOneby&quot;;

    @Autowired
    private StringRedisTemplate stringRedisTemplate;

    @Value(&quot;${server.port}&quot;)
    private String serverPort;

    @GetMapping(&quot;/buy_goods&quot;)
    public String buy_Goods() throws Exception {
        // å½“å‰è¯·æ±‚çš„ UUID + çº¿ç¨‹å
        String value = UUID.randomUUID().toString() + Thread.currentThread().getName();
        try {
            // setIfAbsent() å°±ç›¸å½“äº setnxï¼Œå¦‚æœä¸å­˜åœ¨å°±æ–°å»ºé”ï¼ŒåŒæ—¶åŠ ä¸Šè¿‡æœŸæ—¶é—´ä¿è¯åŸå­æ€§
            Boolean lockFlag = stringRedisTemplate.opsForValue().setIfAbsent(REDIS_LOCK_KEY, value, 10L, TimeUnit.SECONDS);

            // æŠ¢é”å¤±è´¥
            if (lockFlag == false) {
                return &quot;æŠ¢é”å¤±è´¥ o(â•¥ï¹â•¥)o&quot;;
            }

            // ä» redis ä¸­è·å–å•†å“çš„å‰©ä½™æ•°é‡
            String result = stringRedisTemplate.opsForValue().get(&quot;goods:001&quot;);
            int goodsNumber = result == null ? 0 : Integer.parseInt(result);
            String retStr = null;

            // å•†å“æ•°é‡å¤§äºé›¶æ‰èƒ½å‡ºå”®
            if (goodsNumber &gt; 0) {
                int realNumber = goodsNumber - 1;
                stringRedisTemplate.opsForValue().set(&quot;goods:001&quot;, realNumber + &quot;&quot;);
                retStr = &quot;ä½ å·²ç»æˆåŠŸç§’æ€å•†å“ï¼Œæ­¤æ—¶è¿˜å‰©ä½™ï¼š&quot; + realNumber + &quot;ä»¶&quot; + &quot;\t æœåŠ¡å™¨ç«¯å£: &quot; + serverPort;
            } else {
                retStr = &quot;å•†å“å·²ç»å”®ç½„/æ´»åŠ¨ç»“æŸ/è°ƒç”¨è¶…æ—¶ï¼Œæ¬¢è¿ä¸‹æ¬¡å…‰ä¸´&quot; + &quot;\t æœåŠ¡å™¨ç«¯å£: &quot; + serverPort;
            }
            System.out.println(retStr);
            return retStr;
        } finally {
            // è·å–è¿æ¥å¯¹è±¡
            Jedis jedis = RedisUtils.getJedis();
            // lua è„šæœ¬ï¼Œæ‘˜è‡ªå®˜ç½‘
            String script = &quot;if redis.call(&#39;get&#39;, KEYS[1]) == ARGV[1]&quot; + &quot;then &quot;
                    + &quot;return redis.call(&#39;del&#39;, KEYS[1])&quot; + &quot;else &quot; + &quot;  return 0 &quot; + &quot;end&quot;;
            try {
                // æ‰§è¡Œ lua è„šæœ¬
                Object result = jedis.eval(script, Collections.singletonList(REDIS_LOCK_KEY), Collections.singletonList(value));
                // è·å– lua è„šæœ¬çš„æ‰§è¡Œç»“æœ
                if (&quot;1&quot;.equals(result.toString())) {
                    System.out.println(&quot;------del REDIS_LOCK_KEY success&quot;);
                } else {
                    System.out.println(&quot;------del REDIS_LOCK_KEY error&quot;);
                }
            } finally {
                // å…³é—­é“¾æ¥
                if (null != jedis) {
                    jedis.close();
                }
            }
        }
    }

}
</code></pre><p><strong>3ã€ä»£ç æµ‹è¯•</strong></p><p>ä½¿ç”¨ lua è„šæœ¬å¯ä»¥é˜²æ­¢åˆ«äººåŠ¨æˆ‘ä»¬è‡ªå·±çš„é”~~~</p><figure><img src="/assets/img/c0605673aefcef02a014f8620bbde92d.c510d209.png" alt="image-20210204180354202" tabindex="0" loading="lazy"><figcaption>image-20210204180354202</figcaption></figure><h4 id="_3-3-8ã€è‡ªåŠ¨ç»­æœŸç‰ˆ" tabindex="-1"><a class="header-anchor" href="#_3-3-8ã€è‡ªåŠ¨ç»­æœŸç‰ˆ"><span>3.3.8ã€è‡ªåŠ¨ç»­æœŸç‰ˆ</span></a></h4><blockquote><p><strong>å­˜åœ¨çš„é—®é¢˜</strong></p></blockquote><p>å‰é¢å·²ç»è®²è¿‡äº†ï¼šæˆ‘ä»¬æ— æ³•ä¿è¯ä¸€ä¸ªä¸šåŠ¡çš„æ‰§è¡Œæ—¶é—´ï¼Œæœ‰å¯èƒ½æ˜¯ 10sï¼Œæœ‰å¯èƒ½æ˜¯ 20sï¼Œä¹Ÿæœ‰å¯èƒ½æ›´é•¿ã€‚å› ä¸ºæ‰§è¡Œä¸šåŠ¡çš„æ—¶å€™å¯èƒ½ä¼šè°ƒç”¨å…¶ä»–æœåŠ¡ï¼Œæˆ‘ä»¬å¹¶ä¸èƒ½ä¿è¯å…¶ä»–æœåŠ¡çš„è°ƒç”¨æ—¶é—´ã€‚å¦‚æœè®¾ç½®çš„é”è¿‡æœŸäº†ï¼Œå½“å‰ä¸šåŠ¡è¿˜æ­£åœ¨æ‰§è¡Œï¼Œé‚£ä¹ˆä¹‹å‰è®¾ç½®çš„é”å°±å¤±æ•ˆäº†ï¼Œå°±æœ‰å¯èƒ½å‡ºç°è¶…å–é—®é¢˜ã€‚</p><p>å› æ­¤æˆ‘ä»¬éœ€è¦ç¡®ä¿ redisLock è¿‡æœŸæ—¶é—´å¤§äºä¸šåŠ¡æ‰§è¡Œæ—¶é—´çš„é—®é¢˜ï¼Œå³é¢ä¸´å¦‚ä½•å¯¹ Redis åˆ†å¸ƒå¼é”è¿›è¡Œç»­æœŸçš„é—®é¢˜</p><blockquote><p><strong>redis ä¸ zookeeper åœ¨ CAP æ–¹é¢çš„å¯¹æ¯”</strong></p></blockquote><p><strong>redis</strong></p><p>redis å¼‚æ­¥å¤åˆ¶é€ æˆçš„é”ä¸¢å¤±ï¼Œ æ¯”å¦‚ï¼šä¸»èŠ‚ç‚¹æ²¡æ¥çš„åŠæŠŠåˆšåˆš set è¿›æ¥è¿™æ¡æ•°æ®ç»™ä»èŠ‚ç‚¹ï¼Œå°±æŒ‚äº†ï¼Œé‚£ä¹ˆä¸»èŠ‚ç‚¹å’Œä»èŠ‚ç‚¹çš„æ•°æ®å°±ä¸ä¸€è‡´ã€‚æ­¤æ—¶å¦‚æœé›†ç¾¤æ¨¡å¼ä¸‹ï¼Œå°±å¾—ä¸Š Redisson æ¥è§£å†³</p><hr><p><strong>zookeeper</strong></p><p>zookeeper ä¿æŒå¼ºä¸€è‡´æ€§åŸåˆ™ï¼Œå¯¹äºé›†ç¾¤ä¸­æ‰€æœ‰èŠ‚ç‚¹æ¥è¯´ï¼Œè¦ä¹ˆåŒæ—¶æ›´æ–°æˆåŠŸï¼Œè¦ä¹ˆå¤±è´¥ï¼Œå› æ­¤ä½¿ç”¨ zookeeper é›†ç¾¤å¹¶ä¸å­˜åœ¨ä¸»ä»èŠ‚ç‚¹æ•°æ®ä¸¢å¤±çš„é—®é¢˜ï¼Œä½†ä¸¢å¤±äº†é€Ÿåº¦æ–¹é¢çš„æ€§èƒ½</p><blockquote><p><strong>9.0 ç‰ˆæœ¬çš„ä»£ç ï¼šä½¿ç”¨ Redisson å®ç°è‡ªåŠ¨ç»­æœŸåŠŸèƒ½</strong></p></blockquote><p>redis é›†ç¾¤ç¯å¢ƒä¸‹ï¼Œæˆ‘ä»¬è‡ªå·±å†™çš„ä¹Ÿä¸OKï¼Œç›´æ¥ä¸Š RedLock ä¹‹ Redisson è½åœ°å®ç°</p><ol><li><a href="https://redis.io/topics/distlock" target="_blank" rel="noopener noreferrer">redis åˆ†å¸ƒå¼é”</a></li><li><a href="https://github.com/redisson/redisson" target="_blank" rel="noopener noreferrer">redisson GitHub åœ°å€</a></li></ol><hr><p><strong>ä»£ç å®ç°</strong></p><p><strong>1ã€æ³¨å…¥ <code>Redisson</code> å¯¹è±¡</strong></p><p>åœ¨ <code>RedisConfig</code> é…ç½®ç±»ä¸­æ³¨å…¥ <code>Redisson</code> å¯¹è±¡</p><pre><code>/**
 * @ClassName RedisConfig
 * @Description TODO
 * @Author Oneby
 * @Date 2021/2/2 18:55
 * @Version 1.0
 */
@Configuration
public class RedisConfig {

    @Value(&quot;${spring.redis.host}&quot;)
    private String redisHost;

    @Bean
    public RedisTemplate&lt;String, Serializable&gt; redisTemplate(LettuceConnectionFactory connectionFactory) {
        // æ–°å»º RedisTemplate å¯¹è±¡ï¼Œkey ä¸º String å¯¹è±¡ï¼Œvalue ä¸º Serializableï¼ˆå¯åºåˆ—åŒ–çš„ï¼‰å¯¹è±¡
        RedisTemplate&lt;String, Serializable&gt; redisTemplate = new RedisTemplate&lt;&gt;();
        // key å€¼ä½¿ç”¨å­—ç¬¦ä¸²åºåˆ—åŒ–å™¨
        redisTemplate.setKeySerializer(new StringRedisSerializer());
        // value å€¼ä½¿ç”¨ json åºåˆ—åŒ–å™¨
        redisTemplate.setValueSerializer(new GenericJackson2JsonRedisSerializer());
        // ä¼ å…¥è¿æ¥å·¥å‚
        redisTemplate.setConnectionFactory(connectionFactory);
        // è¿”å› redisTemplate å¯¹è±¡
        return redisTemplate;
    }

    @Bean
    public Redisson redisson() {
        Config config = new Config();
        config.useSingleServer().setAddress(&quot;redis://&quot; + redisHost + &quot;:6379&quot;).setDatabase(0);
        return (Redisson) Redisson.create(config);
    }

}
</code></pre><p><strong>2ã€ä¸šåŠ¡é€»è¾‘</strong></p><p>ç›´æ¥ <code>redissonLock.lock()</code>ã€<code>redissonLock.unlock()</code> å®Œäº‹å„¿ï¼Œè¿™å°¼ç›å°±æ˜¯ juc ç‰ˆæœ¬çš„ redis åˆ†å¸ƒå¼é”å•Š</p><pre><code>/**
 * @ClassName GoodController
 * @Description TODO
 * @Author Oneby
 * @Date 2021/2/2 18:59
 * @Version 1.0
 */
@RestController
public class GoodController {

    private static final String REDIS_LOCK_KEY = &quot;lockOneby&quot;;

    @Autowired
    private StringRedisTemplate stringRedisTemplate;

    @Value(&quot;${server.port}&quot;)
    private String serverPort;

    @Autowired
    private Redisson redisson;

    @GetMapping(&quot;/buy_goods&quot;)
    public String buy_Goods() throws Exception {
        // å½“å‰è¯·æ±‚çš„ UUID + çº¿ç¨‹å
        String value = UUID.randomUUID().toString() + Thread.currentThread().getName();
        // è·å–é”
        RLock redissonLock = redisson.getLock(REDIS_LOCK_KEY);
        // ä¸Šé”
        redissonLock.lock();

        try {
            // ä» redis ä¸­è·å–å•†å“çš„å‰©ä½™æ•°é‡
            String result = stringRedisTemplate.opsForValue().get(&quot;goods:001&quot;);
            int goodsNumber = result == null ? 0 : Integer.parseInt(result);
            String retStr = null;

            // å•†å“æ•°é‡å¤§äºé›¶æ‰èƒ½å‡ºå”®
            if (goodsNumber &gt; 0) {
                int realNumber = goodsNumber - 1;
                stringRedisTemplate.opsForValue().set(&quot;goods:001&quot;, realNumber + &quot;&quot;);
                retStr = &quot;ä½ å·²ç»æˆåŠŸç§’æ€å•†å“ï¼Œæ­¤æ—¶è¿˜å‰©ä½™ï¼š&quot; + realNumber + &quot;ä»¶&quot; + &quot;\t æœåŠ¡å™¨ç«¯å£: &quot; + serverPort;
            } else {
                retStr = &quot;å•†å“å·²ç»å”®ç½„/æ´»åŠ¨ç»“æŸ/è°ƒç”¨è¶…æ—¶ï¼Œæ¬¢è¿ä¸‹æ¬¡å…‰ä¸´&quot; + &quot;\t æœåŠ¡å™¨ç«¯å£: &quot; + serverPort;
            }
            System.out.println(retStr);
            return retStr;
        } finally {
            // è§£é”
            redissonLock.unlock();
        }
    }

}
</code></pre><hr><p><strong>ä»£ç æµ‹è¯•</strong></p><p>æ²¡æœ‰å‡ºç°è¶…å–ç°è±¡ï¼ˆä½†æˆ‘ç”¨çš„æ˜¯ä¸ªå‡çš„ nginxï¼Ÿï¼Ÿï¼Ÿï¼‰</p><figure><img src="/assets/img/91d6563435b38862de83762911cd9d4a.6db37b13.png" alt="image-20210204183252071" tabindex="0" loading="lazy"><figcaption>image-20210204183252071</figcaption></figure><blockquote><p><strong>9.1 ç‰ˆæœ¬çš„ä»£ç ï¼šBug çš„å®Œå–„</strong></p></blockquote><p><strong>é—®é¢˜</strong></p><p>é˜³å“¥è¯´åœ¨è¶…é«˜å¹¶å‘çš„æƒ…å†µä¸‹ï¼Œå¯èƒ½ä¼šæŠ›å‡ºå¦‚ä¸‹å¼‚å¸¸ï¼ŒåŸå› æ˜¯è§£é” lock çš„çº¿ç¨‹å¹¶ä¸æ˜¯å½“å‰çº¿ç¨‹ï¼Œå•¥æ„æ€ï¼Ÿï¼Ÿï¼Ÿ</p><figure><img src="/assets/img/5bf8d9d12b20b9e4c27772b43e22a57a.3d48be1a.png" alt="image-20210204182943599" tabindex="0" loading="lazy"><figcaption>image-20210204182943599</figcaption></figure><hr><p><strong>ä»£ç </strong></p><p>åœ¨é‡Šæ”¾é”ä¹‹å‰åŠ ä¸€ä¸ªåˆ¤æ–­ï¼šè¿˜åœ¨æŒæœ‰é”çš„çŠ¶æ€ï¼Œå¹¶ä¸”æ˜¯å½“å‰çº¿ç¨‹æŒæœ‰çš„é”å†è§£é”</p><pre><code>/**
 * @ClassName GoodController
 * @Description TODO
 * @Author Oneby
 * @Date 2021/2/2 18:59
 * @Version 1.0
 */
@RestController
public class GoodController {

    private static final String REDIS_LOCK_KEY = &quot;lockOneby&quot;;

    @Autowired
    private StringRedisTemplate stringRedisTemplate;

    @Value(&quot;${server.port}&quot;)
    private String serverPort;

    @Autowired
    private Redisson redisson;

    @GetMapping(&quot;/buy_goods&quot;)
    public String buy_Goods() throws Exception {
        // å½“å‰è¯·æ±‚çš„ UUID + çº¿ç¨‹å
        String value = UUID.randomUUID().toString() + Thread.currentThread().getName();
        // è·å–é”
        RLock redissonLock = redisson.getLock(REDIS_LOCK_KEY);
        // ä¸Šé”
        redissonLock.lock();

        try {
            // ä» redis ä¸­è·å–å•†å“çš„å‰©ä½™æ•°é‡
            String result = stringRedisTemplate.opsForValue().get(&quot;goods:001&quot;);
            int goodsNumber = result == null ? 0 : Integer.parseInt(result);
            String retStr = null;

            // å•†å“æ•°é‡å¤§äºé›¶æ‰èƒ½å‡ºå”®
            if (goodsNumber &gt; 0) {
                int realNumber = goodsNumber - 1;
                stringRedisTemplate.opsForValue().set(&quot;goods:001&quot;, realNumber + &quot;&quot;);
                retStr = &quot;ä½ å·²ç»æˆåŠŸç§’æ€å•†å“ï¼Œæ­¤æ—¶è¿˜å‰©ä½™ï¼š&quot; + realNumber + &quot;ä»¶&quot; + &quot;\t æœåŠ¡å™¨ç«¯å£: &quot; + serverPort;
            } else {
                retStr = &quot;å•†å“å·²ç»å”®ç½„/æ´»åŠ¨ç»“æŸ/è°ƒç”¨è¶…æ—¶ï¼Œæ¬¢è¿ä¸‹æ¬¡å…‰ä¸´&quot; + &quot;\t æœåŠ¡å™¨ç«¯å£: &quot; + serverPort;
            }
            System.out.println(retStr);
            return retStr;
        } finally {
            // è¿˜åœ¨æŒæœ‰é”çš„çŠ¶æ€ï¼Œå¹¶ä¸”æ˜¯å½“å‰çº¿ç¨‹æŒæœ‰çš„é”å†è§£é”
            if (redissonLock.isLocked() &amp;&amp; redissonLock.isHeldByCurrentThread()){
                redissonLock.unlock();
            }
        }
    }

}
</code></pre><h3 id="_3-4ã€åˆ†å¸ƒå¼é”æ€»ç»“" tabindex="-1"><a class="header-anchor" href="#_3-4ã€åˆ†å¸ƒå¼é”æ€»ç»“"><span>3.4ã€åˆ†å¸ƒå¼é”æ€»ç»“</span></a></h3><blockquote><p><strong>å›é¡¾æµ‹è¯• &amp; æ‰¾èŒ¬çš„æ­¥éª¤</strong></p></blockquote><ol><li>synchronized é”ï¼šå•æœºç‰ˆ OKï¼Œä¸Š nginxåˆ†å¸ƒå¼å¾®æœåŠ¡ï¼Œå•æœºé”å°±ä¸ OK,</li><li>åˆ†å¸ƒå¼é”ï¼šå–æ¶ˆå•æœºé”ï¼Œä¸Š redis åˆ†å¸ƒå¼é” <code>SETNX</code></li><li>å¦‚æœå‡ºå¼‚å¸¸çš„è¯ï¼Œå¯èƒ½æ— æ³•é‡Šæ”¾é”ï¼Œ å¿…é¡»è¦åœ¨ finally ä»£ç å—ä¸­é‡Šæ”¾é”</li><li>å¦‚æœå®•æœºäº†ï¼Œéƒ¨ç½²äº†å¾®æœåŠ¡ä»£ç å±‚é¢æ ¹æœ¬æ²¡æœ‰èµ°åˆ° finally è¿™å—ï¼Œä¹Ÿæ²¡åŠæ³•ä¿è¯è§£é”ï¼Œå› æ­¤éœ€è¦æœ‰è®¾ç½®é”çš„è¿‡æœŸæ—¶é—´</li><li>é™¤äº†å¢åŠ è¿‡æœŸæ—¶é—´ä¹‹å¤–ï¼Œè¿˜å¿…é¡»è¦ <code>SETNX</code> æ“ä½œå’Œè®¾ç½®è¿‡æœŸæ—¶é—´çš„æ“ä½œå¿…é¡»ä¸ºåŸå­æ€§æ“ä½œ</li><li>è§„å®šåªèƒ½è‡ªå·±åˆ é™¤è‡ªå·±çš„é”ï¼Œä½ ä¸èƒ½æŠŠåˆ«äººçš„é”åˆ é™¤äº†ï¼Œé˜²æ­¢å¼ å† ææˆ´ï¼Œå¯ä½¿ç”¨ lua è„šæœ¬æˆ–è€…äº‹åŠ¡</li><li>åˆ¤æ–­é”æ‰€å±ä¸šåŠ¡ä¸åˆ é™¤é”çš„æ“ä½œä¹Ÿéœ€è¦æ˜¯åŸå­æ€§æ“ä½œ</li><li>redis é›†ç¾¤ç¯å¢ƒä¸‹ï¼Œæˆ‘ä»¬è‡ªå·±å†™çš„ä¹Ÿä¸ OKï¼Œç›´æ¥ä¸Š RedLock ä¹‹ Redisson è½åœ°å®ç°</li></ol><h2 id="_4ã€redis-ç¼“å­˜æ·˜æ±°ç­–ç•¥" tabindex="-1"><a class="header-anchor" href="#_4ã€redis-ç¼“å­˜æ·˜æ±°ç­–ç•¥"><span>4ã€Redis ç¼“å­˜æ·˜æ±°ç­–ç•¥</span></a></h2><h3 id="_4-1ã€ç¼“å­˜æ·˜æ±°ç­–ç•¥çš„é¢è¯•é¢˜" tabindex="-1"><a class="header-anchor" href="#_4-1ã€ç¼“å­˜æ·˜æ±°ç­–ç•¥çš„é¢è¯•é¢˜"><span>4.1ã€ç¼“å­˜æ·˜æ±°ç­–ç•¥çš„é¢è¯•é¢˜</span></a></h3><blockquote><p><strong>Redis ç¼“å­˜æ·˜æ±°ç­–ç•¥ç›¸å…³çš„é¢è¯•é¢˜</strong></p></blockquote><ol><li>ç”Ÿäº§ä¸Šä½ ä»¬çš„rediså†…å­˜è®¾ç½®å¤šå°‘ï¼Ÿ</li><li>å¦‚ä½•é…ç½®ã€ä¿®æ”¹redisçš„å†…å­˜å¤§å°ï¼Ÿ</li><li>å¦‚æœå†…å­˜æ»¡äº†ä½ æ€ä¹ˆåŠï¼Ÿ</li><li>redis æ¸…ç†å†…å­˜çš„æ–¹å¼ï¼Ÿå®šæœŸåˆ é™¤å’Œæƒ°æ€§åˆ é™¤äº†è§£è¿‡å—</li><li>redis çš„ç¼“å­˜æ·˜æ±°ç­–ç•¥</li><li>redis çš„ LRU æ·˜æ±°æœºåˆ¶äº†è§£è¿‡å—ï¼Ÿå¯å¦æ‰‹å†™ä¸€ä¸ª LRU ç®—æ³•</li></ol><h3 id="_4-2ã€redis-å†…å­˜æ»¡äº†æ€ä¹ˆåŠ" tabindex="-1"><a class="header-anchor" href="#_4-2ã€redis-å†…å­˜æ»¡äº†æ€ä¹ˆåŠ"><span>4.2ã€redis å†…å­˜æ»¡äº†æ€ä¹ˆåŠ</span></a></h3><blockquote><p><strong>redis é»˜è®¤å†…å­˜å¤šå°‘ï¼Ÿåœ¨å“ªé‡ŒæŸ¥çœ‹? å¦‚ä½•è®¾ç½®ä¿®æ”¹?</strong></p></blockquote><p><strong>1ã€å¦‚ä½•æŸ¥çœ‹ redis æœ€å¤§å ç”¨å†…å­˜</strong></p><p>åœ¨ redis.conf é…ç½®æ–‡ä»¶ä¸­æœ‰ä¸€ä¸ªï¼Œè¾“å…¥ <code>:set nu</code> æ˜¾ç¤ºè¡Œå·ï¼Œå¤§çº¦åœ¨ 800 å¤šè¡Œæœ‰ä¸€ä¸ª <code>maxmemory</code> å­—æ®µï¼Œç”¨é¢„è®¾å€¼ redis çš„æœ€å¤§å ç”¨å†…å­˜</p><figure><img src="/assets/img/d8b324a3c021ae11e71dcc5da1ab8c0b.a5d77fdf.png" alt="image-20210207172808438" tabindex="0" loading="lazy"><figcaption>image-20210207172808438</figcaption></figure><hr><p><strong>2ã€redis ä¼šå ç”¨ç‰©ç†æœºå™¨å¤šå°‘å†…å­˜ï¼Ÿ</strong></p><p>å¦‚æœä¸è®¾ç½®æœ€å¤§å†…å­˜å¤§å°æˆ–è€…è®¾ç½®æœ€å¤§å†…å­˜å¤§å°ä¸º 0ï¼Œåœ¨ 64 ä½æ“ä½œç³»ç»Ÿä¸‹ä¸é™åˆ¶å†…å­˜å¤§å°ï¼Œåœ¨32ä½æ“ä½œç³»ç»Ÿä¸‹æœ€å¤šä½¿ç”¨ 3GB å†…å­˜</p><hr><p><strong>3ã€ä¸€èˆ¬ç”Ÿäº§ä¸Šå¦‚ä½•é…ç½® redis çš„å†…å­˜</strong></p><p>ä¸€èˆ¬æ¨èRedisè®¾ç½®å†…å­˜ä¸ºæœ€å¤§ç‰©ç†å†…å­˜çš„å››åˆ†ä¹‹ä¸‰ï¼Œä¹Ÿå°±æ˜¯ 0.75</p><hr><p><strong>4ã€å¦‚ä½•ä¿®æ”¹ redis å†…å­˜è®¾ç½®</strong></p><ol><li><p>é€šè¿‡ä¿®æ”¹æ–‡ä»¶é…ç½®ï¼ˆæ°¸ä¹…ç”Ÿæ•ˆï¼‰ï¼šä¿®æ”¹ maxmemory å­—æ®µï¼Œå•ä½ä¸ºå­—èŠ‚</p><figure><img src="/assets/img/060a18caee395fae8796a48e5214202d.253ac4b1.png" alt="image-20210207173214138" tabindex="0" loading="lazy"><figcaption>image-20210207173214138</figcaption></figure></li><li><p>é€šè¿‡å‘½ä»¤ä¿®æ”¹ï¼ˆé‡å¯å¤±æ•ˆï¼‰ï¼š<code>config set maxmemory 104857600</code> è®¾ç½® redis æœ€å¤§å ç”¨å†…å­˜ä¸º 100MBï¼Œ<code>config get maxmemory</code> è·å– redis æœ€å¤§å ç”¨å†…å­˜</p><figure><img src="/assets/img/5e551161caeb7f6eb7892e23d45c2a79.3348cae6.png" alt="image-20210207173506155" tabindex="0" loading="lazy"><figcaption>image-20210207173506155</figcaption></figure></li></ol><hr><p><strong>5ã€é€šè¿‡å‘½ä»¤æŸ¥çœ‹ redis å†…å­˜ä½¿ç”¨æƒ…å†µ?</strong></p><p>é€šè¿‡ info æŒ‡ä»¤å¯ä»¥æŸ¥çœ‹ redis å†…å­˜ä½¿ç”¨æƒ…å†µï¼š<code>used_memory_human</code> è¡¨ç¤ºå®é™…å·²ç»å ç”¨çš„å†…å­˜ï¼Œ<code>maxmemory</code> è¡¨ç¤º redis æœ€å¤§å ç”¨å†…å­˜</p><figure><img src="/assets/img/54e71cba443b2b5d8f49dad6450bee42.abd27cf4.png" alt="image-20210207173935763" tabindex="0" loading="lazy"><figcaption>image-20210207173935763</figcaption></figure><blockquote><p><strong>å¦‚æœæŠŠ redis å†…å­˜æ‰“æ»¡äº†ä¼šå‘ç”Ÿä»€ä¹ˆ? å¦‚æœ redis å†…å­˜ä½¿ç”¨è¶…å‡ºäº†è®¾ç½®çš„æœ€å¤§å€¼ä¼šæ€æ ·?</strong></p></blockquote><p>ä¿®æ”¹é…ç½®ï¼Œæ•…æ„æŠŠæœ€å¤§å†…å­˜è®¾ç½®ä¸º 1byteï¼Œå†é€šè¿‡ <code>set k1 v1</code> å‘½ä»¤ä¸‹ redis ä¸­å†™å…¥æ•°æ®ï¼Œredis å°†ä¼šæŠ¥é”™ï¼š(error) OOM command not allowed when used memory &gt; â€˜maxmemoryâ€™</p><figure><img src="/assets/img/6189714705ebc59c70c9c360ef983328.f35f22e7.png" alt="image-20210207174153452" tabindex="0" loading="lazy"><figcaption>image-20210207174153452</figcaption></figure><blockquote><p><strong>æ€»ç»“ &amp; ç»“è®º</strong></p></blockquote><p>å¦‚æœè®¾ç½®äº† <code>maxmemory</code> çš„é€‰é¡¹ï¼Œå‡å¦‚ redis å†…å­˜ä½¿ç”¨è¾¾åˆ°ä¸Šé™ï¼Œå¹¶ä¸” key éƒ½æ²¡æœ‰åŠ ä¸Šè¿‡æœŸæ—¶é—´ï¼Œå°±ä¼šå¯¼è‡´æ•°æ®å†™çˆ† redis å†…å­˜ã€‚</p><p>ä¸ºäº†é¿å…ç±»ä¼¼æƒ…å†µï¼Œäºæ˜¯å¼•å‡ºä¸‹ä¸€éƒ¨åˆ†çš„å†…å­˜æ·˜æ±°ç­–ç•¥</p><h3 id="_4-3ã€redis-ç¼“å­˜æ·˜æ±°ç­–ç•¥" tabindex="-1"><a class="header-anchor" href="#_4-3ã€redis-ç¼“å­˜æ·˜æ±°ç­–ç•¥"><span>4.3ã€redis ç¼“å­˜æ·˜æ±°ç­–ç•¥</span></a></h3><blockquote><p><strong>redis å¦‚ä½•åˆ é™¤è®¾ç½®äº†è¿‡æœŸæ—¶é—´çš„ key</strong></p></blockquote><p><strong>1ã€redisè¿‡æœŸé”®çš„åˆ é™¤ç­–ç•¥</strong></p><p>å¦‚æœä¸€ä¸ªé”®æ˜¯è¿‡æœŸçš„ï¼Œé‚£å®ƒåˆ°äº†è¿‡æœŸæ—¶é—´ä¹‹åæ˜¯ä¸æ˜¯é©¬ä¸Šå°±ä»å†…å­˜ä¸­è¢«è¢«åˆ é™¤å‘¢ï¼Ÿå¦‚æœå›ç­”æ˜¯ï¼Œé‚£ä¹ˆé¢è¯•å®˜å°±ä¼šé—®ä½ ï¼šè‡ªå·±èµ°è¿˜æ˜¯æˆ‘é€ä½ ï¼Ÿé‚£ä¹ˆè¿‡æœŸååˆ°åº•ä»€ä¹ˆæ—¶å€™è¢«åˆ é™¤å‘¢ï¼Ÿedis å¦‚ä½•æ“ä½œçš„å‘¢ï¼Ÿ</p><p>é€šè¿‡æŸ¥çœ‹ redis é…ç½®æ–‡ä»¶å¯çŸ¥ï¼Œé»˜è®¤æ·˜æ±°ç­–ç•¥æ˜¯ã€noevictionï¼ˆDonâ€™t evict anything, just return an error on write operations.ï¼‰ã€‘ï¼Œå¦‚æœ redis å†…å­˜è¢«å†™çˆ†äº†ï¼Œç›´æ¥è¿”å› error</p><figure><img src="/assets/img/f8c3f3b937fd77a48cb570188367f8d0.ae722909.png" alt="image-20210207174720294" tabindex="0" loading="lazy"><figcaption>image-20210207174720294</figcaption></figure><blockquote><p><strong>redis å¯¹äºè¿‡æœŸ key çš„ä¸‰ç§ä¸åŒåˆ é™¤ç­–ç•¥</strong></p></blockquote><p><strong>1ã€å®šæ—¶åˆ é™¤</strong></p><p>ç«‹å³åˆ é™¤èƒ½ä¿è¯å†…å­˜ä¸­æ•°æ®çš„æœ€å¤§æ–°é²œåº¦ï¼Œå› ä¸ºå®ƒä¿è¯è¿‡æœŸé”®å€¼ä¼šåœ¨è¿‡æœŸåé©¬ä¸Šè¢«åˆ é™¤ï¼Œå…¶æ‰€å ç”¨çš„å†…å­˜ä¹Ÿä¼šéšä¹‹é‡Šæ”¾ã€‚ä½†æ˜¯ç«‹å³åˆ é™¤å¯¹ CPU æ˜¯æœ€ä¸å‹å¥½çš„ã€‚å› ä¸ºåˆ é™¤æ“ä½œä¼šå ç”¨ CPU çš„æ—¶é—´ï¼Œå¦‚æœåˆšå¥½ç¢°ä¸Šäº† CPU å¾ˆå¿™çš„æ—¶å€™ï¼Œæ¯”å¦‚æ­£åœ¨åšäº¤é›†æˆ–æ’åºç­‰è®¡ç®—çš„æ—¶å€™ï¼Œå°±ä¼šç»™ CPU é€ æˆé¢å¤–çš„å‹åŠ›ï¼Œè®© CPU å¿ƒç´¯ï¼Œæ—¶æ—¶éœ€è¦åˆ é™¤ï¼Œå¿™æ­»ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚</p><p>è¿™ä¼šäº§ç”Ÿå¤§é‡çš„æ€§èƒ½æ¶ˆè€—ï¼ŒåŒæ—¶ä¹Ÿä¼šå½±å“æ•°æ®çš„è¯»å–æ“ä½œã€‚</p><p><strong>æ€»ç»“</strong>ï¼šå®šæ—¶åˆ é™¤å¯¹ CPU ä¸å‹å¥½ï¼Œä½†å¯¹ memory å‹å¥½ï¼Œç”¨å¤„ç†å™¨æ€§èƒ½æ¢å–å­˜å‚¨ç©ºé—´ï¼ˆæ‹¿æ—¶é—´æ¢ç©ºé—´ï¼‰</p><hr><p><strong>2ã€æƒ°æ€§åˆ é™¤</strong></p><p>æƒ°æ€§åˆ é™¤çš„ç­–ç•¥åˆšå¥½å’Œå®šæ—¶åˆ é™¤ç›¸åï¼Œæƒ°æ€§åˆ é™¤åœ¨æ•°æ®åˆ°è¾¾è¿‡æœŸæ—¶é—´åä¸åšå¤„ç†ï¼Œç­‰ä¸‹æ¬¡è®¿é—®è¯¥æ•°æ®æ—¶å‘ç°å·²è¿‡æœŸï¼Œå¹¶å°†å…¶åˆ é™¤ï¼Œå¹¶è¿”å›ä¸å­˜åœ¨ã€‚</p><p>ä½¿ç”¨æƒ°æ€§åˆ é™¤è®¿é—®æ•°æ®çš„ç‰¹ç‚¹ï¼šè®¿é—®ä¸€ä¸ªæ•°æ®ï¼Œå¦‚æœå‘ç°å…¶åœ¨è¿‡æœŸæ—¶é—´ä¹‹å†…ï¼Œåˆ™è¿”å›æ”¹æ•°æ®ï¼›å¦‚æœå‘ç°å·²ç»è¿‡äº†è¿‡æœŸæ—¶é—´ï¼Œåˆ™å°†å…¶åˆ é™¤ï¼Œå¹¶è¿”å›ä¸å­˜åœ¨</p><p>å¦‚æœä¸€ä¸ªé”®å·²ç»è¿‡æœŸï¼Œè€Œè¿™ä¸ªé”®åˆä»ç„¶ä¿ç•™åœ¨æ•°æ®åº“ä¸­ï¼Œé‚£ä¹ˆåªè¦è¿™ä¸ªè¿‡æœŸé”®ä¸è¢«åˆ é™¤ï¼Œå®ƒæ‰€å ç”¨çš„å†…å­˜å°±ä¸ä¼šé‡Šæ”¾ã€‚å› æ­¤æƒ°æ€§åˆ é™¤ç­–ç•¥çš„ç¼ºç‚¹æ˜¯ï¼šå®ƒå¯¹å†…å­˜æ˜¯æœ€ä¸å‹å¥½çš„ã€‚</p><p>åœ¨ä½¿ç”¨æƒ°æ€§åˆ é™¤ç­–ç•¥æ—¶ï¼Œå¦‚æœæ•°æ®åº“ä¸­æœ‰éå¸¸å¤šçš„è¿‡æœŸé”®ï¼Œè€Œè¿™äº›è¿‡æœŸé”®åˆæ°å¥½æ²¡æœ‰è¢«è®¿é—®åˆ°çš„è¯ï¼Œé‚£ä¹ˆå®ƒä»¬ä¹Ÿè®¸æ°¸è¿œä¹Ÿä¸ä¼šè¢«åˆ é™¤ï¼ˆé™¤éç”¨æˆ·æ‰‹åŠ¨æ‰§è¡Œ <code>FLUSHDB</code>ï¼‰ï¼Œæˆ‘ä»¬ç”šè‡³å¯ä»¥å°†è¿™ç§æƒ…å†µçœ‹ä½œæ˜¯ä¸€ç§å†…å­˜æ³„æ¼â€”â€”æ— ç”¨çš„åƒåœ¾æ•°æ®å ç”¨äº†å¤§é‡çš„å†…å­˜ï¼Œè€ŒæœåŠ¡å™¨å´ä¸ä¼šè‡ªå·±å»é‡Šæ”¾å®ƒä»¬ï¼Œè¿™å¯¹äºè¿è¡ŒçŠ¶æ€éå¸¸ä¾èµ–äºå†…å­˜çš„ redis æœåŠ¡å™¨æ¥è¯´ï¼Œè‚¯å®šä¸æ˜¯ä¸€ä¸ªå¥½æ¶ˆæ¯</p><p><strong>æ€»ç»“</strong>ï¼šæƒ°æ€§åˆ é™¤å¯¹ memory ä¸å‹å¥½ï¼Œä½†å¯¹ CPU å‹å¥½ï¼Œç”¨å­˜å‚¨ç©ºé—´æ¢å–å¤„ç†å™¨æ€§èƒ½ï¼ˆæ‹¿ç©ºé—´æ¢æ—¶é—´ï¼‰</p><hr><p><strong>3ã€å®šæœŸåˆ é™¤</strong></p><p><strong>æŠ˜ä¸­æ–¹æ¡ˆï¼šå®šæœŸåˆ é™¤</strong></p><p>ä¸Šé¢ä¸¤ç§åˆ é™¤ç­–ç•¥éƒ½èµ°æç«¯ï¼Œå› æ­¤å¼•å‡ºæˆ‘ä»¬çš„å®šæœŸåˆ é™¤ç­–ç•¥ã€‚</p><p>å®šæœŸåˆ é™¤ç­–ç•¥æ˜¯å‰ä¸¤ç§ç­–ç•¥çš„æŠ˜ä¸­ï¼šå®šæœŸåˆ é™¤ç­–ç•¥æ¯éš”ä¸€æ®µæ—¶é—´æ‰§è¡Œä¸€æ¬¡åˆ é™¤è¿‡æœŸé”®æ“ä½œï¼Œå¹¶é€šè¿‡é™åˆ¶åˆ é™¤æ“ä½œæ‰§è¡Œçš„æ—¶é•¿å’Œé¢‘ç‡æ¥å‡å°‘åˆ é™¤æ“ä½œå¯¹ CPU æ—¶é—´çš„å½±å“ã€‚å…¶åšæ³•ä¸ºï¼šå‘¨æœŸæ€§è½®è¯¢ redis åº“ä¸­çš„æ—¶æ•ˆæ€§æ•°æ®ï¼Œé‡‡ç”¨éšæœºæŠ½å–çš„ç­–ç•¥ï¼Œåˆ©ç”¨è¿‡æœŸæ•°æ®å æ¯”çš„æ–¹å¼æ§åˆ¶åˆ é™¤é¢‘åº¦ã€‚</p><p><strong>å®šæœŸåˆ é™¤çš„ç‰¹ç‚¹</strong></p><p>ç‰¹ç‚¹1ï¼šCPU æ€§èƒ½å ç”¨è®¾ç½®æœ‰å³°å€¼ï¼Œæ£€æµ‹é¢‘åº¦å¯è‡ªå®šä¹‰è®¾ç½®</p><p>ç‰¹ç‚¹2ï¼šå†…å­˜å‹åŠ›ä¸æ˜¯å¾ˆå¤§ï¼Œé•¿æœŸå ç”¨å†…å­˜çš„å†·æ•°æ®ä¼šè¢«æŒç»­æ¸…ç†</p><p>æ€»ç»“ï¼šå‘¨æœŸæ€§æŠ½æŸ¥å­˜å‚¨ç©ºé—´ï¼ˆéšæœºæŠ½æŸ¥ï¼Œé‡ç‚¹æŠ½æŸ¥)</p><p><strong>å®šæœŸåˆ é™¤çš„ä¸¾ä¾‹</strong></p><p>redis é»˜è®¤æ¯é—´éš” 100ms æ£€æŸ¥æ˜¯å¦æœ‰è¿‡æœŸçš„ keyï¼Œå¦‚æœæœ‰è¿‡æœŸ key åˆ™åˆ é™¤ã€‚æ³¨æ„ï¼šredis ä¸æ˜¯æ¯éš”100ms å°†æ‰€æœ‰çš„ key æ£€æŸ¥ä¸€æ¬¡è€Œæ˜¯éšæœºæŠ½å–è¿›è¡Œæ£€æŸ¥ï¼ˆå¦‚æœæ¯éš” 100msï¼Œå…¨éƒ¨ key è¿›è¡Œæ£€æŸ¥ï¼Œredis ç›´æ¥è¿›å»ICUï¼‰ã€‚å› æ­¤ï¼Œå¦‚æœåªé‡‡ç”¨å®šæœŸåˆ é™¤ç­–ç•¥ï¼Œä¼šå¯¼è‡´å¾ˆå¤š key åˆ°æ—¶é—´æ²¡æœ‰åˆ é™¤ã€‚</p><p><strong>å®šæœŸåˆ é™¤çš„éš¾ç‚¹</strong></p><p>å®šæœŸåˆ é™¤ç­–ç•¥çš„éš¾ç‚¹æ˜¯ç¡®å®šåˆ é™¤æ“ä½œæ‰§è¡Œçš„æ—¶é•¿å’Œé¢‘ç‡ï¼šredis ä¸å¯èƒ½æ—¶æ—¶åˆ»åˆ»éå†æ‰€æœ‰è¢«è®¾ç½®äº†ç”Ÿå­˜æ—¶é—´çš„ keyï¼Œæ¥æ£€æµ‹æ•°æ®æ˜¯å¦å·²ç»åˆ°è¾¾è¿‡æœŸæ—¶é—´ï¼Œç„¶åå¯¹å®ƒè¿›è¡Œåˆ é™¤ã€‚</p><p>å¦‚æœåˆ é™¤æ“ä½œæ‰§è¡Œå¾—å¤ªé¢‘ç¹ï¼Œæˆ–è€…æ‰§è¡Œçš„æ—¶é—´å¤ªé•¿ï¼Œå®šæœŸåˆ é™¤ç­–ç•¥å°±ä¼šé€€åŒ–æˆå®šæ—¶åˆ é™¤ç­–ç•¥ï¼Œä»¥è‡³äºå°† CPU æ—¶é—´è¿‡å¤šåœ°æ¶ˆè€—åœ¨åˆ é™¤è¿‡æœŸé”®ä¸Šé¢ã€‚</p><p>å¦‚æœåˆ é™¤æ“ä½œæ‰§è¡Œå¾—å¤ªå°‘ï¼Œæˆ–è€…æ‰§è¡Œçš„æ—¶é—´å¤ªçŸ­ï¼Œå®šæœŸåˆ é™¤ç­–ç•¥åˆä¼šå’Œæƒ°æ€§åˆ é™¤æŸç•¥ä¸€æ ·ï¼Œå‡ºç°æµªè´¹å†…å­˜çš„æƒ…å†µã€‚</p><p>å› æ­¤ï¼Œå¦‚æœé‡‡ç”¨å®šæœŸåˆ é™¤ç­–ç•¥çš„è¯ï¼ŒæœåŠ¡å™¨å¿…é¡»æ ¹æ®æƒ…å†µï¼Œåˆç†åœ°è®¾ç½®åˆ é™¤æ“ä½œçš„æ‰§è¡Œæ—¶é•¿å’Œæ‰§è¡Œé¢‘ç‡ã€‚</p><hr><p><strong>æ€»ç»“</strong></p><p>æƒ°æ€§åˆ é™¤å’Œå®šæœŸåˆ é™¤éƒ½å­˜åœ¨æ•°æ®æ²¡æœ‰è¢«æŠ½åˆ°çš„æƒ…å†µï¼Œå¦‚æœè¿™äº›æ•°æ®å·²ç»åˆ°äº†è¿‡æœŸæ—¶é—´ï¼Œæ²¡æœ‰ä»»ä½•ä½œç”¨ï¼Œè¿™ä¼šå¯¼è‡´å¤§é‡è¿‡æœŸçš„ key å †ç§¯åœ¨å†…å­˜ä¸­ï¼Œå¯¼è‡´ redis å†…å­˜ç©ºé—´ç´§å¼ æˆ–è€…å¾ˆå¿«è€—å°½</p><p>å› æ­¤å¿…é¡»è¦æœ‰ä¸€ä¸ªæ›´å¥½çš„å…œåº•æ–¹æ¡ˆï¼Œæ¥ä¸‹æ¥å¼•å‡º redis å†…å­˜æ·˜æ±°ç­–ç•¥</p><blockquote><p><strong>redis 6.0.8 ç‰ˆæœ¬çš„å†…å­˜æ·˜æ±°ç­–ç•¥æœ‰å“ªäº›ï¼Ÿ</strong></p></blockquote><p><strong>8 ç§å†…å­˜æ·˜æ±°ç­–ç•¥</strong></p><ol><li>noevictionï¼šä¸ä¼šé©±é€ä»»ä½•key</li><li>allkeys-lruï¼šå¯¹æ‰€æœ‰keyä½¿ç”¨LRUç®—æ³•è¿›è¡Œåˆ é™¤</li><li>volatile-lruï¼šå¯¹æ‰€æœ‰è®¾ç½®äº†è¿‡æœŸæ—¶é—´çš„keyä½¿ç”¨LRUç®—æ³•è¿›è¡Œåˆ é™¤</li><li>allkeys-randomï¼šå¯¹æ‰€æœ‰keyéšæœºåˆ é™¤</li><li>volatile-randomï¼šå¯¹æ‰€æœ‰è®¾ç½®äº†è¿‡æœŸæ—¶é—´çš„keyéšæœºåˆ é™¤</li><li>volatile-ttlï¼šåˆ é™¤é©¬ä¸Šè¦è¿‡æœŸçš„key</li><li>allkeys-lfuï¼šå¯¹æ‰€æœ‰keyä½¿ç”¨LFUç®—æ³•è¿›è¡Œåˆ é™¤</li><li>volatile-lfuï¼šå¯¹æ‰€æœ‰è®¾ç½®äº†è¿‡æœŸæ—¶é—´çš„keyä½¿ç”¨LFUç®—æ³•è¿›è¡Œåˆ é™¤</li></ol><hr><p><strong>æ€»ç»“</strong></p><ol><li>2ä¸ªç»´åº¦ <ol><li>è¿‡æœŸé”®ä¸­ç­›é€‰</li><li>æ‰€æœ‰é”®ä¸­ç­›é€‰</li></ol></li><li>4ä¸ªæ–¹é¢ <ol><li>lru</li><li>lfu</li><li>random</li><li>ttl</li></ol></li></ol><blockquote><p><strong>å¦‚ä½•é…ç½® redis çš„å†…å­˜æ·˜æ±°ç­–ç•¥</strong></p></blockquote><ol><li><p>é€šè¿‡ä¿®æ”¹æ–‡ä»¶é…ç½®ï¼ˆæ°¸ä¹…ç”Ÿæ•ˆï¼‰ï¼šé…ç½® <code>maxmemory-policy</code> å­—æ®µ</p><figure><img src="/assets/img/a0f037718cb8d2cbaee49f686dcf0e74.c3b86a6e.png" alt="image-20210207181430526" tabindex="0" loading="lazy"><figcaption>image-20210207181430526</figcaption></figure></li><li><p>é€šè¿‡å‘½ä»¤ä¿®æ”¹ï¼ˆé‡å¯å¤±æ•ˆï¼‰ï¼š<code>config set maxmemory-policy allkeys-lru</code> å‘½ä»¤è®¾ç½®å†…å­˜æ·˜æ±°ç­–ç•¥ï¼Œ<code>config get maxmemory-policy</code> å‘½ä»¤è·å–å½“å‰é‡‡ç”¨çš„å†…å­˜æ·˜æ±°ç­–ç•¥</p><figure><img src="/assets/img/12c5526453ae59e64efda4a309510040.e65caa8c.png" alt="image-20210207182204402" tabindex="0" loading="lazy"><figcaption>image-20210207182204402</figcaption></figure></li></ol><h2 id="_5ã€redis-lru-ç®—æ³•" tabindex="-1"><a class="header-anchor" href="#_5ã€redis-lru-ç®—æ³•"><span>5ã€redis LRU ç®—æ³•</span></a></h2><h3 id="_5-1ã€lru-ç®—æ³•ç®€ä»‹" tabindex="-1"><a class="header-anchor" href="#_5-1ã€lru-ç®—æ³•ç®€ä»‹"><span>5.1ã€LRU ç®—æ³•ç®€ä»‹</span></a></h3><blockquote><p><strong>LRU ç®—æ³•çš„ç®€ä»‹</strong></p></blockquote><p>LRU æ˜¯ Least Recently Used çš„ç¼©å†™ï¼Œå³æœ€è¿‘æœ€å°‘ä½¿ç”¨ï¼Œæ˜¯ä¸€ç§å¸¸ç”¨çš„é¡µé¢ç½®æ¢ç®—æ³•ï¼Œæ¯æ¬¡é€‰æ‹©æœ€è¿‘æœ€ä¹…æœªä½¿ç”¨çš„é¡µé¢äºˆä»¥æ·˜æ±°</p><h3 id="_5-2ã€lru-ç®—æ³•é¢˜æ¥æº" tabindex="-1"><a class="header-anchor" href="#_5-2ã€lru-ç®—æ³•é¢˜æ¥æº"><span>5.2ã€LRU ç®—æ³•é¢˜æ¥æº</span></a></h3><blockquote><p><a href="https://leetcode-cn.com/problems/lru-cache/" target="_blank" rel="noopener noreferrer">146. LRU ç¼“å­˜æœºåˆ¶</a></p></blockquote><p>è¿ç”¨ä½ æ‰€æŒæ¡çš„æ•°æ®ç»“æ„ï¼Œè®¾è®¡å’Œå®ç°ä¸€ä¸ª <a href="https://baike.baidu.com/item/LRU" target="_blank" rel="noopener noreferrer">LRU (æœ€è¿‘æœ€å°‘ä½¿ç”¨) ç¼“å­˜æœºåˆ¶</a> ã€‚</p><p>å®ç° <code>LRUCache</code> ç±»ï¼š</p><ol><li><code>LRUCache(int capacity)</code> ä»¥æ­£æ•´æ•°ä½œä¸ºå®¹é‡ <code>capacity</code> åˆå§‹åŒ– LRU ç¼“å­˜</li><li><code>int get(int key)</code> å¦‚æœå…³é”®å­— <code>key</code> å­˜åœ¨äºç¼“å­˜ä¸­ï¼Œåˆ™è¿”å›å…³é”®å­—çš„å€¼ï¼Œå¦åˆ™è¿”å› <code>-1</code> ã€‚</li><li><code>void put(int key, int value)</code> å¦‚æœå…³é”®å­—å·²ç»å­˜åœ¨ï¼Œåˆ™å˜æ›´å…¶æ•°æ®å€¼ï¼›å¦‚æœå…³é”®å­—ä¸å­˜åœ¨ï¼Œåˆ™æ’å…¥è¯¥ç»„ã€Œå…³é”®å­—-å€¼ã€ã€‚å½“ç¼“å­˜å®¹é‡è¾¾åˆ°ä¸Šé™æ—¶ï¼Œå®ƒåº”è¯¥åœ¨å†™å…¥æ–°æ•°æ®ä¹‹å‰åˆ é™¤æœ€ä¹…æœªä½¿ç”¨çš„æ•°æ®å€¼ï¼Œä»è€Œä¸ºæ–°çš„æ•°æ®å€¼ç•™å‡ºç©ºé—´ã€‚</li></ol><hr><p><strong>è¿›é˜¶</strong>ï¼šä½ æ˜¯å¦å¯ä»¥åœ¨ <code>O(1)</code> æ—¶é—´å¤æ‚åº¦å†…å®Œæˆè¿™ä¸¤ç§æ“ä½œï¼Ÿ</p><hr><p><strong>ç¤ºä¾‹ï¼š</strong></p><pre><code>è¾“å…¥
[&quot;LRUCache&quot;, &quot;put&quot;, &quot;put&quot;, &quot;get&quot;, &quot;put&quot;, &quot;get&quot;, &quot;put&quot;, &quot;get&quot;, &quot;get&quot;, &quot;get&quot;]
[[2], [1, 1], [2, 2], [1], [3, 3], [2], [4, 4], [1], [3], [4]]
è¾“å‡º
[null, null, null, 1, null, -1, null, -1, 3, 4]

è§£é‡Š
LRUCache lRUCache = new LRUCache(2);
lRUCache.put(1, 1); // ç¼“å­˜æ˜¯ {1=1}
lRUCache.put(2, 2); // ç¼“å­˜æ˜¯ {1=1, 2=2}
lRUCache.get(1);    // è¿”å› 1
lRUCache.put(3, 3); // è¯¥æ“ä½œä¼šä½¿å¾—å…³é”®å­— 2 ä½œåºŸï¼Œç¼“å­˜æ˜¯ {1=1, 3=3}
lRUCache.get(2);    // è¿”å› -1 (æœªæ‰¾åˆ°)
lRUCache.put(4, 4); // è¯¥æ“ä½œä¼šä½¿å¾—å…³é”®å­— 1 ä½œåºŸï¼Œç¼“å­˜æ˜¯ {4=4, 3=3}
lRUCache.get(1);    // è¿”å› -1 (æœªæ‰¾åˆ°)
lRUCache.get(3);    // è¿”å› 3
lRUCache.get(4);    // è¿”å› 4
</code></pre><h3 id="_5-3ã€lru-ç®—æ³•è®¾è®¡æ€æƒ³" tabindex="-1"><a class="header-anchor" href="#_5-3ã€lru-ç®—æ³•è®¾è®¡æ€æƒ³"><span>5.3ã€LRU ç®—æ³•è®¾è®¡æ€æƒ³</span></a></h3><p>æŸ¥æ‰¾å’Œæ’å…¥çš„æ—¶é—´å¤æ‚åº¦ä¸º <code>O(1)</code>ï¼ŒHashMap æ²¡å¾—è·‘äº†ï¼Œä½†æ˜¯ HashMap æ˜¯æ— åºçš„é›†åˆï¼Œæ€ä¹ˆæ ·å°†å…¶æ”¹é€ ä¸ºæœ‰åºé›†åˆå‘¢ï¼Ÿç­”æ¡ˆå°±æ˜¯åœ¨å„ä¸ª Node èŠ‚ç‚¹ä¹‹é—´å¢åŠ  <code>prev</code> æŒ‡é’ˆå’Œ <code>next</code> æŒ‡é’ˆï¼Œæ„æˆåŒå‘é“¾è¡¨</p><figure><img src="/assets/img/abc068f7d766a68862079499bfea6613.1c77993d.png" alt="image-20210207184327176" tabindex="0" loading="lazy"><figcaption>image-20210207184327176</figcaption></figure><p>LRU çš„ç®—æ³•æ ¸å¿ƒæ˜¯å“ˆå¸Œé“¾è¡¨ï¼Œæœ¬è´¨å°±æ˜¯ HashMap+DoubleLinkedList æ—¶é—´å¤æ‚åº¦æ˜¯O(1)ï¼Œå“ˆå¸Œè¡¨+åŒå‘é“¾è¡¨çš„ç»“åˆä½“ï¼Œä¸‹é¢è¿™å¹…åŠ¨å›¾å®Œç¾è¯ é‡Šäº† HashMap+DoubleLinkedList çš„å·¥ä½œåŸç†</p><figure><img src="/assets/img/174430816d515a4f9070b7a7158dffa6.3569a8ec.gif" alt="image-20210206182454498" tabindex="0" loading="lazy"><figcaption>image-20210206182454498</figcaption></figure><h3 id="_5-4ã€lru-ç®—æ³•ç¼–ç å®ç°" tabindex="-1"><a class="header-anchor" href="#_5-4ã€lru-ç®—æ³•ç¼–ç å®ç°"><span>5.4ã€LRU ç®—æ³•ç¼–ç å®ç°</span></a></h3><blockquote><p><strong>1ã€å€ŸåŠ© JDK è‡ªå¸¦çš„ <code>LinkedHashMap</code></strong></p></blockquote><p><code>LinkedHashMap</code> çš„æ³¨é‡Šä¸­å†™æ˜äº†ï¼š <code>LinkedHashMap</code> éå¸¸é€‚åˆç”¨æ¥æ„å»º LRU ç¼“å­˜</p><figure><img src="/assets/img/61d11a2206812ac5cfb0ab75e0cbe6e4.b8de5195.png" alt="image-20210207185047179" tabindex="0" loading="lazy"><figcaption>image-20210207185047179</figcaption></figure><hr><p><strong>LRU ä»£ç </strong></p><p>é€šè¿‡ç»§æ‰¿ <code>LinkedHashMap</code>ï¼Œé‡å†™ <code>boolean removeEldestEntry(Map.Entry&lt;K, V&gt; eldest)</code> æ–¹æ³•å°±å®Œäº‹äº†ã€‚ã€‚ã€‚</p><pre><code>/**
 * @ClassName LRUCacheDemo
 * @Description TODO
 * @Author Oneby
 * @Date 2021/2/7 16:26
 * @Version 1.0
 */
public class LRUCacheDemo&lt;K, V&gt; extends LinkedHashMap&lt;K, V&gt; {

    // ç¼“å­˜å®¹é‡
    private int capacity;

    public LRUCacheDemo(int capacity) {
        // accessOrderï¼šthe ordering mode. true for access-orderï¼›false for insertion-order
        super(capacity, 0.75F, true);
        this.capacity = capacity;
    }

    // ç”¨äºåˆ¤æ–­æ˜¯å¦éœ€è¦åˆ é™¤æœ€è¿‘æœ€ä¹…æœªä½¿ç”¨çš„èŠ‚ç‚¹
    @Override
    protected boolean removeEldestEntry(Map.Entry&lt;K, V&gt; eldest) {
        return super.size() &gt; capacity;
    }

    public static void main(String[] args) {
        LRUCacheDemo lruCacheDemo = new LRUCacheDemo(3);

        lruCacheDemo.put(1, &quot;a&quot;);
        lruCacheDemo.put(2, &quot;b&quot;);
        lruCacheDemo.put(3, &quot;c&quot;);
        System.out.println(lruCacheDemo.keySet());

        lruCacheDemo.put(4, &quot;d&quot;);
        System.out.println(lruCacheDemo.keySet());

        lruCacheDemo.put(3, &quot;c&quot;);
        System.out.println(lruCacheDemo.keySet());
        lruCacheDemo.put(3, &quot;c&quot;);
        System.out.println(lruCacheDemo.keySet());
        lruCacheDemo.put(3, &quot;c&quot;);
        System.out.println(lruCacheDemo.keySet());
        lruCacheDemo.put(5, &quot;x&quot;);
        System.out.println(lruCacheDemo.keySet());
    }

}
</code></pre><hr><p><strong>ä¸ºä½•è¦é‡å†™ <code>boolean removeEldestEntry(Map.Entry&lt;K, V&gt; eldest)</code> æ–¹æ³•</strong></p><p>å…ˆæ¥çœ‹çœ‹ <code>LinkedHashMap</code> ä¸­çš„ <code>boolean removeEldestEntry(Map.Entry&lt;K, V&gt; eldest)</code> æ–¹æ³•ï¼Œç›´æ¥ <code>return false</code>ï¼Œç¼“å­˜çˆ†å°±çˆ†ï¼Œåæ­£å°±æ˜¯ä¸ä¼šåˆ é™¤ <code>EldestEntry</code></p><pre><code>/**
 * Returns &lt;tt&gt;true&lt;/tt&gt; if this map should remove its eldest entry.
 * This method is invoked by &lt;tt&gt;put&lt;/tt&gt; and &lt;tt&gt;putAll&lt;/tt&gt; after
 * inserting a new entry into the map.  It provides the implementor
 * with the opportunity to remove the eldest entry each time a new one
 * is added.  This is useful if the map represents a cache: it allows
 * the map to reduce memory consumption by deleting stale entries.
 */
protected boolean removeEldestEntry(Map.Entry&lt;K,V&gt; eldest) {
    return false;
}
</code></pre><p><code>boolean removeEldestEntry(Map.Entry&lt;K, V&gt; eldest)</code> æ–¹æ³•åœ¨ <code>void afterNodeInsertion(boolean evict)</code> æ–¹æ³•ä¸­è¢«è°ƒç”¨ï¼Œåªæœ‰å½“ <code>boolean removeEldestEntry(Map.Entry&lt;K, V&gt; eldest)</code> æ–¹æ³•è¿”å› <code>true</code> æ—¶ï¼Œæ‰èƒ½å¤Ÿåˆ é™¤ <code>EldestEntry</code></p><figure><img src="/assets/img/7570b462ec360e4c471e0115f9c40dbe.cd650514.png" alt="image-20210207191111729" tabindex="0" loading="lazy"><figcaption>image-20210207191111729</figcaption></figure><p>å› æ­¤æˆ‘ä»¬é‡å†™ä¹‹åçš„åˆ¤æ–­æ¡ä»¶ä¸ºï¼šå¦‚æœ <code>LinkedHashMap</code> ä¸­å­˜å‚¨çš„å…ƒç´ ä¸ªæ•°å·²ç»å¤§äºç¼“å­˜å®¹é‡ <code>capacity</code>ï¼Œåˆ™è¿”å› <code>true</code>ï¼Œè¡¨ç¤ºå…è®¸åˆ é™¤ <code>EldestEntry</code>ï¼›å¦åˆ™è¿”å› <code>false</code>ï¼Œè¡¨ç¤ºæ— éœ€åˆ é™¤ <code>EldestEntry</code></p><pre><code>// ç”¨äºåˆ¤æ–­æ˜¯å¦éœ€è¦åˆ é™¤æœ€è¿‘æœ€ä¹…æœªä½¿ç”¨çš„èŠ‚ç‚¹
@Override
protected boolean removeEldestEntry(Map.Entry&lt;K, V&gt; eldest) {
    return super.size() &gt; capacity;
}
</code></pre><hr><p><strong>ä¸¾ä¾‹è¯´æ˜æ„é€ å‡½æ•°ä¸­çš„ <code>accessOrder</code> çš„å«ä¹‰</strong></p><p><strong>æ„é€ å‡½æ•°ä¸­çš„ <code>accessOrder</code> å­—æ®µ</strong></p><p>åœ¨ <code>LRUCacheDemo</code> çš„æ„é€ æ–¹æ³•ä¸­ï¼Œæˆ‘ä»¬è°ƒç”¨äº† <code>LinkedHashMap</code> çš„æ„é€ æ–¹æ³•ï¼Œå…¶ä¸­æœ‰ä¸€ä¸ªå­—æ®µä¸º <code>accessOrder</code></p><figure><img src="/assets/img/e2135890194fbd120f88377c16d34b26.bb56c8a4.png" alt="image-20210207193458904" tabindex="0" loading="lazy"><figcaption>image-20210207193458904</figcaption></figure><p><strong><code>accessOrder = true</code> å’Œ <code>accessOrder = false</code> çš„æƒ…å†µ</strong></p><p>å½“ <code>accessOrder = true</code> æ—¶ï¼Œæ¯æ¬¡ä½¿ç”¨ key æ—¶ï¼ˆput æˆ–è€… get æ—¶ï¼‰ï¼Œéƒ½å°† key å¯¹åº”çš„æ•°æ®ç§»åŠ¨åˆ°é˜Ÿå°¾ï¼ˆå³è¾¹ï¼‰ï¼Œè¡¨ç¤ºæœ€è¿‘ç»å¸¸ä½¿ç”¨ï¼›å½“ <code>accessOrder = false</code> æ—¶ï¼Œkey çš„é¡ºåºä¸ºæ’å…¥åŒå‘é“¾è¡¨æ—¶çš„é¡ºåº</p><figure><img src="/assets/img/b2d5a55df4837226e085710d78a0d8f6.8f4978be.png" alt="image-20210207194714608" tabindex="0" loading="lazy"><figcaption>image-20210207194714608</figcaption></figure><hr><p><strong><code>LinkedHashMap</code> çš„ <code>put()</code> æ–¹æ³•</strong></p><p><code>LinkedHashMap</code> çš„ <code>put()</code> æ–¹æ³•å…¶å®å°±æ˜¯ <code>HashMap</code> çš„ <code>put()</code> æ–¹æ³•ï¼Œæˆ‘å°±å¥‡äº†æ€ªäº†ï¼Œ<code>LinkedHashMap</code> å°±æ˜¯ <code>HashMap</code>ï¼Ÿï¼Ÿï¼Ÿå…¶å®å¹¶ä¸æ˜¯ã€‚ã€‚ã€‚</p><figure><img src="/assets/img/8b951c9716edddca0ffbf18939a85b7f.5cef5fff.png" alt="image-20210207201318744" tabindex="0" loading="lazy"><figcaption>image-20210207201318744</figcaption></figure><p>åœ¨ <code>putval()</code> æ–¹æ³•çš„è°ƒç”¨äº†ä¸¤ä¸ªæ–¹æ³•ï¼š<code>afterNodeAccess(e)</code> æ–¹æ³•å’Œ <code>afterNodeInsertion(evict)</code> æ–¹æ³•ï¼Œè¿™ä¸¤ä¸ªæ–¹æ³•å°±æ˜¯ä¸“é—¨é’ˆå¯¹äº <code>LinkedHashMap</code> å†™çš„æ–¹æ³•</p><figure><img src="/assets/img/20281aaa0047452e62895ab11a15d3c7.6ec0b14a.png" alt="image-20210207213030434" tabindex="0" loading="lazy"><figcaption>image-20210207213030434</figcaption></figure><p>åœ¨ HashMap ä¸­è¿™äº›æ–¹æ³•å‡ä¸ºç©ºå®ç°çš„æ–¹æ³•ï¼Œæ²¡æœ‰ä»»ä½•ä»£ç é€»è¾‘ï¼Œéœ€è¦æ¨è¿Ÿåˆ°å­ç±» <code>LinkedHashMap</code> ä¸­å»å®ç°ï¼Œç­‰ç­‰ï¼Œå¬ç€å¥½åƒæœ‰ç‚¹è€³ç†Ÿï¼Œè¿™ä¸å°±æ˜¯æ¨¡æ¿æ–¹æ³•è®¾è®¡æ¨¡å¼å˜›~</p><figure><img src="/assets/img/cba6f4aecbc28f7805722ab4f4ae66ab.d475a490.png" alt="image-20210207204446152" tabindex="0" loading="lazy"><figcaption>image-20210207204446152</figcaption></figure><p>åœ¨ <code>LinkedHashMap</code> çš„ <code>void afterNodeAccess(Node&lt;K,V&gt; e)</code> æ–¹æ³•ä¸­ï¼šå¦‚æœè®¾ç½®äº† <code>accessOrder = true</code> æ—¶ï¼Œåˆ™æ¯æ¬¡ä½¿ç”¨ key æ—¶ï¼ˆput æˆ–è€… get æ—¶ï¼‰ï¼Œéƒ½å°† key å¯¹åº”çš„æ•°æ®ç§»åŠ¨åˆ°é˜Ÿå°¾ï¼ˆå³è¾¹ï¼‰ï¼Œè¡¨ç¤ºè¿™æ˜¯æœ€è¿‘ç»å¸¸ä½¿ç”¨çš„èŠ‚ç‚¹</p><figure><img src="/assets/img/5b9e9c2cf24bd998b510f3b998d186ae.4abfa8fc.png" alt="image-20210207213252015" tabindex="0" loading="lazy"><figcaption>image-20210207213252015</figcaption></figure><p>åœ¨ <code>LinkedHashMap</code> çš„ <code>void afterNodeInsertion(boolean evict)</code> æ–¹æ³•ä¸­ï¼šå¦‚æœå¤´æŒ‡é’ˆä¸ä¸ºç©ºå¹¶ä¸”å½“å‰éœ€è¦åˆ é™¤è€èŠ‚ç‚¹ï¼Œåˆ™æ‰§è¡Œ <code>removeNode(hash(key), key, null, false, true)</code> æ–¹æ³•åˆ é™¤ <code>EldestEntry</code>ï¼ˆè‹¥ <code>accessOrder = true</code> æ—¶ï¼Œ<code>EldestEntry</code> è¡¨ç¤ºæœ€è¿‘æœ€å°‘ä½¿ç”¨çš„æ•°æ®ï¼Œè‹¥ <code>accessOrder = false</code> æ—¶ï¼Œ<code>EldestEntry</code> è¡¨ç¤ºæœ€å…ˆæ’å…¥é“¾è¡¨çš„èŠ‚ç‚¹ï¼‰</p><figure><img src="/assets/img/3850a07b1fc4b5bbfd0748ee2a757ced.b66a3dab.png" alt="image-20210207204652052" tabindex="0" loading="lazy"><figcaption>image-20210207204652052</figcaption></figure><hr><p><strong><code>LinkedHashMap</code> çš„ <code>get()</code> æ–¹æ³•</strong></p><p>åœ¨ <code>LinkedHashMap</code> çš„ <code>get()</code> æ–¹æ³•ä¸­ï¼šè‹¥ <code>accessOrder = true</code> æ—¶ï¼Œåˆ™æ¯æ¬¡ <code>get(key)</code> ä¹‹åéƒ½ä¼šå°† key å¯¹åº”çš„æ•°æ®ç§»åŠ¨è‡³åŒå‘é“¾è¡¨çš„å°¾éƒ¨</p><figure><img src="/assets/img/4ca06bbb4e77c2f2d417531326d61848.05a667dc.png" alt="image-20210207213541630" tabindex="0" loading="lazy"><figcaption>image-20210207213541630</figcaption></figure><hr><p><strong>LinkedHashMap ä¸­å¦‚ä½•æ„é€ åŒå‘é“¾è¡¨ï¼Ÿ</strong></p><p><code>Entry&lt;K,V&gt;</code> ç»§æ‰¿äº† <code>HashMap.Node&lt;K,V&gt;</code>ï¼Œå¹¶ä¸”æœ‰ <code>Entry&lt;K,V&gt; before, after;</code> ä¸¤ä¸ªå­—æ®µï¼Œè¿™ä¸å°±æ˜¯åŒçº¿é“¾è¡¨çš„æ ‡é…å˜›</p><figure><img src="/assets/img/30f70c33662af55fd6456357ea63c197.117c9bec.png" alt="image-20210207214024085" tabindex="0" loading="lazy"><figcaption>image-20210207214024085</figcaption></figure><p>åœ¨ <code>LinkedHashMap</code> ä¸­å®šä¹‰äº† <code>head</code> å’Œ <code>tail</code> ï¼Œåˆ†åˆ«æŒ‡å‘åŒå‘é“¾è¡¨çš„å¤´éƒ¨å’Œå°¾éƒ¨ï¼Œäººå®¶æ³¨é‡Šä¸­ä¹Ÿè¯´äº†ï¼Œ<code>head</code> ç”¨äºæŒ‡å‘åŒå‘é“¾è¡¨ä¸­æœ€è€çš„èŠ‚ç‚¹ï¼Œtail ç”¨äºæŒ‡å‘æœ€å¹´è½»çš„èŠ‚ç‚¹ï¼Œè‡³äºæœ€è€å’Œæœ€å¹´è½»çš„å®šä¹‰ï¼Œå°±å¾—çœ‹ <code>accessOrder</code> å­—æ®µçš„å€¼äº†ï¼šå¦‚æœ <code>accessOrder = true</code>ï¼Œé‚£ä¹ˆæœ€è€çš„èŠ‚ç‚¹å°±æ˜¯æœ€ä¹…æ²¡æœ‰è¢«ä½¿ç”¨è¿‡çš„èŠ‚ç‚¹ï¼Œæœ€å¹´è½»çš„èŠ‚ç‚¹å°±æ˜¯æœ€è¿‘è¢«åˆšè¢«ä½¿ç”¨è¿‡çš„èŠ‚ç‚¹ï¼›å¦‚æœ <code>accessOrder = true</code>ï¼Œé‚£ä¹ˆæœ€è€çš„èŠ‚ç‚¹å°±æ˜¯é“¾è¡¨å¤´éƒ¨çš„èŠ‚ç‚¹ï¼Œæœ€å¹´è½»çš„èŠ‚ç‚¹å°±æ˜¯é“¾è¡¨å°¾éƒ¨çš„èŠ‚ç‚¹</p><figure><img src="/assets/img/002c18eae3ba2ac7ab9c4930dfdb9226.7ff9b86a.png" alt="image-20210207214134771" tabindex="0" loading="lazy"><figcaption>image-20210207214134771</figcaption></figure><blockquote><p><strong>2ã€å®Œå…¨è‡ªå·±æ‰‹å†™</strong></p></blockquote><ol><li><p>ä¾è‘«èŠ¦ç”»ç“¢ï¼Œå…ˆå®šä¹‰ Node ç±»ä½œä¸ºæ•°æ®çš„æ‰¿è½½ä½“</p><pre><code>// 1.æ„é€ ä¸€ä¸ªnodeèŠ‚ç‚¹ä½œä¸ºæ•°æ®è½½ä½“
class Node&lt;K, V&gt; {
    K key;
    V value;
    Node&lt;K, V&gt; prev;
    Node&lt;K, V&gt; next;

    public Node() {
        this.prev = this.next = null;
    }

    public Node(K key, V value) {
        this.key = key;
        this.value = value;
        this.prev = this.next = null;
    }
}
</code></pre></li><li><p>å®šä¹‰åŒå‘é“¾è¡¨ï¼Œé‡Œé¢å­˜æ”¾çš„å°±æ˜¯ Node å¯¹è±¡ï¼ŒNode èŠ‚ç‚¹ä¹‹é—´é€šè¿‡ <code>prev</code> å’Œ <code>next</code> æŒ‡é’ˆè¿æ¥èµ·æ¥</p><pre><code>// 2.æ„å»ºä¸€ä¸ªè™šæ‹Ÿçš„åŒå‘é“¾è¡¨,,é‡Œé¢å­˜æ”¾çš„å°±æ˜¯æˆ‘ä»¬çš„Node
class DoubleLinkedList&lt;K, V&gt; {
    Node&lt;K, V&gt; head;
    Node&lt;K, V&gt; tail;

    public DoubleLinkedList() {
        head = new Node&lt;&gt;();
        tail = new Node&lt;&gt;();
        head.next = tail;
        tail.prev = head;
    }

    // 3.æ·»åŠ åˆ°å¤´
    public void addHead(Node&lt;K, V&gt; node) {
        node.next = head.next;
        node.prev = head;
        head.next.prev = node;
        head.next = node;
    }

    // 4.åˆ é™¤èŠ‚ç‚¹
    public void removeNode(Node&lt;K, V&gt; node) {
        node.next.prev = node.prev;
        node.prev.next = node.next;
        node.prev = null;
        node.next = null;
    }

    // 5.è·å¾—æœ€åä¸€ä¸ªèŠ‚ç‚¹
    public Node getLast() {
        return tail.prev;
    }
}
</code></pre></li><li><p>é€šè¿‡ <code>HashMap</code> å’Œ <code>DoubleLinkedList</code> æ„å»º <code>LinkedHashMap</code>ï¼Œæˆ‘ä»¬è¿™é‡Œå¯æ˜¯å°†æœ€è¿‘æœ€å¸¸ä½¿ç”¨çš„èŠ‚ç‚¹æ”¾åœ¨äº†åŒå‘é“¾è¡¨çš„å¤´éƒ¨ï¼ˆå’Œ <code>LinkedHashMap</code> ä¸åŒå“¦ï¼‰</p><pre><code>private int cacheSize;
Map&lt;Integer, Node&lt;Integer, Integer&gt;&gt; map;
DoubleLinkedList&lt;Integer, Integer&gt; doubleLinkedList;

public LRUCacheDemo(int cacheSize) {
    this.cacheSize = cacheSize;//å‘ä½
    map = new HashMap&lt;&gt;();//æŸ¥æ‰¾
    doubleLinkedList = new DoubleLinkedList&lt;&gt;();
}

public int get(int key) {
    if (!map.containsKey(key)) {
        return -1;
    }

    Node&lt;Integer, Integer&gt; node = map.get(key);
    doubleLinkedList.removeNode(node);
    doubleLinkedList.addHead(node);
    
    return node.value;
}

public void put(int key, int value) {
    if (map.containsKey(key)) {  //update
        Node&lt;Integer, Integer&gt; node = map.get(key);
        node.value = value;
        map.put(key, node);
        
        doubleLinkedList.removeNode(node);
        doubleLinkedList.addHead(node);
    } else {
        if (map.size() == cacheSize)  //å‘ä½æ»¡äº†
        {
            Node&lt;Integer, Integer&gt; lastNode = doubleLinkedList.getLast();
            map.remove(lastNode.key);
            doubleLinkedList.removeNode(lastNode);
        }

        //æ–°å¢ä¸€ä¸ª
        Node&lt;Integer, Integer&gt; newNode = new Node&lt;&gt;(key, value);
        map.put(key, newNode);
        doubleLinkedList.addHead(newNode);

    }
}
</code></pre></li><li><p>æµ‹è¯• <code>LRUCacheDemo</code></p><pre><code>public static void main(String[] args) {

    LRUCacheDemo lruCacheDemo = new LRUCacheDemo(3);

    lruCacheDemo.put(1, 1);
    lruCacheDemo.put(2, 2);
    lruCacheDemo.put(3, 3);
    System.out.println(lruCacheDemo.map.keySet());

    lruCacheDemo.put(4, 1);
    System.out.println(lruCacheDemo.map.keySet());

    lruCacheDemo.put(3, 1);
    System.out.println(lruCacheDemo.map.keySet());
    lruCacheDemo.put(3, 1);
    System.out.println(lruCacheDemo.map.keySet());
    lruCacheDemo.put(3, 1);
    System.out.println(lruCacheDemo.map.keySet());
    lruCacheDemo.put(5, 1);
    System.out.println(lruCacheDemo.map.keySet());

}
</code></pre></li><li><p>æµ‹è¯•ç»“æœï¼šè¿™ä¸ªé¡ºåºæ˜¯ä¸å¯¹æ»´ï¼Œå› ä¸ºè¿™æ˜¯ <code>HashMap</code> ä¸­ <code>key</code> çš„é¡ºåºï¼Œå¹¶ä¸æ˜¯ <code>DoubleLinkedList</code> ä¸­ <code>key</code> çš„é¡ºåºï¼Œä½†è‡³å°‘å¯ä»¥è¯´æ˜æœ€è¿‘æœ€å°‘ä½¿ç”¨çš„æ•°æ®å·²ç»è¢«åˆ é™¤äº†~~~</p><figure><img src="/assets/img/ab423b570f2556aae42047dc30031fef.e3af4bbc.png" alt="image-20210207220552698" tabindex="0" loading="lazy"><figcaption>image-20210207220552698</figcaption></figure></li></ol><hr><p><strong>å…¨éƒ¨ä»£ç </strong></p><pre><code>public class LRUCacheDemo {

    // map è´Ÿè´£æŸ¥æ‰¾ï¼Œæ„å»ºä¸€ä¸ªè™šæ‹Ÿçš„åŒå‘é“¾è¡¨ï¼Œå®ƒé‡Œé¢è£…çš„å°±æ˜¯ä¸€ä¸ªä¸ª Node èŠ‚ç‚¹ï¼Œä½œä¸ºæ•°æ®è½½ä½“

    // 1.æ„é€ ä¸€ä¸ªnodeèŠ‚ç‚¹ä½œä¸ºæ•°æ®è½½ä½“
    class Node&lt;K, V&gt; {
        K key;
        V value;
        Node&lt;K, V&gt; prev;
        Node&lt;K, V&gt; next;

        public Node() {
            this.prev = this.next = null;
        }

        public Node(K key, V value) {
            this.key = key;
            this.value = value;
            this.prev = this.next = null;
        }
    }

    // 2.æ„å»ºä¸€ä¸ªè™šæ‹Ÿçš„åŒå‘é“¾è¡¨,,é‡Œé¢å®‰æ”¾çš„å°±æ˜¯æˆ‘ä»¬çš„Node
    class DoubleLinkedList&lt;K, V&gt; {
        Node&lt;K, V&gt; head;
        Node&lt;K, V&gt; tail;

        public DoubleLinkedList() {
            head = new Node&lt;&gt;();
            tail = new Node&lt;&gt;();
            head.next = tail;
            tail.prev = head;
        }

        // 3.æ·»åŠ åˆ°å¤´
        public void addHead(Node&lt;K, V&gt; node) {
            node.next = head.next;
            node.prev = head;
            head.next.prev = node;
            head.next = node;
        }

        // 4.åˆ é™¤èŠ‚ç‚¹
        public void removeNode(Node&lt;K, V&gt; node) {
            node.next.prev = node.prev;
            node.prev.next = node.next;
            node.prev = null;
            node.next = null;
        }

        // 5.è·å¾—æœ€åä¸€ä¸ªèŠ‚ç‚¹
        public Node getLast() {
            return tail.prev;
        }
    }

    private int cacheSize;
    Map&lt;Integer, Node&lt;Integer, Integer&gt;&gt; map;
    DoubleLinkedList&lt;Integer, Integer&gt; doubleLinkedList;

    public LRUCacheDemo(int cacheSize) {
        this.cacheSize = cacheSize;//å‘ä½
        map = new HashMap&lt;&gt;();//æŸ¥æ‰¾
        doubleLinkedList = new DoubleLinkedList&lt;&gt;();
    }

    public int get(int key) {
        if (!map.containsKey(key)) {
            return -1;
        }

        Node&lt;Integer, Integer&gt; node = map.get(key);
        doubleLinkedList.removeNode(node);
        doubleLinkedList.addHead(node);

        return node.value;
    }

    public void put(int key, int value) {
        if (map.containsKey(key)) {  //update
            Node&lt;Integer, Integer&gt; node = map.get(key);
            node.value = value;
            map.put(key, node);

            doubleLinkedList.removeNode(node);
            doubleLinkedList.addHead(node);
        } else {
            if (map.size() == cacheSize)  //å‘ä½æ»¡äº†
            {
                Node&lt;Integer, Integer&gt; lastNode = doubleLinkedList.getLast();
                map.remove(lastNode.key);
                doubleLinkedList.removeNode(lastNode);
            }

            //æ–°å¢ä¸€ä¸ª
            Node&lt;Integer, Integer&gt; newNode = new Node&lt;&gt;(key, value);
            map.put(key, newNode);
            doubleLinkedList.addHead(newNode);

        }
    }

    public static void main(String[] args) {

        LRUCacheDemo lruCacheDemo = new LRUCacheDemo(3);

        lruCacheDemo.put(1, 1);
        lruCacheDemo.put(2, 2);
        lruCacheDemo.put(3, 3);
        System.out.println(lruCacheDemo.map.keySet());

        lruCacheDemo.put(4, 1);
        System.out.println(lruCacheDemo.map.keySet());

        lruCacheDemo.put(3, 1);
        System.out.println(lruCacheDemo.map.keySet());
        lruCacheDemo.put(3, 1);
        System.out.println(lruCacheDemo.map.keySet());
        lruCacheDemo.put(3, 1);
        System.out.println(lruCacheDemo.map.keySet());
        lruCacheDemo.put(5, 1);
        System.out.println(lruCacheDemo.map.keySet());

    }
}
</code></pre><hr><p><strong>å›¾è§£åŒå‘é˜Ÿåˆ—</strong></p><ol><li><p><code>DoubleLinkedList</code> åŒå‘é“¾è¡¨çš„åˆå§‹åŒ–</p><figure><img src="/assets/img/2ca45a630c105106f1052e5fdf1a8aa2.b60b50ce.png" alt="image-20210207220712585" tabindex="0" loading="lazy"><figcaption>image-20210207220712585</figcaption></figure></li><li><p>åŒå‘é“¾è¡¨æ’å…¥èŠ‚ç‚¹</p><figure><img src="/assets/img/3543591488da5c26a2dd6aa1abf82ae1.1402e94d.png" alt="image-20210207220859295" tabindex="0" loading="lazy"><figcaption>image-20210207220859295</figcaption></figure></li><li><p>åŒå‘é“¾è¡¨åˆ é™¤èŠ‚ç‚¹</p><p><img src="/assets/img/151c954021cb888f15e299ddb20346df.c9e1cbfa.png" alt="image-20210207221116712" loading="lazy">## ç›®æ ‡</p></li></ol><h3 id="åŸç†" tabindex="-1"><a class="header-anchor" href="#åŸç†"><span>åŸç†</span></a></h3></div><!----><footer class="vp-page-meta"><div class="vp-meta-item edit-link"><a class="auto-link external-link vp-meta-label" href="https://github.com/vuepress-theme-hope/vuepress-theme-hope/edit/main/src/study-notes/shangguigu-three/Redis/README.md" aria-label="åœ¨ GitHub ä¸Šç¼–è¾‘æ­¤é¡µ" rel="noopener noreferrer" target="_blank"><!--[--><svg xmlns="http://www.w3.org/2000/svg" class="icon edit-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="edit icon" name="edit"><path d="M430.818 653.65a60.46 60.46 0 0 1-50.96-93.281l71.69-114.012 7.773-10.365L816.038 80.138A60.46 60.46 0 0 1 859.225 62a60.46 60.46 0 0 1 43.186 18.138l43.186 43.186a60.46 60.46 0 0 1 0 86.373L588.879 565.55l-8.637 8.637-117.466 68.234a60.46 60.46 0 0 1-31.958 11.229z"></path><path d="M728.802 962H252.891A190.883 190.883 0 0 1 62.008 771.98V296.934a190.883 190.883 0 0 1 190.883-192.61h267.754a60.46 60.46 0 0 1 0 120.92H252.891a69.962 69.962 0 0 0-69.098 69.099V771.98a69.962 69.962 0 0 0 69.098 69.098h475.911A69.962 69.962 0 0 0 797.9 771.98V503.363a60.46 60.46 0 1 1 120.922 0V771.98A190.883 190.883 0 0 1 728.802 962z"></path></svg><!--]-->åœ¨ GitHub ä¸Šç¼–è¾‘æ­¤é¡µ<!----></a></div><div class="vp-meta-item git-info"><div class="update-time"><span class="vp-meta-label">ä¸Šæ¬¡ç¼–è¾‘äº: </span><!----></div><div class="contributors"><span class="vp-meta-label">è´¡çŒ®è€…: </span><!--[--><!--[--><span class="vp-meta-info" title="email: 948742327@qq.com">jiang</span><!--]--><!--]--></div></div></footer><nav class="vp-page-nav"><a class="route-link auto-link prev" href="/study-notes/shangguigu-three/Spring/" aria-label="Spring"><div class="hint"><span class="arrow start"></span>ä¸Šä¸€é¡µ</div><div class="link"><!---->Spring</div></a><a class="route-link auto-link next" href="/study-notes/shangguigu-three/UUID/" aria-label="é›†ç¾¤é«˜å¹¶å‘æƒ…å†µä¸‹å¦‚ä½•ä¿è¯åˆ†å¸ƒå¼å”¯ä¸€å…¨å±€Idç”Ÿæˆ"><div class="hint">ä¸‹ä¸€é¡µ<span class="arrow end"></span></div><div class="link">é›†ç¾¤é«˜å¹¶å‘æƒ…å†µä¸‹å¦‚ä½•ä¿è¯åˆ†å¸ƒå¼å”¯ä¸€å…¨å±€Idç”Ÿæˆ<!----></div></a></nav><!----><!----><!--]--></main><!--]--><footer class="vp-footer-wrapper"><div class="vp-footer">å­åœ¨å·ä¸Šæ›°ï¼šâ€œé€è€…å¦‚æ–¯å¤«ï¼Œä¸èˆæ˜¼å¤œã€‚</div><div class="vp-copyright">Copyright Â© 2024 æ¨±å® </div></footer></div><!--]--><!--[--><!----><!--]--><!--]--></div>
    <script src="/assets/js/runtime~app.b0d5d539.js" defer></script><script src="/assets/js/4438.2d872995.js" defer></script><script src="/assets/js/app.44d28fea.js" defer></script>
  </body>
</html>
