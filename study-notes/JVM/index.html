<!doctype html>
<html lang="zh-CN" data-theme="light">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <meta name="generator" content="VuePress 2.0.0-rc.14" />
    <meta name="theme" content="VuePress Theme Hope 2.0.0-rc.52" />
    <style>
      html {
        background: var(--bg-color, #fff);
      }

      html[data-theme="dark"] {
        background: var(--bg-color, #1d1e1f);
      }

      body {
        background: var(--bg-color);
      }
    </style>
    <script>
      const userMode = localStorage.getItem("vuepress-theme-hope-scheme");
      const systemDarkMode =
        window.matchMedia &&
        window.matchMedia("(prefers-color-scheme: dark)").matches;

      if (userMode === "dark" || (userMode !== "light" && systemDarkMode)) {
        document.documentElement.setAttribute("data-theme", "dark");
      }
    </script>
    <meta property="og:url" content="https://mister-hope.github.io/blog/study-notes/JVM/"><meta property="og:site_name" content="æ’„å®çš„åšå®¢"><meta property="og:title" content="JVM"><meta property="og:description" content="ä»‹ç» æç¤º è¯¥æ–‡ç« åŒ…å«JVMåŸºç¡€å…¥é—¨ç¯‡å…¨éƒ¨å†…å®¹ä»¥åŠå®‹çº¢åº·è€å¸ˆJVMæ•™ç¨‹å…¨å¥—ç¬”è®°ã€‚ æ¥æºBilibiliå°šç¡…è°·å®‹çº¢åº·è€å¸ˆJVMæ•™ç¨‹ï¼šç¡…è°·2020æœ€æ–°ç‰ˆå®‹çº¢åº·JVMæ•™ç¨‹ ç¬”è®°è¡¥å……ï¼šhttps://gitee.com/vectorx/NOTE_JVM/tree/main , https://www.yuque.com/u21195183/jvm æœ€ç»†è‡´çš„JV..."><meta property="og:type" content="article"><meta property="og:locale" content="zh-CN"><meta property="og:updated_time" content="2024-08-11T14:20:56.000Z"><meta property="article:author" content="æ¨±å®"><meta property="article:published_time" content="2023-03-18T00:00:00.000Z"><meta property="article:modified_time" content="2024-08-11T14:20:56.000Z"><script type="application/ld+json">{"@context":"https://schema.org","@type":"Article","headline":"JVM","image":[""],"datePublished":"2023-03-18T00:00:00.000Z","dateModified":"2024-08-11T14:20:56.000Z","author":[{"@type":"Person","name":"æ¨±å®","url":"https://mister-hope.com"}]}</script><title>JVM | æ’„å®çš„åšå®¢</title><meta name="description" content="ä»‹ç» æç¤º è¯¥æ–‡ç« åŒ…å«JVMåŸºç¡€å…¥é—¨ç¯‡å…¨éƒ¨å†…å®¹ä»¥åŠå®‹çº¢åº·è€å¸ˆJVMæ•™ç¨‹å…¨å¥—ç¬”è®°ã€‚ æ¥æºBilibiliå°šç¡…è°·å®‹çº¢åº·è€å¸ˆJVMæ•™ç¨‹ï¼šç¡…è°·2020æœ€æ–°ç‰ˆå®‹çº¢åº·JVMæ•™ç¨‹ ç¬”è®°è¡¥å……ï¼šhttps://gitee.com/vectorx/NOTE_JVM/tree/main , https://www.yuque.com/u21195183/jvm æœ€ç»†è‡´çš„JV...">
    <link rel="stylesheet" href="/blog/assets/css/styles.9671c01d.css">
    <link rel="preload" href="/blog/assets/js/runtime~app.20661bf4.js" as="script"><link rel="preload" href="/blog/assets/css/styles.9671c01d.css" as="style"><link rel="preload" href="/blog/assets/js/4438.eaf07fb8.js" as="script"><link rel="preload" href="/blog/assets/js/app.1c886d51.js" as="script">
    <link rel="prefetch" href="/blog/assets/js/study-notes_RocketMQ_index.html.bd850176.js" as="script"><link rel="prefetch" href="/blog/assets/js/study-notes_heima-java-bagu_concurrent-programming_more.html.a93e326c.js" as="script"><link rel="prefetch" href="/blog/assets/js/study-notes_heima-java-bagu_JVM_index.html.f4fc8d7f.js" as="script"><link rel="prefetch" href="/blog/assets/js/study-notes_shangguigu-three_AQS_index.html.0d3bfda8.js" as="script"><link rel="prefetch" href="/blog/assets/js/study-notes_heima-java-bagu_concurrent-programming_index.html.bf382bfe.js" as="script"><link rel="prefetch" href="/blog/assets/js/study-notes_heima-java-bagu_collection_more.html.f927e40a.js" as="script"><link rel="prefetch" href="/blog/assets/js/study-notes_heima-baodian_framework_index.html.f60432c4.js" as="script"><link rel="prefetch" href="/blog/assets/js/study-notes_heima-baodian_base_index.html.1657a365.js" as="script"><link rel="prefetch" href="/blog/assets/js/study-notes_JVM_Bytecode-ClassLoading_Class-File-Structure_index.html.0c02279b.js" as="script"><link rel="prefetch" href="/blog/assets/js/study-notes_heima-java-bagu_enterprise-scenarios_design-patterns.html.0fb17d2a.js" as="script"><link rel="prefetch" href="/blog/assets/js/study-notes_shangguigu-three_Spring_index.html.77572f37.js" as="script"><link rel="prefetch" href="/blog/assets/js/study-notes_shangguigu-three_Redis_index.html.fc7f810c.js" as="script"><link rel="prefetch" href="/blog/assets/js/study-notes_spring-boot_index.html.52c0528d.js" as="script"><link rel="prefetch" href="/blog/assets/js/study-notes_JVM_Bytecode-ClassLoading_Bytecode-Instruction-Set_index.html.254e9c2d.js" as="script"><link rel="prefetch" href="/blog/assets/js/study-notes_JVM_Bytecode-ClassLoading_Class-Lifecycle2_index.html.bc99c7f1.js" as="script"><link rel="prefetch" href="/blog/assets/js/study-notes_JVM_Memory-GC_Heap_index.html.68a770cc.js" as="script"><link rel="prefetch" href="/blog/assets/js/study-notes_JVM_Performance-Monitoring-Tuning_JVM-Runtime-Parameters_index.html.635fe831.js" as="script"><link rel="prefetch" href="/blog/assets/js/study-notes_JVM_Memory-GC_StringTable_index.html.6c4d47ea.js" as="script"><link rel="prefetch" href="/blog/assets/js/study-notes_heima-java-bagu_collection_index.html.8f2a894f.js" as="script"><link rel="prefetch" href="/blog/assets/js/study-notes_JVM_Performance-Monitoring-Tuning_Heap-Memory-Leak_index.html.e960294f.js" as="script"><link rel="prefetch" href="/blog/assets/js/study-notes_JVM_Bytecode-ClassLoading_Class-Lifecycle_index.html.4ec25beb.js" as="script"><link rel="prefetch" href="/blog/assets/js/study-notes_JVM_Memory-GC_GC-Relevant-Overview_index.html.36fc13c3.js" as="script"><link rel="prefetch" href="/blog/assets/js/study-notes_shangguigu-second_ThreadPool_index.html.bbdd87d7.js" as="script"><link rel="prefetch" href="/blog/assets/js/study-notes_JVM_Memory-GC_GC-Period_index.html.9395d616.js" as="script"><link rel="prefetch" href="/blog/assets/js/problem-record_merge-pdf.html.986bfddb.js" as="script"><link rel="prefetch" href="/blog/assets/js/study-notes_JVM_Memory-GC_Clas-Loading-Subsystem_index.html.eeacb7ca.js" as="script"><link rel="prefetch" href="/blog/assets/js/problem-record_miscellaneous-notes.html.07640b8e.js" as="script"><link rel="prefetch" href="/blog/assets/js/study-notes_JVM_Memory-GC_GC-Relevant-Algorithms_index.html.01435b4c.js" as="script"><link rel="prefetch" href="/blog/assets/js/study-notes_JVM_Memory-GC_JVM-Stack_index.html.9750a299.js" as="script"><link rel="prefetch" href="/blog/assets/js/study-notes_JVM_index.html.5114a7bb.js" as="script"><link rel="prefetch" href="/blog/assets/js/study-notes_shangguigu-second_BlockingQueue_index.html.13d8f96d.js" as="script"><link rel="prefetch" href="/blog/assets/js/problem-record_delete-more-iif.html.53e3e45e.js" as="script"><link rel="prefetch" href="/blog/assets/js/photo-swipe.8b913169.js" as="script"><link rel="prefetch" href="/blog/assets/js/study-notes_JVM_Performance-Monitoring-Tuning_JVM-Monitoring-Diagnostic-Tools-GUI_index.html.20189922.js" as="script"><link rel="prefetch" href="/blog/assets/js/study-notes_JVM_Performance-Monitoring-Tuning_JVM-Monitoring-Diagnostic-Tools_index.html.b4e05289.js" as="script"><link rel="prefetch" href="/blog/assets/js/study-notes_JVM_Memory-GC_Method-Area_index.html.8a8fb983.js" as="script"><link rel="prefetch" href="/blog/assets/js/study-notes_shangguigu-second_JVM_six.html.7eb06694.js" as="script"><link rel="prefetch" href="/blog/assets/js/study-notes_shangguigu-second_volatile_two.html.033a5f91.js" as="script"><link rel="prefetch" href="/blog/assets/js/study-notes_JVM_Memory-GC_Java-Architecture_index.html.ab73f9af.js" as="script"><link rel="prefetch" href="/blog/assets/js/study-notes_shangguigu-second_JVM_four.html.186dddae.js" as="script"><link rel="prefetch" href="/blog/assets/js/study-notes_shangguigu-second_ABA_index.html.03eac8b8.js" as="script"><link rel="prefetch" href="/blog/assets/js/study-notes_heima-java-bagu_Redis_more.html.a89a0205.js" as="script"><link rel="prefetch" href="/blog/assets/js/problem-record_HTTPInputStreamExample.html.15d4b2b2.js" as="script"><link rel="prefetch" href="/blog/assets/js/study-notes_shangguigu-three_UUID_index.html.cb0a8aa7.js" as="script"><link rel="prefetch" href="/blog/assets/js/study-notes_shangguigu-second_lock_one.html.69dce286.js" as="script"><link rel="prefetch" href="/blog/assets/js/study-notes_heima-baodian_jvm_index.html.c8c8f608.js" as="script"><link rel="prefetch" href="/blog/assets/js/study-notes_heima-java-bagu_Redis_index.html.25e4f03e.js" as="script"><link rel="prefetch" href="/blog/assets/js/study-notes_JVM_Memory-GC_Execution-Engine_index.html.e2f353fe.js" as="script"><link rel="prefetch" href="/blog/assets/js/study-notes_shangguigu-second_JVM_three.html.09cbcc13.js" as="script"><link rel="prefetch" href="/blog/assets/js/study-notes_shangguigu-second_JVM_five.html.f5f03487.js" as="script"><link rel="prefetch" href="/blog/assets/js/note-record_index.html.fa7cdaa4.js" as="script"><link rel="prefetch" href="/blog/assets/js/study-notes_shangguigu-second_lock_three.html.1725df98.js" as="script"><link rel="prefetch" href="/blog/assets/js/study-notes_heima-java-bagu_MySQL_index.html.dafbb512.js" as="script"><link rel="prefetch" href="/blog/assets/js/study-notes_shangguigu-second_Linux_index.html.55af76ec.js" as="script"><link rel="prefetch" href="/blog/assets/js/web3_index.html.b018c3cd.js" as="script"><link rel="prefetch" href="/blog/assets/js/problem-record_idea-template.html.d6693415.js" as="script"><link rel="prefetch" href="/blog/assets/js/study-notes_shangguigu-second_ArrayList_index.html.82c00845.js" as="script"><link rel="prefetch" href="/blog/assets/js/study-notes_heima-java-bagu_frame_spring_index.html.0ab7b0bb.js" as="script"><link rel="prefetch" href="/blog/assets/js/study-notes_heima-java-bagu_MySQL_more.html.aa0cabd6.js" as="script"><link rel="prefetch" href="/blog/assets/js/study-notes_shangguigu-second_volatile_four.html.0846ad27.js" as="script"><link rel="prefetch" href="/blog/assets/js/study-notes_shangguigu-three_await-signal.html.dcc02c9c.js" as="script"><link rel="prefetch" href="/blog/assets/js/study-notes_JVM_Performance-Monitoring-Tuning_OQL_index.html.bc4b36e4.js" as="script"><link rel="prefetch" href="/blog/assets/js/study-notes_heima-baodian_concurrency_index.html.2c105ce7.js" as="script"><link rel="prefetch" href="/blog/assets/js/study-notes_shangguigu-three_two.html.e98ba3c6.js" as="script"><link rel="prefetch" href="/blog/assets/js/study-notes_shangguigu-second_Synchronized-Lock_index.html.1ced55bc.js" as="script"><link rel="prefetch" href="/blog/assets/js/study-notes_heima-java-bagu_enterprise-scenarios_technical-scenarios.html.6a8841f6.js" as="script"><link rel="prefetch" href="/blog/assets/js/study-notes_shangguigu-three_WaitNotify_index.html.97d04348.js" as="script"><link rel="prefetch" href="/blog/assets/js/demo_markdown.html.2419a983.js" as="script"><link rel="prefetch" href="/blog/assets/js/study-notes_shangguigu-second_volatile_one.html.7d8d92ca.js" as="script"><link rel="prefetch" href="/blog/assets/js/study-notes_heima-java-bagu_Microservices_index.html.5c8fb3da.js" as="script"><link rel="prefetch" href="/blog/assets/js/study-notes_shangguigu-second_SiSuo_index.html.ceba1a5b.js" as="script"><link rel="prefetch" href="/blog/assets/js/problem-record_github-tips.html.c2dd5761.js" as="script"><link rel="prefetch" href="/blog/assets/js/study-notes_JVM_Performance-Monitoring-Tuning_GC-Log_index.html.5fbe652f.js" as="script"><link rel="prefetch" href="/blog/assets/js/study-notes_shangguigu-second_CAS_index.html.f186195e.js" as="script"><link rel="prefetch" href="/blog/assets/js/study-notes_shangguigu-three_ReentrantLock_index.html.f99f098b.js" as="script"><link rel="prefetch" href="/blog/assets/js/study-notes_heima-java-bagu_frame_mybatis_index.html.bfa61d11.js" as="script"><link rel="prefetch" href="/blog/assets/js/study-notes_heima-java-bagu_frame_index.html.dd3a74a0.js" as="script"><link rel="prefetch" href="/blog/assets/js/study-notes_JVM_Memory-GC_GC-Overview_index.html.4e31f64c.js" as="script"><link rel="prefetch" href="/blog/assets/js/study-notes_JVM_Memory-GC_PCounter-Register_index.html.a843e71c.js" as="script"><link rel="prefetch" href="/blog/assets/js/study-notes_heima-java-bagu_message-middleware_more.html.6619c8b4.js" as="script"><link rel="prefetch" href="/blog/assets/js/problem-record_redission.html.f3bc970e.js" as="script"><link rel="prefetch" href="/blog/assets/js/study-notes_Internet_five_index.html.a9c5467a.js" as="script"><link rel="prefetch" href="/blog/assets/js/study-notes_JVM_Memory-GC_Native-Stack_index.html.77fa0156.js" as="script"><link rel="prefetch" href="/blog/assets/js/study-notes_JVM_Memory-GC_Object-Instantiation_index.html.7eaa3d90.js" as="script"><link rel="prefetch" href="/blog/assets/js/study-notes_shangguigu-second_volatile_three.html.ae2ba066.js" as="script"><link rel="prefetch" href="/blog/assets/js/study-notes_shangguigu-three_one.html.75d3c9e5.js" as="script"><link rel="prefetch" href="/blog/assets/js/study-notes_shangguigu-second_lock_four.html.2972623c.js" as="script"><link rel="prefetch" href="/blog/assets/js/study-notes_Internet_one_index.html.de942bc1.js" as="script"><link rel="prefetch" href="/blog/assets/js/study-notes_Internet_four_index.html.fe1da8f6.js" as="script"><link rel="prefetch" href="/blog/assets/js/study-notes_shangguigu-second_CountDownLatch_CyclicBarrier_Semaphore_Semaphore.html.58cfbf60.js" as="script"><link rel="prefetch" href="/blog/assets/js/study-notes_shangguigu-second_CountDownLatch_CyclicBarrier_Semaphore_countDownLatch.html.17bee20a.js" as="script"><link rel="prefetch" href="/blog/assets/js/study-notes_shangguigu-second_CountDownLatch_CyclicBarrier_Semaphore_CyclicBarrier.html.e9ce0246.js" as="script"><link rel="prefetch" href="/blog/assets/js/problem-record_interview-transcripts.html.dbe4778b.js" as="script"><link rel="prefetch" href="/blog/assets/js/study-notes_Internet_https-http_index.html.54fc73e0.js" as="script"><link rel="prefetch" href="/blog/assets/js/study-notes_Internet_TCP_index.html.dcb36480.js" as="script"><link rel="prefetch" href="/blog/assets/js/study-notes_shangguigu-second_JVM_two.html.c930b003.js" as="script"><link rel="prefetch" href="/blog/assets/js/study-notes_JVM_Performance-Monitoring-Tuning_JVM-Overview_index.html.a502d041.js" as="script"><link rel="prefetch" href="/blog/assets/js/study-notes_Internet_http-state_index.html.b36f311a.js" as="script"><link rel="prefetch" href="/blog/assets/js/about-the-blogs_about-learn.html.16abdf7e.js" as="script"><link rel="prefetch" href="/blog/assets/js/study-notes_shangguigu-three_LockSupport_index.html.10d1cca6.js" as="script"><link rel="prefetch" href="/blog/assets/js/study-notes_JVM_Memory-GC_Direct-Memory_index.html.795ce2ff.js" as="script"><link rel="prefetch" href="/blog/assets/js/study-notes_JVM_Memory-GC_JVM-RuntimeDataAreas_index.html.209d12a4.js" as="script"><link rel="prefetch" href="/blog/assets/js/study-notes_shangguigu-second_lock_six.html.4d58fe99.js" as="script"><link rel="prefetch" href="/blog/assets/js/study-notes_JVM_Memory-GC_index.html.646aaed6.js" as="script"><link rel="prefetch" href="/blog/assets/js/study-notes_shangguigu-second_lock_two.html.33230ffa.js" as="script"><link rel="prefetch" href="/blog/assets/js/interview-related_index.html.a8bdaa7d.js" as="script"><link rel="prefetch" href="/blog/assets/js/study-notes_shangguigu-second_github_index.html.761cc6ad.js" as="script"><link rel="prefetch" href="/blog/assets/js/study-notes_shangguigu-second_lock_five.html.7cd5de88.js" as="script"><link rel="prefetch" href="/blog/assets/js/demo_page.html.a78f031d.js" as="script"><link rel="prefetch" href="/blog/assets/js/study-notes_shangguigu-second_JVM_one.html.79dc72a0.js" as="script"><link rel="prefetch" href="/blog/assets/js/vue_basics.html.65fbd4cf.js" as="script"><link rel="prefetch" href="/blog/assets/js/study-notes_JVM_Performance-Monitoring-Tuning_index.html.771ce373.js" as="script"><link rel="prefetch" href="/blog/assets/js/study-notes_shangguigu-three_index.html.cdbbd36e.js" as="script"><link rel="prefetch" href="/blog/assets/js/demo_layout.html.2b87b7dd.js" as="script"><link rel="prefetch" href="/blog/assets/js/study-notes_JVM_Bytecode-ClassLoading_index.html.583f2a56.js" as="script"><link rel="prefetch" href="/blog/assets/js/study-notes_heima-java-bagu_index.html.eb47114b.js" as="script"><link rel="prefetch" href="/blog/assets/js/index.html.46b60596.js" as="script"><link rel="prefetch" href="/blog/assets/js/study-notes_heima-baodian_index.html.e3cbc130.js" as="script"><link rel="prefetch" href="/blog/assets/js/study-notes_Internet_index.html.e7e91ab4.js" as="script"><link rel="prefetch" href="/blog/assets/js/problem-record_tool.html.494daabd.js" as="script"><link rel="prefetch" href="/blog/assets/js/study-notes_SpringCloud_index.html.160ac097.js" as="script"><link rel="prefetch" href="/blog/assets/js/about-the-blogs_about-blogs.html.aa1ecaf9.js" as="script"><link rel="prefetch" href="/blog/assets/js/posts_tomato.html.dfd40bb8.js" as="script"><link rel="prefetch" href="/blog/assets/js/posts_cherry.html.ec96fec5.js" as="script"><link rel="prefetch" href="/blog/assets/js/posts_dragonfruit.html.255c3e4d.js" as="script"><link rel="prefetch" href="/blog/assets/js/interview-related_collection.html.2f8f4f9c.js" as="script"><link rel="prefetch" href="/blog/assets/js/interview-related_java-thread.html.20dd6f83.js" as="script"><link rel="prefetch" href="/blog/assets/js/interview-related_network.html.224e8806.js" as="script"><link rel="prefetch" href="/blog/assets/js/posts_strawberry.html.61931a9d.js" as="script"><link rel="prefetch" href="/blog/assets/js/interview-related_javase.html.40e8af1a.js" as="script"><link rel="prefetch" href="/blog/assets/js/interview-related_rocketMQ.html.4b7eec38.js" as="script"><link rel="prefetch" href="/blog/assets/js/demo_disable.html.907dfdb5.js" as="script"><link rel="prefetch" href="/blog/assets/js/interview-related_mybatis.html.3bf0770a.js" as="script"><link rel="prefetch" href="/blog/assets/js/interview-related_spring.html.63c43fa0.js" as="script"><link rel="prefetch" href="/blog/assets/js/problem-record_idea-tool.html.b24f135f.js" as="script"><link rel="prefetch" href="/blog/assets/js/interview-related_mysql.html.f00d3352.js" as="script"><link rel="prefetch" href="/blog/assets/js/interview-related_redis.html.6b5a2f96.js" as="script"><link rel="prefetch" href="/blog/assets/js/interview-related_jvm.html.9ea16d71.js" as="script"><link rel="prefetch" href="/blog/assets/js/intro.html.09c1a285.js" as="script"><link rel="prefetch" href="/blog/assets/js/study-notes_heima-java-bagu_message-middleware_index.html.cf5f0508.js" as="script"><link rel="prefetch" href="/blog/assets/js/vue_advanced.html.3b019301.js" as="script"><link rel="prefetch" href="/blog/assets/js/demo_index.html.b2e39199.js" as="script"><link rel="prefetch" href="/blog/assets/js/study-notes_Redis_index.html.89836804.js" as="script"><link rel="prefetch" href="/blog/assets/js/study-notes_index.html.71642ca2.js" as="script"><link rel="prefetch" href="/blog/assets/js/about-the-blogs_index.html.a8ae79af.js" as="script"><link rel="prefetch" href="/blog/assets/js/demo_encrypt.html.54689103.js" as="script"><link rel="prefetch" href="/blog/assets/js/study-notes_shangguigu-second_CountDownLatch_CyclicBarrier_Semaphore_index.html.413713e1.js" as="script"><link rel="prefetch" href="/blog/assets/js/category_å¾…å®Œæˆå­¦ä¹ _index.html.8e2086f3.js" as="script"><link rel="prefetch" href="/blog/assets/js/category_è®¡ç®—æœºç½‘ç»œ_index.html.819b4859.js" as="script"><link rel="prefetch" href="/blog/assets/js/tag_linuxè¯Šæ–­åŸå› _index.html.8117fe2e.js" as="script"><link rel="prefetch" href="/blog/assets/js/tag_åƒåœ¾æ”¶é›†å™¨_index.html.c2d1f350.js" as="script"><link rel="prefetch" href="/blog/assets/js/tag_è®¡ç®—æœºç½‘ç»œ_index.html.a93b37fa.js" as="script"><link rel="prefetch" href="/blog/assets/js/tag_javaä¸­çš„å¼•ç”¨_index.html.81402bf1.js" as="script"><link rel="prefetch" href="/blog/assets/js/tag_pdfæ–‡ä»¶åˆå¹¶_index.html.f062cc29.js" as="script"><link rel="prefetch" href="/blog/assets/js/category_ä»£ç å®è·µ_index.html.27c92fbb.js" as="script"><link rel="prefetch" href="/blog/assets/js/category_ä½¿ç”¨æŒ‡å—_index.html.94de2bb4.js" as="script"><link rel="prefetch" href="/blog/assets/js/category_å¼€å‘å·¥å…·_index.html.6e3d89ec.js" as="script"><link rel="prefetch" href="/blog/assets/js/category_æ–‡ä»¶ä¸‹è½½_index.html.9836e9a2.js" as="script"><link rel="prefetch" href="/blog/assets/js/category_é¢è¯•æŒ‡å—_index.html.99b3e1ac.js" as="script"><link rel="prefetch" href="/blog/assets/js/category_åˆ†å¸ƒå¼é”_index.html.d4bdbaa0.js" as="script"><link rel="prefetch" href="/blog/assets/js/category_å­¦ä¹ ç¬”è®°_index.html.421a3737.js" as="script"><link rel="prefetch" href="/blog/assets/js/tag_ä½¿ç”¨æŒ‡å—_index.html.96938614.js" as="script"><link rel="prefetch" href="/blog/assets/js/tag_é¡µé¢é…ç½®_index.html.ddd7f63e.js" as="script"><link rel="prefetch" href="/blog/assets/js/category_ä¸­é—´ä»¶_index.html.87a9aeef.js" as="script"><link rel="prefetch" href="/blog/assets/js/category_ç«é¾™æœ_index.html.e447a62b.js" as="script"><link rel="prefetch" href="/blog/assets/js/category_çº¿ç¨‹æ± _index.html.bb832014.js" as="script"><link rel="prefetch" href="/blog/assets/js/tag_çº¿ç¨‹æ± _index.html.84a40a2e.js" as="script"><link rel="prefetch" href="/blog/assets/js/category_vueç³»åˆ—_index.html.6ff801bf.js" as="script"><link rel="prefetch" href="/blog/assets/js/tag_countdownlatch_index.html.6595a17a.js" as="script"><link rel="prefetch" href="/blog/assets/js/tag_blockingqueue_index.html.745cc7db.js" as="script"><link rel="prefetch" href="/blog/assets/js/tag_cyclicbarrier_index.html.bc4f700e.js" as="script"><link rel="prefetch" href="/blog/assets/js/study-notes_heima-java-bagu_enterprise-scenarios_index.html.192b8d1f.js" as="script"><link rel="prefetch" href="/blog/assets/js/tag_abaé—®é¢˜_index.html.f6fac689.js" as="script"><link rel="prefetch" href="/blog/assets/js/tag_synchronized_index.html.2628ca6d.js" as="script"><link rel="prefetch" href="/blog/assets/js/category_ä½œè€…_index.html.e788c940.js" as="script"><link rel="prefetch" href="/blog/assets/js/category_åšå®¢_index.html.35aeb7ad.js" as="script"><link rel="prefetch" href="/blog/assets/js/category_æŒ‡å—_index.html.4a3d9fd2.js" as="script"><link rel="prefetch" href="/blog/assets/js/category_æ°´æœ_index.html.11f7ee15.js" as="script"><link rel="prefetch" href="/blog/assets/js/category_è‰è“_index.html.dd95575d.js" as="script"><link rel="prefetch" href="/blog/assets/js/category_è”¬èœ_index.html.7a7b205d.js" as="script"><link rel="prefetch" href="/blog/assets/js/category_é¢è¯•_index.html.45958a82.js" as="script"><link rel="prefetch" href="/blog/assets/js/category_é»‘é©¬_index.html.3c0b2869.js" as="script"><link rel="prefetch" href="/blog/assets/js/tag_springcloud_index.html.99de0fe8.js" as="script"><link rel="prefetch" href="/blog/assets/js/category_æ¨±æ¡ƒ_index.html.18f9b030.js" as="script"><link rel="prefetch" href="/blog/assets/js/tag_springboot_index.html.46c7c0e5.js" as="script"><link rel="prefetch" href="/blog/assets/js/category_redisson_index.html.590319b5.js" as="script"><link rel="prefetch" href="/blog/assets/js/tag_åŠ å¯†_index.html.f07579af.js" as="script"><link rel="prefetch" href="/blog/assets/js/tag_æ­»é”_index.html.34d360bf.js" as="script"><link rel="prefetch" href="/blog/assets/js/tag_ç¦ç”¨_index.html.64819e58.js" as="script"><link rel="prefetch" href="/blog/assets/js/tag_å¸ƒå±€_index.html.f7b0057a.js" as="script"><link rel="prefetch" href="/blog/assets/js/tag_semaphore_index.html.7a95d001.js" as="script"><link rel="prefetch" href="/blog/assets/js/tag_markdown_index.html.3ba87824.js" as="script"><link rel="prefetch" href="/blog/assets/js/tag_redisson_index.html.ff2fca35.js" as="script"><link rel="prefetch" href="/blog/assets/js/tag_rocketmq_index.html.e8f1a058.js" as="script"><link rel="prefetch" href="/blog/assets/js/tag_volatile_index.html.a48a6758.js" as="script"><link rel="prefetch" href="/blog/assets/js/category_python_index.html.a0ea6c0a.js" as="script"><link rel="prefetch" href="/blog/assets/js/category_github_index.html.84dcb32f.js" as="script"><link rel="prefetch" href="/blog/assets/js/category_redis_index.html.d5d12e9c.js" as="script"><link rel="prefetch" href="/blog/assets/js/tag_github_index.html.c9c91ee8.js" as="script"><link rel="prefetch" href="/blog/assets/js/tag_spring_index.html.71406c1b.js" as="script"><link rel="prefetch" href="/blog/assets/js/study-notes_shangguigu-second_index.html.a2389c24.js" as="script"><link rel="prefetch" href="/blog/assets/js/category_code_index.html.7ca5b8a1.js" as="script"><link rel="prefetch" href="/blog/assets/js/category_web3_index.html.edf52ccd.js" as="script"><link rel="prefetch" href="/blog/assets/js/category_idea_index.html.dc0d868f.js" as="script"><link rel="prefetch" href="/blog/assets/js/tag_redis_index.html.e15c2f4a.js" as="script"><link rel="prefetch" href="/blog/assets/js/tag_åœ†_index.html.8220a298.js" as="script"><link rel="prefetch" href="/blog/assets/js/tag_å¤§_index.html.2837f1e5.js" as="script"><link rel="prefetch" href="/blog/assets/js/tag_å°_index.html.85e82219.js" as="script"><link rel="prefetch" href="/blog/assets/js/tag_çº¢_index.html.e06e312c.js" as="script"><link rel="prefetch" href="/blog/assets/js/tag_é”_index.html.7bb13d00.js" as="script"><link rel="prefetch" href="/blog/assets/js/category_juc_index.html.dc80dd2b.js" as="script"><link rel="prefetch" href="/blog/assets/js/tag_lock_index.html.bd20548f.js" as="script"><link rel="prefetch" href="/blog/assets/js/tag_web3_index.html.d0981bdf.js" as="script"><link rel="prefetch" href="/blog/assets/js/study-notes_shangguigu-second_volatile_index.html.bc90db16.js" as="script"><link rel="prefetch" href="/blog/assets/js/tag_aqs_index.html.3563dfa9.js" as="script"><link rel="prefetch" href="/blog/assets/js/tag_cas_index.html.be2d9eaa.js" as="script"><link rel="prefetch" href="/blog/assets/js/tag_git_index.html.a51f8032.js" as="script"><link rel="prefetch" href="/blog/assets/js/tag_jvm_index.html.119c3056.js" as="script"><link rel="prefetch" href="/blog/assets/js/tag_oom_index.html.3c92e198.js" as="script"><link rel="prefetch" href="/blog/assets/js/tag_juc_index.html.78b58a59.js" as="script"><link rel="prefetch" href="/blog/assets/js/404.html.6d83dc11.js" as="script"><link rel="prefetch" href="/blog/assets/js/timeline_index.html.47284f52.js" as="script"><link rel="prefetch" href="/blog/assets/js/problem-record_index.html.0f943029.js" as="script"><link rel="prefetch" href="/blog/assets/js/study-notes_shangguigu-second_lock_index.html.fcbcad32.js" as="script"><link rel="prefetch" href="/blog/assets/js/category_index.html.8698f5cb.js" as="script"><link rel="prefetch" href="/blog/assets/js/study-notes_shangguigu-second_JVM_index.html.7173b9fa.js" as="script"><link rel="prefetch" href="/blog/assets/js/article_index.html.4c304c2e.js" as="script"><link rel="prefetch" href="/blog/assets/js/tag_index.html.a224de8b.js" as="script"><link rel="prefetch" href="/blog/assets/js/star_index.html.bda3bb41.js" as="script"><link rel="prefetch" href="/blog/assets/js/posts_index.html.acd217b6.js" as="script"><link rel="prefetch" href="/blog/assets/js/vue_index.html.0535f6ca.js" as="script">
  </head>
  <body>
    <div id="app"><!--[--><!--[--><!--[--><span tabindex="-1"></span><a href="#main-content" class="vp-skip-link sr-only">è·³è‡³ä¸»è¦å…§å®¹</a><!--]--><div class="theme-container external-link-icon has-toc"><!--[--><header id="navbar" class="vp-navbar"><div class="vp-navbar-start"><button type="button" class="vp-toggle-sidebar-button" title="Toggle Sidebar"><span class="icon"></span></button><!----><!--[--><a class="route-link vp-brand" href="/blog/"><img class="vp-nav-logo" src="https://theme-hope-assets.vuejs.press/logo.svg" alt><!----><span class="vp-site-name hide-in-pad">æ’„å®çš„åšå®¢</span></a><!--]--><!----></div><div class="vp-navbar-center"><!----><!--[--><nav class="vp-nav-links"><div class="vp-nav-item hide-in-mobile"><a class="route-link auto-link" href="/blog/" aria-label="é¦–é¡µ"><!--[--><span class="font-icon icon fa-fw fa-sm fas fa-home" style=""></span><!--]-->é¦–é¡µ<!----></a></div><div class="vp-nav-item hide-in-mobile"><a class="route-link route-link-active auto-link" href="/blog/study-notes/" aria-label="å­¦ä¹ ç¬”è®°"><!--[--><span class="font-icon icon fa-fw fa-sm fas fa-wand-magic-sparkles" style=""></span><!--]-->å­¦ä¹ ç¬”è®°<!----></a></div><div class="vp-nav-item hide-in-mobile"><a class="route-link auto-link" href="/blog/interview-related/" aria-label="é¢è¯•æŒ‡å—"><!--[--><span class="font-icon icon fa-fw fa-sm fas fa-pen-to-square" style=""></span><!--]-->é¢è¯•æŒ‡å—<!----></a></div><div class="vp-nav-item hide-in-mobile"><a class="route-link auto-link" href="/blog/problem-record/" aria-label="æ‚è®°"><!--[--><span class="font-icon icon fa-fw fa-sm fas fa-eye" style=""></span><!--]-->æ‚è®°<!----></a></div><div class="vp-nav-item hide-in-mobile"><a class="route-link auto-link" href="/blog/note-record/" aria-label="ç¬”è®°æ€»ç»“"><!--[--><span class="font-icon icon fa-fw fa-sm fas fa-eye" style=""></span><!--]-->ç¬”è®°æ€»ç»“<!----></a></div><div class="vp-nav-item hide-in-mobile"><a class="route-link auto-link" href="/blog/web3/" aria-label="web3ç³»åˆ—"><!--[--><span class="font-icon icon fa-fw fa-sm fas fa-fire" style=""></span><!--]-->web3ç³»åˆ—<!----></a></div><div class="vp-nav-item hide-in-mobile"><a class="route-link auto-link" href="/blog/vue/" aria-label="Vueç³»åˆ—"><!--[--><span class="font-icon icon fa-fw fa-sm fas fa-fire" style=""></span><!--]-->Vueç³»åˆ—<!----></a></div><div class="vp-nav-item hide-in-mobile"><a class="route-link auto-link" href="/blog/about-the-blogs/" aria-label="åšå®¢ç›¸å…³"><!--[--><span class="font-icon icon fa-fw fa-sm fas fa-blog" style=""></span><!--]-->åšå®¢ç›¸å…³<!----></a></div></nav><!--]--><!----></div><div class="vp-navbar-end"><!----><!--[--><!----><div class="vp-nav-item vp-action"><a class="vp-action-link" href="https://github.com/vuepress-theme-hope/vuepress-theme-hope" target="_blank" rel="noopener noreferrer" aria-label="GitHub"><svg xmlns="http://www.w3.org/2000/svg" class="icon github-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="github icon" name="github" style="width:1.25rem;height:1.25rem;vertical-align:middle;"><path d="M511.957 21.333C241.024 21.333 21.333 240.981 21.333 512c0 216.832 140.544 400.725 335.574 465.664 24.49 4.395 32.256-10.07 32.256-23.083 0-11.69.256-44.245 0-85.205-136.448 29.61-164.736-64.64-164.736-64.64-22.315-56.704-54.4-71.765-54.4-71.765-44.587-30.464 3.285-29.824 3.285-29.824 49.195 3.413 75.179 50.517 75.179 50.517 43.776 75.008 114.816 53.333 142.762 40.79 4.523-31.66 17.152-53.377 31.19-65.537-108.971-12.458-223.488-54.485-223.488-242.602 0-53.547 19.114-97.323 50.517-131.67-5.035-12.33-21.93-62.293 4.779-129.834 0 0 41.258-13.184 134.912 50.346a469.803 469.803 0 0 1 122.88-16.554c41.642.213 83.626 5.632 122.88 16.554 93.653-63.488 134.784-50.346 134.784-50.346 26.752 67.541 9.898 117.504 4.864 129.834 31.402 34.347 50.474 78.123 50.474 131.67 0 188.586-114.73 230.016-224.042 242.09 17.578 15.232 33.578 44.672 33.578 90.454v135.85c0 13.142 7.936 27.606 32.854 22.87C862.25 912.597 1002.667 728.747 1002.667 512c0-271.019-219.648-490.667-490.71-490.667z"></path></svg></a></div><div class="vp-nav-item hide-in-mobile"><button type="button" class="vp-outlook-button" tabindex="-1" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" class="icon outlook-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="outlook icon" name="outlook"><path d="M224 800c0 9.6 3.2 44.8 6.4 54.4 6.4 48-48 76.8-48 76.8s80 41.6 147.2 0 134.4-134.4 38.4-195.2c-22.4-12.8-41.6-19.2-57.6-19.2C259.2 716.8 227.2 761.6 224 800zM560 675.2l-32 51.2c-51.2 51.2-83.2 32-83.2 32 25.6 67.2 0 112-12.8 128 25.6 6.4 51.2 9.6 80 9.6 54.4 0 102.4-9.6 150.4-32l0 0c3.2 0 3.2-3.2 3.2-3.2 22.4-16 12.8-35.2 6.4-44.8-9.6-12.8-12.8-25.6-12.8-41.6 0-54.4 60.8-99.2 137.6-99.2 6.4 0 12.8 0 22.4 0 12.8 0 38.4 9.6 48-25.6 0-3.2 0-3.2 3.2-6.4 0-3.2 3.2-6.4 3.2-6.4 6.4-16 6.4-16 6.4-19.2 9.6-35.2 16-73.6 16-115.2 0-105.6-41.6-198.4-108.8-268.8C704 396.8 560 675.2 560 675.2zM224 419.2c0-28.8 22.4-51.2 51.2-51.2 28.8 0 51.2 22.4 51.2 51.2 0 28.8-22.4 51.2-51.2 51.2C246.4 470.4 224 448 224 419.2zM320 284.8c0-22.4 19.2-41.6 41.6-41.6 22.4 0 41.6 19.2 41.6 41.6 0 22.4-19.2 41.6-41.6 41.6C339.2 326.4 320 307.2 320 284.8zM457.6 208c0-12.8 12.8-25.6 25.6-25.6 12.8 0 25.6 12.8 25.6 25.6 0 12.8-12.8 25.6-25.6 25.6C470.4 233.6 457.6 220.8 457.6 208zM128 505.6C128 592 153.6 672 201.6 736c28.8-60.8 112-60.8 124.8-60.8-16-51.2 16-99.2 16-99.2l316.8-422.4c-48-19.2-99.2-32-150.4-32C297.6 118.4 128 291.2 128 505.6zM764.8 86.4c-22.4 19.2-390.4 518.4-390.4 518.4-22.4 28.8-12.8 76.8 22.4 99.2l9.6 6.4c35.2 22.4 80 12.8 99.2-25.6 0 0 6.4-12.8 9.6-19.2 54.4-105.6 275.2-524.8 288-553.6 6.4-19.2-3.2-32-19.2-32C777.6 76.8 771.2 80 764.8 86.4z"></path></svg><div class="vp-outlook-dropdown"><!----></div></button></div><!----><!--]--><!----><button type="button" class="vp-toggle-navbar-button" aria-label="Toggle Navbar" aria-expanded="false" aria-controls="nav-screen"><span><span class="vp-top"></span><span class="vp-middle"></span><span class="vp-bottom"></span></span></button></div></header><!----><!--]--><!----><div class="toggle-sidebar-wrapper"><span class="arrow start"></span></div><aside id="sidebar" class="vp-sidebar"><!----><ul class="vp-sidebar-links"><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">å¤§å‚é¢è¯•ç¬¬äºŒå­£</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">å¤§å‚é¢è¯•ç¬¬ä¸‰å­£</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">é»‘é©¬Javaå…«è‚¡</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">é»‘é©¬é¢è¯•å®å…¸</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable active" type="button"><!----><span class="vp-sidebar-title">JVM</span><span class="vp-arrow down"></span></button><ul class="vp-sidebar-links"><li><a class="route-link route-link-active auto-link vp-sidebar-link active" href="/blog/study-notes/JVM/" aria-label="JVM"><!---->JVM<!----></a></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">å†…å­˜ä¸åƒåœ¾å›æ”¶ç¯‡</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><span class="font-icon icon fa-fw fa-sm fas fa-edit" style=""></span><span class="vp-sidebar-title">å­—èŠ‚ç ä¸ç±»çš„åŠ è½½ç¯‡</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><span class="font-icon icon fa-fw fa-sm fas fa-edit" style=""></span><span class="vp-sidebar-title">æ€§èƒ½ç›‘æ§ä¸è°ƒä¼˜ç¯‡</span><span class="vp-arrow end"></span></button><!----></section></li></ul></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">è®¡ç®—æœºç½‘ç»œ</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">SpringBoot</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">SpringCloud</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">RocketMQ</span><span class="vp-arrow end"></span></button><!----></section></li><li><a class="route-link auto-link vp-sidebar-link" href="/blog/study-notes/Redis/" aria-label="Redis"><!---->Redis<!----></a></li></ul><!----></aside><!--[--><main id="main-content" class="vp-page"><!--[--><!----><!----><nav class="vp-breadcrumb disable"></nav><div class="vp-page-title"><h1><!---->JVM</h1><div class="page-info"><span class="page-author-info" aria-label="ä½œè€…ğŸ–Š" data-balloon-pos="up"><svg xmlns="http://www.w3.org/2000/svg" class="icon author-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="author icon" name="author"><path d="M649.6 633.6c86.4-48 147.2-144 147.2-249.6 0-160-128-288-288-288s-288 128-288 288c0 108.8 57.6 201.6 147.2 249.6-121.6 48-214.4 153.6-240 288-3.2 9.6 0 19.2 6.4 25.6 3.2 9.6 12.8 12.8 22.4 12.8h704c9.6 0 19.2-3.2 25.6-12.8 6.4-6.4 9.6-16 6.4-25.6-25.6-134.4-121.6-240-243.2-288z"></path></svg><span><a class="page-author-item" href="https://mister-hope.com" target="_blank" rel="noopener noreferrer">æ¨±å®</a></span><span property="author" content="æ¨±å®"></span></span><!----><span class="page-date-info" aria-label="å†™ä½œæ—¥æœŸğŸ“…" data-balloon-pos="up"><svg xmlns="http://www.w3.org/2000/svg" class="icon calendar-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="calendar icon" name="calendar"><path d="M716.4 110.137c0-18.753-14.72-33.473-33.472-33.473-18.753 0-33.473 14.72-33.473 33.473v33.473h66.993v-33.473zm-334.87 0c0-18.753-14.72-33.473-33.473-33.473s-33.52 14.72-33.52 33.473v33.473h66.993v-33.473zm468.81 33.52H716.4v100.465c0 18.753-14.72 33.473-33.472 33.473a33.145 33.145 0 01-33.473-33.473V143.657H381.53v100.465c0 18.753-14.72 33.473-33.473 33.473a33.145 33.145 0 01-33.473-33.473V143.657H180.6A134.314 134.314 0 0046.66 277.595v535.756A134.314 134.314 0 00180.6 947.289h669.74a134.36 134.36 0 00133.94-133.938V277.595a134.314 134.314 0 00-133.94-133.938zm33.473 267.877H147.126a33.145 33.145 0 01-33.473-33.473c0-18.752 14.72-33.473 33.473-33.473h736.687c18.752 0 33.472 14.72 33.472 33.473a33.145 33.145 0 01-33.472 33.473z"></path></svg><span><!----></span><meta property="datePublished" content="2023-03-18T00:00:00.000Z"></span><!----><span class="page-reading-time-info" aria-label="é˜…è¯»æ—¶é—´âŒ›" data-balloon-pos="up"><svg xmlns="http://www.w3.org/2000/svg" class="icon timer-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="timer icon" name="timer"><path d="M799.387 122.15c4.402-2.978 7.38-7.897 7.38-13.463v-1.165c0-8.933-7.38-16.312-16.312-16.312H256.33c-8.933 0-16.311 7.38-16.311 16.312v1.165c0 5.825 2.977 10.874 7.637 13.592 4.143 194.44 97.22 354.963 220.201 392.763-122.204 37.542-214.893 196.511-220.2 389.397-4.661 5.049-7.638 11.651-7.638 19.03v5.825h566.49v-5.825c0-7.379-2.849-13.981-7.509-18.9-5.049-193.016-97.867-351.985-220.2-389.527 123.24-37.67 216.446-198.453 220.588-392.892zM531.16 450.445v352.632c117.674 1.553 211.787 40.778 211.787 88.676H304.097c0-48.286 95.149-87.382 213.728-88.676V450.445c-93.077-3.107-167.901-81.297-167.901-177.093 0-8.803 6.99-15.793 15.793-15.793 8.803 0 15.794 6.99 15.794 15.793 0 80.261 63.69 145.635 142.01 145.635s142.011-65.374 142.011-145.635c0-8.803 6.99-15.793 15.794-15.793s15.793 6.99 15.793 15.793c0 95.019-73.789 172.82-165.96 177.093z"></path></svg><span>å¤§çº¦ 32 åˆ†é’Ÿ</span><meta property="timeRequired" content="PT32M"></span><!----><!----></div><hr></div><div class="vp-toc-placeholder"><aside id="toc"><!----><div class="vp-toc-header">æ­¤é¡µå†…å®¹<button type="button" class="print-button" title="æ‰“å°"><svg xmlns="http://www.w3.org/2000/svg" class="icon print-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="print icon" name="print"><path d="M819.2 364.8h-44.8V128c0-17.067-14.933-32-32-32H281.6c-17.067 0-32 14.933-32 32v236.8h-44.8C145.067 364.8 96 413.867 96 473.6v192c0 59.733 49.067 108.8 108.8 108.8h44.8V896c0 17.067 14.933 32 32 32h460.8c17.067 0 32-14.933 32-32V774.4h44.8c59.733 0 108.8-49.067 108.8-108.8v-192c0-59.733-49.067-108.8-108.8-108.8zM313.6 160h396.8v204.8H313.6V160zm396.8 704H313.6V620.8h396.8V864zM864 665.6c0 25.6-19.2 44.8-44.8 44.8h-44.8V588.8c0-17.067-14.933-32-32-32H281.6c-17.067 0-32 14.933-32 32v121.6h-44.8c-25.6 0-44.8-19.2-44.8-44.8v-192c0-25.6 19.2-44.8 44.8-44.8h614.4c25.6 0 44.8 19.2 44.8 44.8v192z"></path></svg></button><div class="arrow end"></div></div><div class="vp-toc-wrapper"><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#ä»‹ç»">ä»‹ç»</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#ç›®å½•">ç›®å½•</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å†…å­˜ä¸åƒåœ¾å›æ”¶ç¯‡">å†…å­˜ä¸åƒåœ¾å›æ”¶ç¯‡</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#å­—èŠ‚ç ä¸ç±»çš„åŠ è½½ç¯‡">å­—èŠ‚ç ä¸ç±»çš„åŠ è½½ç¯‡</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#æ€§èƒ½ç›‘æ§ä¸è°ƒä¼˜ç¯‡">æ€§èƒ½ç›‘æ§ä¸è°ƒä¼˜ç¯‡</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#_1-jvmä½“ç³»ç»“æ„">1. JVMä½“ç³»ç»“æ„</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#_2-ç±»è£…è½½å™¨-classloader">2. ç±»è£…è½½å™¨ ClassLoader</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_2-1-æœ‰å“ªäº›ç±»è£…è½½å™¨">2.1 æœ‰å“ªäº›ç±»è£…è½½å™¨ï¼Ÿ</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_2-2-åŒäº²å§”æ´¾å’Œæ²™ç®±å®‰å…¨">2.2 åŒäº²å§”æ´¾å’Œæ²™ç®±å®‰å…¨</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#_3-æœ¬åœ°æ–¹æ³•æ ˆ-native-method-stack">3. æœ¬åœ°æ–¹æ³•æ ˆ Native Method Stack</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ä¸ºä»€ä¹ˆæ˜¯native-äº†è§£">ä¸ºä»€ä¹ˆæ˜¯nativeï¼Ÿäº†è§£</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#_4-ç¨‹åºè®¡æ•°å™¨-program-counter-register">4. ç¨‹åºè®¡æ•°å™¨ Program Counter Register</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#_5-æ–¹æ³•åŒº-method-area">5. æ–¹æ³•åŒº Method Area</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#_6-æ ˆ-stack">6. æ ˆ Stack</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_6-1-æ ˆå­˜å‚¨ä»€ä¹ˆæ•°æ®">6.1 æ ˆå­˜å‚¨ä»€ä¹ˆæ•°æ®ï¼Ÿ</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_6-2-æ ˆçš„è¿è¡ŒåŸç†">6.2 æ ˆçš„è¿è¡ŒåŸç†</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_6-3-æ ˆæº¢å‡º-stackoverflowerror">6.3 æ ˆæº¢å‡º StackOverflowError</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#_7-æ ˆã€å †ã€æ–¹æ³•åŒºçš„äº¤äº’å…³ç³»">7. æ ˆã€å †ã€æ–¹æ³•åŒºçš„äº¤äº’å…³ç³»</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#_8-å †-heap">8. å † Heap</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_8-1-å †ä½“ç³»ç»“æ„">8.1 å †ä½“ç³»ç»“æ„</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_8-2-å¯¹è±¡åœ¨å †ä¸­çš„ç”Ÿå‘½å‘¨æœŸ">8.2 å¯¹è±¡åœ¨å †ä¸­çš„ç”Ÿå‘½å‘¨æœŸ</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_8-3-minor-gc-çš„è¿‡ç¨‹">8.3 Minor GC çš„è¿‡ç¨‹</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_8-4-hotspot-è™šæ‹Ÿæœºçš„å†…å­˜ç®¡ç†">8.4 HotSpot è™šæ‹Ÿæœºçš„å†…å­˜ç®¡ç†</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_8-5-æ°¸ä¹…åŒº">8.5 æ°¸ä¹…åŒº</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_8-6-å †å‚æ•°è°ƒä¼˜">8.6 å †å‚æ•°è°ƒä¼˜</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_8-7-å †æº¢å‡º-outofmemoryerror">8.7 å †æº¢å‡º OutOfMemoryError</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#_9-gc-java-garbage-collection">9. GCï¼ˆJava Garbage Collectionï¼‰</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_9-1-gc-åƒåœ¾æ”¶é›†æœºåˆ¶">9.1 GC åƒåœ¾æ”¶é›†æœºåˆ¶</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_9-2-gc-æ—¥å¿—ä¿¡æ¯è¯¦è§£">9.2 GC æ—¥å¿—ä¿¡æ¯è¯¦è§£</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_9-3-gc-å››å¤§ç®—æ³•">9.3 GC å››å¤§ç®—æ³•</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#_0-å¦‚ä½•åˆ¤æ–­javaä¸­å¯¹è±¡æ˜¯å¦å­˜æ´»">0. å¦‚ä½•åˆ¤æ–­Javaä¸­å¯¹è±¡æ˜¯å¦å­˜æ´»ï¼Ÿ</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_0-1-å¼•ç”¨è®¡æ•°ç®—æ³•">0.1 å¼•ç”¨è®¡æ•°ç®—æ³•</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_0-2-æ ¹æœç´¢æ–¹æ³•">0.2 æ ¹æœç´¢æ–¹æ³•</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#_1-å¤åˆ¶ç®—æ³•-copying-é€‚ç”¨äºæ–°ç”Ÿä»£">1. å¤åˆ¶ç®—æ³•ï¼ˆCopyingï¼‰ï¼šé€‚ç”¨äºæ–°ç”Ÿä»£</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_1-1-åŸç†åˆ†æ">1.1 åŸç†åˆ†æ</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_1-2-ä¼˜ç¼ºç‚¹">1.2 ä¼˜ç¼ºç‚¹</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#_2-æ ‡è®°æ¸…é™¤-mark-sweep-é€‚ç”¨äºè€å¹´ä»£">2. æ ‡è®°æ¸…é™¤ï¼ˆMark-Sweepï¼‰ï¼šé€‚ç”¨äºè€å¹´ä»£</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_2-1-åŸç†åˆ†æ">2.1 åŸç†åˆ†æ</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_2-2-ä¼˜ç¼ºç‚¹">2.2 ä¼˜ç¼ºç‚¹</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#_3-æ ‡è®°å‹ç¼©-mark-compact-é€‚ç”¨äºè€å¹´ä»£">3. æ ‡è®°å‹ç¼©ï¼ˆMark-Compactï¼‰ï¼šé€‚ç”¨äºè€å¹´ä»£</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_3-1-åŸç†åˆ†æ">3.1 åŸç†åˆ†æ</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_3-2-ä¼˜ç¼ºç‚¹">3.2 ä¼˜ç¼ºç‚¹</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_3-3-æ ‡è®°æ¸…é™¤å‹ç¼©-mark-sweep-compact">3.3 æ ‡è®°æ¸…é™¤å‹ç¼©ï¼ˆMark-Sweep-Compactï¼‰</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#_4-åˆ†ä»£æ”¶é›†ç®—æ³•">4. åˆ†ä»£æ”¶é›†ç®—æ³•</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#_5-æ€»ç»“">5. æ€»ç»“</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_5-1-å¹´è½»ä»£-young-gen">5.1 å¹´è½»ä»£ï¼ˆYoung Genï¼‰</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_5-2-è€å¹´ä»£-tenure-gen">5.2 è€å¹´ä»£ï¼ˆTenure Genï¼‰</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#_6-é™„å½•-å¸¸è§é¢è¯•é—®é¢˜">6. é™„å½•.å¸¸è§é¢è¯•é—®é¢˜</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_6-1-gcå››ç§ç®—æ³•å“ªä¸ªå¥½">6.1 GCå››ç§ç®—æ³•å“ªä¸ªå¥½ï¼Ÿ</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_6-2-è¯·è¯´å‡ºå„ä¸ªåƒåœ¾å›æ”¶ç®—æ³•çš„ä¼˜ç¼ºç‚¹">6.2 è¯·è¯´å‡ºå„ä¸ªåƒåœ¾å›æ”¶ç®—æ³•çš„ä¼˜ç¼ºç‚¹</a></li><!----><!--]--></ul></li><!--]--></ul><div class="vp-toc-marker" style="top:-1.7rem;"></div></div><!----></aside></div><!----><div class="theme-hope-content"><h2 id="ä»‹ç»" tabindex="-1"><a class="header-anchor" href="#ä»‹ç»"><span>ä»‹ç»</span></a></h2><div class="hint-container tip"><p class="hint-container-title">æç¤º</p><p>è¯¥æ–‡ç« åŒ…å«JVMåŸºç¡€å…¥é—¨ç¯‡å…¨éƒ¨å†…å®¹ä»¥åŠå®‹çº¢åº·è€å¸ˆJVMæ•™ç¨‹å…¨å¥—ç¬”è®°ã€‚ æ¥æºBilibiliå°šç¡…è°·å®‹çº¢åº·è€å¸ˆJVMæ•™ç¨‹ï¼š<a href="https://www.bilibili.com/video/BV1PJ411n7xZ" target="_blank" rel="noopener noreferrer">ç¡…è°·2020æœ€æ–°ç‰ˆå®‹çº¢åº·JVMæ•™ç¨‹</a><br> ç¬”è®°è¡¥å……ï¼šhttps://gitee.com/vectorx/NOTE_JVM/tree/main , https://www.yuque.com/u21195183/jvm</p><p>æœ€ç»†è‡´çš„JVMè®²è§£ï¼ˆæ›´å¤šå¯å‚è€ƒä¹¦ç±ï¼‰</p><p>åŸºç¡€å…¥é—¨è§†é¢‘ï¼šhttps://www.bilibili.com/video/BV1jJ411t71s?p=1&amp;vd_source=7138dfc78c49f602f8d3ed8cfbf0513d</p></div><h2 id="ç›®å½•" tabindex="-1"><a class="header-anchor" href="#ç›®å½•"><span>ç›®å½•</span></a></h2><h3 id="å†…å­˜ä¸åƒåœ¾å›æ”¶ç¯‡" tabindex="-1"><a class="header-anchor" href="#å†…å­˜ä¸åƒåœ¾å›æ”¶ç¯‡"><span>å†…å­˜ä¸åƒåœ¾å›æ”¶ç¯‡</span></a></h3><ul><li><a class="route-link" href="/blog/study-notes/JVM/Memory-GC/Java-Architecture/">JVMä¸Javaä½“ç³»ç»“æ„</a></li><li><a class="route-link" href="/blog/study-notes/JVM/Memory-GC/Clas-Loading-Subsystem/">ç±»åŠ è½½å­ç³»ç»Ÿ</a></li><li><a class="route-link" href="/blog/study-notes/JVM/Memory-GC/JVM-RuntimeDataAreas/">è¿è¡Œæ—¶æ•°æ®åŒºæ¦‚è¿°åŠçº¿ç¨‹</a></li><li><a class="route-link" href="/blog/study-notes/JVM/Memory-GC/PCounter-Register/">ç¨‹åºè®¡æ•°å™¨</a></li><li><a class="route-link" href="/blog/study-notes/JVM/Memory-GC/JVM-Stack/">è™šæ‹Ÿæœºæ ˆ</a></li><li><a class="route-link" href="/blog/study-notes/JVM/Memory-GC/Native-Stack/">æœ¬åœ°æ–¹æ³•æ¥å£å’Œæœ¬åœ°æ–¹æ³•æ ˆ</a></li><li><a class="route-link" href="/blog/study-notes/JVM/Memory-GC/Heap/">å †</a></li><li><a class="route-link" href="/blog/study-notes/JVM/Memory-GC/Method-Area/">æ–¹æ³•åŒº</a></li><li><a class="route-link" href="/blog/study-notes/JVM/Memory-GC/Object-Instantiation/">å¯¹è±¡å®ä¾‹åŒ–å†…å­˜å¸ƒå±€ä¸è®¿é—®å®šä½</a></li><li><a class="route-link" href="/blog/study-notes/JVM/Memory-GC/Direct-Memory/">ç›´æ¥å†…å­˜</a></li><li><a class="route-link" href="/blog/study-notes/JVM/Memory-GC/Execution-Engine/">æ‰§è¡Œå¼•æ“</a></li><li><a class="route-link" href="/blog/study-notes/JVM/Memory-GC/StringTable/">StringTable</a></li><li><a class="route-link" href="/blog/study-notes/JVM/Memory-GC/GC-Overview/">åƒåœ¾å›æ”¶æ¦‚è¿°</a></li><li><a class="route-link" href="/blog/study-notes/JVM/Memory-GC/GC-Relevant-Algorithms/">åƒåœ¾å›æ”¶ç›¸å…³ç®—æ³•</a></li><li><a class="route-link" href="/blog/study-notes/JVM/Memory-GC/GC-Relevant-Overview/">åƒåœ¾å›æ”¶ç›¸å…³æ¦‚å¿µ</a></li><li><a class="route-link" href="/blog/study-notes/JVM/Memory-GC/GC-Period/">åƒåœ¾å›æ”¶å™¨</a></li></ul><h2 id="å­—èŠ‚ç ä¸ç±»çš„åŠ è½½ç¯‡" tabindex="-1"><a class="header-anchor" href="#å­—èŠ‚ç ä¸ç±»çš„åŠ è½½ç¯‡"><span>å­—èŠ‚ç ä¸ç±»çš„åŠ è½½ç¯‡</span></a></h2><ul><li><a class="route-link" href="/blog/study-notes/JVM/Bytecode-ClassLoading/Class-File-Structure/">classæ–‡ä»¶ç»“æ„</a></li><li><a class="route-link" href="/blog/study-notes/JVM/Bytecode-ClassLoading/Bytecode-Instruction-Set/">å­—èŠ‚ç æŒ‡ä»¤é›†</a></li><li><a class="route-link" href="/blog/study-notes/JVM/Bytecode-ClassLoading/Class-Lifecycle/">ç±»çš„åŠ è½½è¿‡ç¨‹ï¼ˆç±»çš„ç”Ÿå‘½å‘¨æœŸï¼‰è¯¦è§£</a></li><li><a class="route-link" href="/blog/study-notes/JVM/Bytecode-ClassLoading/Class-Lifecycle2/">å†è°ˆç±»çš„åŠ è½½å™¨</a></li></ul><h2 id="æ€§èƒ½ç›‘æ§ä¸è°ƒä¼˜ç¯‡" tabindex="-1"><a class="header-anchor" href="#æ€§èƒ½ç›‘æ§ä¸è°ƒä¼˜ç¯‡"><span>æ€§èƒ½ç›‘æ§ä¸è°ƒä¼˜ç¯‡</span></a></h2><ul><li><a class="route-link" href="/blog/study-notes/JVM/Performance-Monitoring-Tuning/JVM-Overview/">æ¦‚è¿°</a></li><li><a class="route-link" href="/blog/study-notes/JVM/Performance-Monitoring-Tuning/JVM-Monitoring-Diagnostic-Tools/">JVMç›‘æ§åŠè¯Šæ–­å·¥å…·-å‘½ä»¤è¡Œç¯‡</a></li><li><a class="route-link" href="/blog/study-notes/JVM/Performance-Monitoring-Tuning/JVM-Monitoring-Diagnostic-Tools-GUI/">JVMç›‘æ§åŠè¯Šæ–­å·¥å…·-GUIç¯‡</a></li><li><a class="route-link" href="/blog/study-notes/JVM/Performance-Monitoring-Tuning/JVM-Runtime-Parameters/">JVMè¿è¡Œæ—¶å‚æ•°</a></li><li><a class="route-link" href="/blog/study-notes/JVM/Performance-Monitoring-Tuning/GC-Log/">åˆ†æGCæ—¥å¿—</a></li><li><a class="route-link" href="/blog/study-notes/JVM/Performance-Monitoring-Tuning/OQL/">ä½¿ç”¨OQLè¯­è¨€æŸ¥è¯¢å¯¹è±¡ä¿¡æ¯</a></li><li><a class="route-link" href="/blog/study-notes/JVM/Performance-Monitoring-Tuning/Heap-Memory-Leak/">æµ…å †æ·±å †ä¸å†…å­˜æ³„éœ²</a></li></ul><h1 id="ä»¥ä¸‹ä¸ºåŸºç¡€å…¥é—¨ç¯‡" tabindex="-1"><a class="header-anchor" href="#ä»¥ä¸‹ä¸ºåŸºç¡€å…¥é—¨ç¯‡"><span>ä»¥ä¸‹ä¸ºåŸºç¡€å…¥é—¨ç¯‡</span></a></h1><h2 id="_1-jvmä½“ç³»ç»“æ„" tabindex="-1"><a class="header-anchor" href="#_1-jvmä½“ç³»ç»“æ„"><span>1. JVMä½“ç³»ç»“æ„</span></a></h2><p>é¦–å…ˆï¼Œæˆ‘ä»¬æ¥äº†è§£ JVM çš„ä½ç½®ï¼Œå¦‚ä¸‹å›¾ï¼ŒJVM æ˜¯è¿è¡Œåœ¨æ“ä½œç³»ç»Ÿä¹‹ä¸Šçš„ï¼Œå®ƒä¸ç¡¬ä»¶æ²¡æœ‰ç›´æ¥äº¤äº’ã€‚<br><img src="/blog/assets/img/20200721212102560.8a276b03.png" alt="20200721212102560.png" loading="lazy"><br> æ¥ä¸‹æ¥æ˜¯ JVM çš„æ•´ä¸ªä½“ç³»ç»“æ„å›¾ï¼š</p><p><img src="/blog/assets/img/image-20200704183436495.f9fe6b9d.png" alt="image-20200704183436495.png" loading="lazy"> ç„¶åï¼Œæˆ‘ä»¬æ ¹æ® JVM ä½“ç³»ç»“æ„å›¾æ¥é˜è¿°ç›¸å…³çš„çŸ¥è¯†ç‚¹ã€‚</p><h2 id="_2-ç±»è£…è½½å™¨-classloader" tabindex="-1"><a class="header-anchor" href="#_2-ç±»è£…è½½å™¨-classloader"><span>2. ç±»è£…è½½å™¨ ClassLoader</span></a></h2><p><strong>ç±»è£…è½½å™¨ ClassLoader</strong> æ˜¯è´Ÿè´£åŠ è½½<code>class</code>æ–‡ä»¶çš„ï¼Œå°†<code>class</code>æ–‡ä»¶å­—èŠ‚ç å†…å®¹åŠ è½½åˆ°å†…å­˜ä¸­ï¼Œå¹¶å°†è¿™äº›å†…å®¹è½¬æ¢æˆæ–¹æ³•åŒºä¸­çš„è¿è¡Œæ—¶æ•°æ®ç»“æ„ã€‚<code>ClassLoader</code>åªè´Ÿè´£æ–‡ä»¶çš„åŠ è½½ï¼Œè‡³äºå®ƒæ˜¯å¦å¯è¿è¡Œï¼Œåˆ™ç”±<code>Execution Engine</code>å†³å®šã€‚</p><p>åœ¨è¿™é‡Œéœ€è¦åŒºåˆ†ä¸€ä¸‹<code>class</code>ä¸<code>Class</code>ã€‚å°å†™çš„<code>class</code>ï¼Œæ˜¯æŒ‡ç¼–è¯‘ Java ä»£ç åæ‰€ç”Ÿæˆçš„ä»¥<code>.class</code>ä¸ºåç¼€åçš„å­—èŠ‚ç æ–‡ä»¶ã€‚è€Œå¤§å†™çš„<code>Class</code>ï¼Œæ˜¯ JDK æä¾›çš„<code>java.lang.Class</code>ï¼Œå¯ä»¥ç†è§£ä¸ºå°è£…ç±»çš„æ¨¡æ¿ã€‚å¤šç”¨äºåå°„åœºæ™¯ï¼Œä¾‹å¦‚ JDBC ä¸­çš„åŠ è½½é©±åŠ¨ï¼Œ<code>Class.forName(&quot;com.mysql.jdbc.Driver&quot;);</code></p><p>æ¥ä¸‹æ¥æˆ‘ä»¬æ¥è§‚å¯Ÿä¸‹å›¾ï¼Œ<code>Car.class</code>å­—èŠ‚ç æ–‡ä»¶è¢«<code>ClassLoader</code>ç±»è£…è½½å™¨åŠ è½½å¹¶åˆå§‹åŒ–ï¼Œåœ¨æ–¹æ³•åŒºä¸­ç”Ÿæˆäº†ä¸€ä¸ª<code>Car Class</code>çš„ç±»æ¨¡æ¿ï¼Œè€Œæˆ‘ä»¬å¹³æ—¶æ‰€ç”¨åˆ°çš„å®ä¾‹åŒ–ï¼Œå°±æ˜¯åœ¨è¿™ä¸ªç±»æ¨¡æ¿çš„åŸºç¡€ä¸Šï¼Œå½¢æˆäº†ä¸€ä¸ªä¸ªå®ä¾‹ï¼Œå³<code>car1</code>ï¼Œ<code>car2</code>ã€‚åè¿‡æ¥è®²ï¼Œæˆ‘ä»¬å¯ä»¥å¯¹æŸä¸ªå…·ä½“çš„å®ä¾‹è¿›è¡Œ<code>getClass()</code>æ“ä½œï¼Œå°±å¯ä»¥å¾—åˆ°è¯¥å®ä¾‹çš„ç±»æ¨¡æ¿ï¼Œå³<code>Car Class</code>ã€‚å†æ¥ç€ï¼Œæˆ‘ä»¬å¯¹è¿™ä¸ªç±»æ¨¡æ¿è¿›è¡Œ<code>getClassLoader()</code>æ“ä½œï¼Œå°±å¯ä»¥å¾—åˆ°è¿™ä¸ªç±»æ¨¡æ¿æ˜¯ç”±å“ªä¸ªç±»è£…è½½å™¨è¿›è¡ŒåŠ è½½çš„ã€‚ <img src="/blog/assets/img/20200721213332630.c457acec.png" alt="20200721213332630.png" loading="lazy"></p><blockquote><p>Tipï¼šæ‰©å±•ä¸€ä¸‹ï¼ŒJVM å¹¶ä¸ä»…ä»…åªæ˜¯é€šè¿‡æ£€æŸ¥æ–‡ä»¶åç¼€åæ˜¯å¦æ˜¯<code>.class</code>æ¥åˆ¤æ–­æ˜¯å¦åŠ è½½ï¼Œæœ€ä¸»è¦çš„æ˜¯é€šè¿‡<code>class</code>æ–‡ä»¶ä¸­ç‰¹å®šçš„æ–‡ä»¶æ ‡ç¤ºï¼Œå³ä¸‹å›¾<code>test.class</code>æ–‡ä»¶ä¸­çš„<code>cafe babe</code>ã€‚ <img src="/blog/assets/img/20200721214933626.f125163d.png" alt="20200721214933626.png" loading="lazy"></p></blockquote><h3 id="_2-1-æœ‰å“ªäº›ç±»è£…è½½å™¨" tabindex="-1"><a class="header-anchor" href="#_2-1-æœ‰å“ªäº›ç±»è£…è½½å™¨"><span>2.1 æœ‰å“ªäº›ç±»è£…è½½å™¨ï¼Ÿ</span></a></h3><p><strong>ï¼ˆ1ï¼‰è™šæ‹Ÿæœºè‡ªå¸¦çš„åŠ è½½å™¨</strong></p><ol><li>å¯åŠ¨ç±»åŠ è½½å™¨ï¼ˆBootstrapï¼‰ï¼Œä¹Ÿå«æ ¹åŠ è½½å™¨ï¼ŒåŠ è½½<code>%JAVAHOME%/jre/lib/rt.jar</code>ã€‚</li><li>æ‰©å±•ç±»åŠ è½½å™¨ï¼ˆExtensionï¼‰ï¼ŒåŠ è½½<code>%JAVAHOME%/jre/lib/ext/*.jar</code>ï¼Œä¾‹å¦‚<code>javax.swing</code>åŒ…ã€‚</li><li>åº”ç”¨ç¨‹åºç±»åŠ è½½å™¨ï¼ˆAppClassLoaderï¼‰ï¼Œä¹Ÿå«ç³»ç»Ÿç±»åŠ è½½å™¨ï¼ŒåŠ è½½<code>%CLASSPATH%</code>çš„æ‰€æœ‰ç±»ã€‚</li></ol><p><strong>ï¼ˆ2ï¼‰ç”¨æˆ·è‡ªå®šä¹‰çš„åŠ è½½å™¨</strong> ï¼šç”¨æˆ·å¯ä»¥è‡ªå®šä¹‰ç±»çš„åŠ è½½æ–¹å¼ï¼Œä½†å¿…é¡»æ˜¯<code>Java.lang.ClassLoader</code>çš„å­ç±»ã€‚<br><img src="/blog/assets/img/20200722134405251.22505f67.png" alt="20200722134405251.png" loading="lazy"></p><h3 id="_2-2-åŒäº²å§”æ´¾å’Œæ²™ç®±å®‰å…¨" tabindex="-1"><a class="header-anchor" href="#_2-2-åŒäº²å§”æ´¾å’Œæ²™ç®±å®‰å…¨"><span>2.2 åŒäº²å§”æ´¾å’Œæ²™ç®±å®‰å…¨</span></a></h3><p>æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬é€šè¿‡ä¸‹é¢ä»£ç æ¥è§‚å¯Ÿè¿™å‡ ä¸ªç±»åŠ è½½å™¨ã€‚é¦–å…ˆï¼Œæˆ‘ä»¬å…ˆçœ‹è‡ªå®šä¹‰çš„<code>MyObject</code>ï¼Œé¦–å…ˆé€šè¿‡<code>getClassLoader()</code>è·å–åˆ°çš„æ˜¯<code>AppClassLoader</code>ï¼Œç„¶å<code>getParent()</code>å¾—åˆ°<code>ExtClassLoader</code>ï¼Œå†<code>getParent()</code>ç«Ÿç„¶æ˜¯<code>null</code>ï¼Ÿå¯èƒ½å¤§å®¶ä¼šæœ‰ç–‘æƒ‘ï¼Œä¸åº”è¯¥æ˜¯ Bootstrap åŠ è½½å™¨ä¹ˆï¼Ÿ<strong>è¿™æ˜¯å› ä¸ºï¼Œ<code>BootstrapClassLoader</code>æ˜¯ä½¿ç”¨ C++è¯­è¨€ç¼–å†™çš„ï¼ŒJava åœ¨åŠ è½½çš„æ—¶å€™å°±æˆäº† nullã€‚</strong></p><p>æˆ‘ä»¬å†æ¥çœ‹ Java è‡ªå¸¦çš„<code>Object</code>ï¼Œé€šè¿‡<code>getClassLoader()</code>è·å–åˆ°çš„åŠ è½½å™¨ç›´æ¥å°±æ˜¯<code>BootstrapClassLoader</code>ï¼Œå¦‚æœè¦æƒ³<code>getParent()</code>çš„è¯ï¼Œå› ä¸ºæ˜¯ null å€¼ï¼Œæ‰€ä»¥å°±ä¼šæŠ¥<code>java.lang.NullPointerException</code>ç©ºæŒ‡é’ˆå¼‚å¸¸ã€‚<br><img src="/blog/assets/img/20200722131041957.d7694a63.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" loading="lazy"></p><blockquote><p>è¾“å‡ºä¸­ï¼Œ<code>sun.misc.Launcher</code>æ˜¯ JVM ç›¸å…³è°ƒç”¨çš„å…¥å£ç¨‹åºã€‚</p></blockquote><p>é‚£ä¸ºä»€ä¹ˆä¼šå‡ºç°è¿™ä¸ªæƒ…å†µå‘¢ï¼Ÿè¿™å°±éœ€è¦æˆ‘ä»¬æ¥äº†è§£ç±»åŠ è½½å™¨çš„åŠ è½½é¡ºåºå’Œæœºåˆ¶äº†ï¼Œå³<strong>åŒäº²å§”æ´¾</strong>å’Œ<strong>æ²™ç®±å®‰å…¨</strong> ã€‚</p><p><strong>ï¼ˆ1ï¼‰åŒäº²å§”æ´¾</strong>ï¼Œå½“ä¸€ä¸ªç±»æ”¶åˆ°äº†ç±»åŠ è½½è¯·æ±‚ï¼Œå®ƒé¦–å…ˆä¸ä¼šå°è¯•è‡ªå·±å»åŠ è½½è¿™ä¸ªç±»ï¼Œè€Œæ˜¯æŠŠè¿™ä¸ªè¯·æ±‚å§”æ´¾ç»™çˆ¶ç±»å»å®Œæˆï¼Œå› æ­¤æ‰€æœ‰çš„åŠ è½½è¯·æ±‚éƒ½åº”è¯¥ä¼ é€åˆ°å¯åŠ¨ç±»åŠ è½½å™¨ä¸­ï¼Œåªæœ‰å½“çˆ¶ç±»åŠ è½½å™¨åé¦ˆè‡ªå·±æ— æ³•å®Œæˆè¿™ä¸ªè¯·æ±‚çš„æ—¶å€™ï¼ˆåœ¨å®ƒçš„åŠ è½½è·¯å¾„ä¸‹æ²¡æœ‰æ‰¾åˆ°æ‰€éœ€åŠ è½½çš„<code>Class</code>ï¼‰ï¼Œå­ç±»åŠ è½½å™¨æ‰ä¼šå°è¯•è‡ªå·±å»åŠ è½½ã€‚</p><p>é‡‡ç”¨åŒäº²å§”æ´¾çš„ä¸€ä¸ªå¥½å¤„æ˜¯ï¼Œæ¯”å¦‚åŠ è½½ä½äº<code>rt.jar</code>åŒ…ä¸­çš„ç±»<code>java.lang.Object</code>ï¼Œä¸ç®¡æ˜¯å“ªä¸ªåŠ è½½å™¨åŠ è½½è¿™ä¸ªç±»ï¼Œæœ€ç»ˆéƒ½æ˜¯å§”æ´¾ç»™é¡¶å±‚çš„å¯åŠ¨ç±»åŠ è½½å™¨è¿›è¡ŒåŠ è½½ï¼Œç¡®ä¿å“ªæ€•ä½¿ç”¨äº†ä¸åŒçš„ç±»åŠ è½½å™¨ï¼Œæœ€ç»ˆå¾—åˆ°çš„éƒ½æ˜¯åŒæ ·ä¸€ä¸ª<code>Object</code>å¯¹è±¡ã€‚</p><p><strong>ï¼ˆ2ï¼‰æ²™ç®±å®‰å…¨æœºåˆ¶</strong>ï¼Œæ˜¯åŸºäºåŒäº²å§”æ´¾æœºåˆ¶ä¸Šé‡‡å–çš„ä¸€ç§ JVM çš„è‡ªæˆ‘ä¿æŠ¤æœºåˆ¶ï¼Œå‡è®¾ä½ è¦å†™ä¸€ä¸ª<code>java.lang.String</code>çš„ç±»ï¼Œç”±äºåŒäº²å§”æ´¾æœºåˆ¶çš„åŸç†ï¼Œæ­¤è¯·æ±‚ä¼šå…ˆäº¤ç»™<code>BootStrapClassLoader</code>è¯•å›¾è¿›è¡ŒåŠ è½½ï¼Œä½†æ˜¯<code>BootStrapClassLoader</code>åœ¨åŠ è½½ç±»æ—¶é¦–å…ˆé€šè¿‡åŒ…å’Œç±»åæŸ¥æ‰¾<code>rt.jar</code>ä¸­æœ‰æ²¡æœ‰è¯¥ç±»ï¼Œæœ‰åˆ™ä¼˜å…ˆåŠ è½½<code>rt.jar</code>åŒ…ä¸­çš„ç±»ï¼Œ<strong>å› æ­¤å°±ä¿è¯äº† java çš„è¿è¡Œæœºåˆ¶ä¸ä¼šè¢«ç ´åï¼Œç¡®ä¿ä½ çš„ä»£ç ä¸ä¼šæ±¡æŸ“åˆ° Java çš„æºç </strong>ã€‚</p><p><strong>æ‰€ä»¥ï¼Œç±»åŠ è½½å™¨çš„åŠ è½½é¡ºåºå¦‚ä¸‹ï¼š</strong></p><ol><li>å½“<code>AppClassLoader</code>åŠ è½½ä¸€ä¸ª<code>class</code>æ—¶ï¼Œå®ƒé¦–å…ˆä¸ä¼šè‡ªå·±å»å°è¯•åŠ è½½è¿™ä¸ªç±»ï¼Œè€Œæ˜¯æŠŠç±»åŠ è½½è¯·æ±‚å§”æ´¾ç»™çˆ¶ç±»åŠ è½½å™¨<code>ExtClassLoader</code>å»å®Œæˆã€‚</li><li>å½“<code>ExtClassLoader</code>åŠ è½½ä¸€ä¸ª<code>class</code>æ—¶ï¼Œå®ƒé¦–å…ˆä¹Ÿä¸ä¼šè‡ªå·±å»å°è¯•åŠ è½½è¿™ä¸ªç±»ï¼Œè€Œæ˜¯æŠŠç±»åŠ è½½è¯·æ±‚å§”æ´¾ç»™<code>BootStrapClassLoader</code>å»å®Œæˆã€‚</li><li>å¦‚æœ<code>BootStrapClassLoader</code>åŠ è½½å¤±è´¥ï¼ˆä¾‹å¦‚åœ¨<code>$JAVA_HOME/jre/lib</code>é‡ŒæœªæŸ¥æ‰¾åˆ°è¯¥<code>class</code>ï¼‰ï¼Œä¼šä½¿ç”¨<code>ExtClassLoader</code>æ¥å°è¯•åŠ è½½ã€‚</li><li>è‹¥<code>ExtClassLoader</code>ä¹ŸåŠ è½½å¤±è´¥ï¼Œåˆ™ä¼šä½¿ç”¨<code>AppClassLoader</code>æ¥åŠ è½½ï¼Œå¦‚æœ<code>AppClassLoader</code>ä¹ŸåŠ è½½å¤±è´¥ï¼Œåˆ™ä¼šæŠ¥å‡ºå¼‚å¸¸<code>ClassNotFoundException</code>ã€‚</li></ol><blockquote><p>Tipï¼š<code>rt.jar</code>æ˜¯ä»€ä¹ˆï¼Ÿåšäº†å“ªäº›äº‹ï¼Ÿè¿™äº›æš‚ä¸”ä¸æï¼Œé‚£ä½ æœ‰æ²¡æœ‰æƒ³è¿‡ï¼Œä¸ºä»€ä¹ˆå¯ä»¥åœ¨ idea è¿™äº›å¼€å‘å·¥å…·ä¸­å¯ä»¥ç›´æ¥å»ä½¿ç”¨ Stringã€ArrayListã€ç”šè‡³ä¸€äº› JDK æä¾›çš„ç±»å’Œæ–¹æ³•ï¼Ÿè§‚å¯Ÿä¸‹é¢åŠ¨å›¾å°±å¯ä»¥çŸ¥é“ï¼ŒåŸæ¥è¿™äº›éƒ½åœ¨<code>rt.jar</code>ä¸­å®šä¹‰å¥½äº†ï¼Œä¸”ç›´æ¥è¢«å¯åŠ¨ç±»åŠ è½½å™¨è¿›è¡ŒåŠ è½½äº†ã€‚<br><img src="/blog/assets/img/20200722130535525.f1787785.gif" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" loading="lazy"></p></blockquote><h2 id="_3-æœ¬åœ°æ–¹æ³•æ ˆ-native-method-stack" tabindex="-1"><a class="header-anchor" href="#_3-æœ¬åœ°æ–¹æ³•æ ˆ-native-method-stack"><span>3. æœ¬åœ°æ–¹æ³•æ ˆ Native Method Stack</span></a></h2><p><strong>æœ¬åœ°æ–¹æ³•æ¥å£ï¼ˆNative Interfaceï¼‰</strong>ï¼Œå…¶ä½œç”¨æ˜¯èåˆä¸åŒçš„ç¼–ç¨‹è¯­è¨€ä¸º Java æ‰€ç”¨ï¼Œå®ƒçš„åˆè¡·æ˜¯ç”¨æ¥èåˆ C/C++ ç¨‹åºçš„ï¼ŒJava è¯ç”Ÿçš„æ—¶å€™æ˜¯ C/C++ æµè¡Œæ—¶æœŸï¼Œè¦æƒ³ç«‹è¶³ï¼Œå°±å¾—è°ƒç”¨ C/C++ ç¨‹åºï¼Œäºæ˜¯ Java<br> å°±åœ¨å†…å­˜ä¸­ä¸“é—¨å¼€è¾Ÿäº†ä¸€å—åŒºåŸŸå¤„ç†æ ‡è®°ä¸º native çš„ä»£ç ã€‚</p><p>è€Œ<strong>æœ¬åœ°æ–¹æ³•æ ˆï¼ˆNative Method Stackï¼‰</strong>ï¼Œå°±æ˜¯åœ¨ä¸€ä¸ª Stack ä¸­ç™»è®°è¿™äº› native æ–¹æ³•ï¼Œç„¶ååœ¨æ‰§è¡Œå¼•æ“<code>Execution Engine</code>æ‰§è¡Œæ—¶åŠ è½½æœ¬åœ°æ–¹æ³•åº“<code>native libraies</code>ã€‚</p><p>æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬é€šè¿‡ä¸‹å›¾çš„å¤šçº¿ç¨‹éƒ¨åˆ†æºç æ¥ç†è§£ä»€ä¹ˆæ˜¯<code>native</code>æ–¹æ³•ã€‚é¦–å…ˆæˆ‘ä»¬è§‚å¯Ÿ<code>start()</code>çš„æºç ï¼Œå‘ç°å®ƒå…¶å®å¹¶æ²¡æœ‰åšä»€ä¹ˆå¤æ‚çš„æ“ä½œï¼Œåªæ˜¯å•çº¯çš„è°ƒç”¨äº†<code>start0()</code>è¿™ä¸ªæ–¹æ³•ï¼Œç„¶åæˆ‘ä»¬å»è§‚å¯Ÿ<code>start0()</code>çš„æºç ï¼Œå‘ç°å®ƒåªæ˜¯ä¸€ä¸ªä½¿ç”¨äº†<code>native</code>å…³é”®å­—ä¿®é¥°çš„ä¸€ä¸ªæ–¹æ³•ï¼ˆ<code>private native void start0();</code>ï¼‰ï¼Œä½†<strong>åªæœ‰å£°æ˜å´æ²¡æœ‰å…·ä½“çš„å®ç°ï¼</strong>ã€‚<br><img src="/blog/assets/img/20200722151311154.fdf9a57f.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" loading="lazy"><br> ä¸ºä»€ä¹ˆï¼Ÿæˆ‘ä»¬éƒ½çŸ¥é“<code>Thread</code>æ˜¯<code>Class</code>å…³é”®å­—ä¿®é¥°çš„ç±»ï¼ˆ<code>class Thread implements Runnable</code>ï¼‰ï¼Œè€Œä¸æ˜¯æ¥å£ã€‚ä¸€èˆ¬æ¥è¯´ï¼Œç±»ä¸­çš„æ–¹æ³•éƒ½è¦æœ‰å®šä¹‰å’Œå®ç°ï¼Œæ¥å£é‡Œé¢æ‰æœ‰æ–¹æ³•çš„å®šä¹‰å£°æ˜ã€‚è¿™å°±æ˜¯<code>native</code>æ–¹æ³•çš„ç‹¬ç‰¹ä¹‹å¤„ï¼Œè¯´ç™½äº†ï¼Œ<code>è¢«nativeå…³é”®å­—ä¿®é¥°çš„æ–¹æ³•ï¼ŒåŸºæœ¬ä¸Šå’Œæˆ‘ä»¬ï¼Œç”šè‡³å’Œ Java éƒ½æ²¡å•¥å…³ç³»äº†ï¼Œå› ä¸ºå®ƒè¦å»è°ƒç”¨åº•å±‚æ“ä½œç³»ç»Ÿæˆ–è€…ç¬¬ä¸‰æ–¹è¯­è¨€çš„åº“å‡½æ•°ï¼Œæ‰€ä»¥æˆ‘ä»¬ä¸éœ€è¦å»è€ƒè™‘å®ƒå…·ä½“æ˜¯å¦‚ä½•å®ç°çš„ã€‚</code></p><h3 id="ä¸ºä»€ä¹ˆæ˜¯native-äº†è§£" tabindex="-1"><a class="header-anchor" href="#ä¸ºä»€ä¹ˆæ˜¯native-äº†è§£"><span>ä¸ºä»€ä¹ˆæ˜¯nativeï¼Ÿäº†è§£</span></a></h3><div class="language-dockerfile line-numbers-mode" data-highlighter="shiki" data-ext="dockerfile" data-title="dockerfile" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">Native Interfaceæœ¬åœ°æ¥å£</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">æœ¬åœ°æ¥å£çš„ä½œç”¨æ˜¯èåˆä¸åŒçš„ç¼–ç¨‹è¯­è¨€ä¸º Java æ‰€ç”¨ï¼Œå®ƒçš„åˆè¡·æ˜¯èåˆ C/C++ç¨‹åºï¼ŒJava è¯ç”Ÿçš„æ—¶å€™æ˜¯ C/C++æ¨ªè¡Œçš„æ—¶å€™ï¼Œè¦æƒ³ç«‹è¶³ï¼Œå¿…é¡»æœ‰è°ƒç”¨ C/C++ç¨‹åºï¼Œäºæ˜¯å°±åœ¨å†…å­˜ä¸­ä¸“é—¨å¼€è¾Ÿäº†ä¸€å—åŒºåŸŸå¤„ç†æ ‡è®°ä¸ºnativeçš„ä»£ç ï¼Œå®ƒçš„å…·ä½“åšæ³•æ˜¯ Native Method Stackä¸­ç™»è®° nativeæ–¹æ³•ï¼Œåœ¨Execution Engine æ‰§è¡Œæ—¶åŠ è½½native libraiesã€‚</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">ç›®å‰è¯¥æ–¹æ³•ä½¿ç”¨çš„è¶Šæ¥è¶Šå°‘äº†ï¼Œé™¤éæ˜¯ä¸ç¡¬ä»¶æœ‰å…³çš„åº”ç”¨ï¼Œæ¯”å¦‚é€šè¿‡Tavaç¨‹åºé©±åŠ¨æ‰“å°æœºæˆ–è€…Javaç³»ç»Ÿç®¡ç†ç”Ÿäº§è®¾å¤‡ï¼Œåœ¨ä¼ä¸šçº§åº”ç”¨ä¸­å·²ç»æ¯”è¾ƒå°‘è§ã€‚å› ä¸ºç°åœ¨çš„å¼‚æ„é¢†åŸŸé—´çš„é€šä¿¡å¾ˆå‘è¾¾ï¼Œæ¯”å¦‚å¯ä»¥ä½¿ç”¨ Socketé€šä¿¡ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨Web Serviceç­‰ç­‰ï¼Œä¸å¤šåšä»‹ç»ã€‚</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">Native Method Stack</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">å®ƒçš„å…·ä½“åšæ³•æ˜¯Native Method Stackä¸­ç™»è®°nativeæ–¹æ³•ï¼Œåœ¨Execution Engine æ‰§è¡Œæ—¶åŠ è½½æœ¬åœ°æ–¹æ³•åº“ã€‚</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_4-ç¨‹åºè®¡æ•°å™¨-program-counter-register" tabindex="-1"><a class="header-anchor" href="#_4-ç¨‹åºè®¡æ•°å™¨-program-counter-register"><span>4. ç¨‹åºè®¡æ•°å™¨ Program Counter Register</span></a></h2><p><strong>ç¨‹åºè®¡æ•°å™¨ï¼ˆProgram Counter Registerï¼‰</strong>ï¼Œä¹Ÿå«<code> PC å¯„å­˜å™¨</code>ã€‚PC å¯„å­˜å™¨é‡Œä¿å­˜å½“å‰æ­£åœ¨æ‰§è¡Œçš„ JVM æŒ‡ä»¤çš„åœ°å€ã€‚ æ¯ä¸€ä¸ªçº¿ç¨‹éƒ½æœ‰å®ƒè‡ªå·±çš„ PC å¯„å­˜å™¨ï¼Œä¹Ÿæ˜¯è¯¥çº¿ç¨‹å¯åŠ¨æ—¶åˆ›å»ºçš„ã€‚<br> æ¯ä¸ªçº¿ç¨‹éƒ½æœ‰ä¸€ä¸ªç¨‹åºè®¡æ•°å™¨ï¼Œæ˜¯çº¿ç¨‹ç§æœ‰çš„,å°±æ˜¯ä¸€ä¸ªæŒ‡é’ˆï¼ŒæŒ‡å‘æ–¹æ³•åŒºä¸­çš„æ–¹æ³•å­—èŠ‚ç ï¼ˆ<code>ç”¨æ¥å­˜å‚¨æŒ‡å‘ä¸‹ä¸€æ¡æŒ‡ä»¤çš„åœ°å€,ä¹Ÿå³å°†è¦æ‰§è¡Œçš„æŒ‡ä»¤ä»£ç </code>ï¼‰ï¼Œç”±æ‰§è¡Œå¼•æ“<code>Execution Engine</code>è¯»å–ä¸‹ä¸€æ¡æŒ‡ä»¤ï¼Œæ˜¯ä¸€ä¸ªéå¸¸å°çš„å†…å­˜ç©ºé—´ï¼Œå‡ ä¹å¯ä»¥å¿½ç•¥ä¸è®°ã€‚</p><p>è¿™å—å†…å­˜åŒºåŸŸå¾ˆå°ï¼Œ<code>å®ƒæ˜¯å½“å‰çº¿ç¨‹æ‰€æ‰§è¡Œçš„å­—èŠ‚ç çš„è¡Œå·æŒ‡ç¤ºå™¨</code>ï¼Œå­—èŠ‚ç è§£é‡Šå™¨é€šè¿‡æ”¹å˜è¿™ä¸ªè®¡æ•°å™¨çš„å€¼æ¥é€‰å–ä¸‹ä¸€æ¡éœ€è¦æ‰§è¡Œçš„å­—èŠ‚ç æŒ‡ä»¤ã€‚</p><p>å¦‚æœæ˜¯æ‰§è¡Œä¸€ä¸ªNativeæ–¹æ³•ï¼Œé‚£è¿™ä¸ªè®¡æ•°å™¨æ˜¯ç©ºçš„ã€‚</p><p>PC å¯„å­˜å™¨ä¸€èˆ¬ç”¨ä»¥å®Œæˆåˆ†æ”¯ã€å¾ªç¯ã€è·³è½¬ã€å¼‚å¸¸å¤„ç†ã€çº¿ç¨‹æ¢å¤ç­‰åŸºç¡€åŠŸèƒ½ã€‚ä¸ä¼šå‘ç”Ÿå†…å­˜æº¢å‡ºï¼ˆOutOfMemoryï¼ŒOOMï¼‰é”™è¯¯ã€‚</p><h2 id="_5-æ–¹æ³•åŒº-method-area" tabindex="-1"><a class="header-anchor" href="#_5-æ–¹æ³•åŒº-method-area"><span>5. æ–¹æ³•åŒº Method Area</span></a></h2><p><strong>æ–¹æ³•åŒºï¼ˆMethod Areaï¼‰</strong>ï¼Œæ˜¯ä¾›å„çº¿ç¨‹å…±äº«çš„è¿è¡Œæ—¶å†…å­˜åŒºåŸŸï¼Œå®ƒ<code>å­˜å‚¨äº†æ¯ä¸€ä¸ªç±»çš„ç»“æ„ä¿¡æ¯</code>ã€‚ä¾‹å¦‚è¿è¡Œæ—¶å¸¸é‡æ± ï¼ˆRuntime Constant Poolï¼‰ã€å­—æ®µå’Œæ–¹æ³•æ•°æ®ã€æ„é€ å‡½æ•°å’Œæ™®é€šæ–¹æ³•çš„å­—èŠ‚ç å†…å®¹ã€‚</p><p>ä¸Šé¢è¯´çš„æ˜¯è§„èŒƒï¼ˆå®šä¹‰çš„ä¸€ç§æŠ½è±¡æ¦‚å¿µï¼‰ï¼Œå®é™…åœ¨ä¸åŒè™šæ‹Ÿæœºé‡Œå®ç°æ˜¯ä¸ä¸€æ ·çš„ï¼Œæœ€å…¸å‹çš„å°±æ˜¯æ°¸ä¹…ä»£ï¼ˆPermGen spaceï¼‰å’Œå…ƒç©ºé—´ï¼ˆMeta spaceï¼‰ã€‚</p><blockquote><p>å®ä¾‹å˜é‡å­˜åœ¨å †å†…å­˜ä¸­ï¼Œå’Œæ–¹æ³•åŒºæ— å…³ã€‚</p></blockquote><h2 id="_6-æ ˆ-stack" tabindex="-1"><a class="header-anchor" href="#_6-æ ˆ-stack"><span>6. æ ˆ Stack</span></a></h2><p><strong><code>æ ˆç®¡è¿è¡Œï¼Œå †ç®¡å­˜å‚¨ï¼</code></strong> è¯·ç†Ÿè¯»å¹¶é»˜å†™å…¨æ–‡ã€‚ ( Â´â€¢Ï‰â€¢)ï¾‰(Â´ ï¾‰ Ğ”ï¼›ï½€)</p><p><strong>æ ˆï¼ˆStackï¼‰</strong>ï¼Œä¹Ÿå«æ ˆå†…å­˜ï¼Œä¸»ç®¡ Java ç¨‹åºçš„è¿è¡Œï¼Œåœ¨çº¿ç¨‹åˆ›å»ºæ—¶åˆ›å»ºã€‚å…¶ç”Ÿå‘½æœŸæ˜¯è·Ÿéšçº¿ç¨‹çš„ç”Ÿå‘½æœŸï¼Œæ˜¯çº¿ç¨‹ç§æœ‰çš„ï¼Œçº¿ç¨‹ç»“æŸæ ˆå†…å­˜ä¹Ÿå°±æ˜¯é‡Šæ”¾ã€‚</p><p>å¯¹äºæ ˆæ¥è¯´ï¼Œä¸å­˜åœ¨åƒåœ¾å›æ”¶çš„é—®é¢˜ï¼Œåªè¦çº¿ç¨‹ä¸€ç»“æŸè¯¥æ ˆå°± Overã€‚8ç§<code>åŸºæœ¬ç±»å‹çš„å˜é‡+å¯¹è±¡çš„å¼•ç”¨å˜é‡+å®ä¾‹æ–¹æ³•éƒ½æ˜¯åœ¨å‡½æ•°çš„æ ˆå†…å­˜ä¸­åˆ†é…</code>ã€‚</p><h3 id="_6-1-æ ˆå­˜å‚¨ä»€ä¹ˆæ•°æ®" tabindex="-1"><a class="header-anchor" href="#_6-1-æ ˆå­˜å‚¨ä»€ä¹ˆæ•°æ®"><span>6.1 æ ˆå­˜å‚¨ä»€ä¹ˆæ•°æ®ï¼Ÿ</span></a></h3><p>æ ˆä¸»è¦å­˜å‚¨<strong>8 ç§åŸºæœ¬ç±»å‹çš„å˜é‡ã€å¯¹è±¡çš„å¼•ç”¨å˜é‡ã€ä»¥åŠå®ä¾‹æ–¹æ³•ã€‚</strong></p><p>è¿™é‡Œå¼•å‡ºä¸€ä¸ªåè¯ï¼Œ<strong>æ ˆå¸§</strong>ï¼Œä»€ä¹ˆæ˜¯æ ˆå¸§ï¼Ÿ<br> æ¯ä¸ªæ–¹æ³•æ‰§è¡Œçš„åŒæ—¶éƒ½ä¼šåˆ›å»ºä¸€ä¸ªæ ˆå¸§ï¼Œç”¨äºå­˜å‚¨å±€éƒ¨å˜é‡è¡¨ã€æ“ä½œæ•°æ ˆã€åŠ¨æ€é“¾æ¥ã€æ–¹æ³•å‡ºå£ç­‰ä¿¡æ¯ï¼Œæ¯ä¸ªæ–¹æ³•ä»è°ƒç”¨ç›´è‡³æ‰§è¡Œå®Œæ¯•çš„è¿‡ç¨‹ï¼Œå°±å¯¹åº”ç€ä¸€ä¸ªæ ˆå¸§åœ¨è™šæ‹Ÿæœºä¸­å…¥æ ˆåˆ°å‡ºæ ˆçš„è¿‡ç¨‹ã€‚<br><img src="/blog/assets/img/20200725155759288.2ee07c97.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" loading="lazy"><br> ç®€å•æ¥è¯´ï¼Œ<strong>æ ˆå¸§</strong>å¯¹åº”ä¸€ä¸ªæ–¹æ³•çš„æ‰§è¡Œå’Œç»“æŸï¼Œæ˜¯æ–¹æ³•æ‰§è¡Œè¿‡ç¨‹çš„å†…å­˜æ¨¡å‹ã€‚</p><p>å…¶ä¸­ï¼Œæ ˆå¸§ä¸»è¦ä¿æŒäº† 3 ç±»æ•°æ®ï¼š</p><ol><li><strong>æœ¬åœ°å˜é‡ï¼ˆLocal Variablesï¼‰</strong>ï¼šè¾“å…¥å‚æ•°å’Œè¾“å‡ºå‚æ•°ï¼Œä»¥åŠæ–¹æ³•å†…çš„å˜é‡ã€‚</li><li><strong>æ ˆæ“ä½œï¼ˆOperand Stackï¼‰</strong>ï¼šè®°å½•å‡ºæ ˆã€å…¥æ ˆçš„æ“ä½œã€‚</li><li><strong>æ ˆå¸§æ•°æ®ï¼ˆFrame Dataï¼‰</strong>ï¼šåŒ…æ‹¬ç±»æ–‡ä»¶ã€æ–¹æ³•ç­‰ã€‚</li></ol><blockquote><p>æ ˆçš„å¤§å°æ˜¯æ ¹æ® JVM æœ‰å…³ï¼Œä¸€èˆ¬åœ¨ 256K~756K ä¹‹é—´ï¼Œçº¦ç­‰äº 1Mb å·¦å³ã€‚</p></blockquote><h3 id="_6-2-æ ˆçš„è¿è¡ŒåŸç†" tabindex="-1"><a class="header-anchor" href="#_6-2-æ ˆçš„è¿è¡ŒåŸç†"><span>6.2 æ ˆçš„è¿è¡ŒåŸç†</span></a></h3><p>è§‚å¯Ÿä¸‹å›¾ï¼Œåœ¨ java ä¸­ï¼Œ<code>test()</code>å’Œ<code>main()</code>éƒ½æ˜¯æ–¹æ³•ï¼Œè€Œåœ¨æ ˆä¸­ï¼Œç§°ä¸ºæ ˆå¸§ã€‚åœ¨æ ˆä¸­ï¼Œ<code>main()</code>éƒ½æ˜¯ç¬¬ä¸€ä¸ªå…¥æ ˆçš„ã€‚<br> æ ˆçš„é¡ºåºä¸ºï¼š<code>main()</code>å…¥æ ˆ --&gt; <code>test()</code>å…¥æ ˆ --&gt; <code>test()</code>å‡ºæ ˆ --&gt; <code>main()</code>å‡ºæ ˆã€‚<br><img src="/blog/assets/img/20200725150917476.928952bd.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" loading="lazy"><br> æ ¹æ®ä»£ç å’Œè¿è¡Œç»“æœå¯ä»¥çŸ¥é“ï¼Œ<code>main()</code>æƒ³è¦å‡ºæ ˆï¼Œåˆ™å¿…é¡»<code>test()</code>å…ˆå‡ºæ ˆã€‚é‚£ä¹ˆæ€ä¹ˆè¯æ˜å‘¢ï¼Ÿè§‚å¯Ÿä¸‹é¢ä»£ç ï¼Œæˆ‘ä»¬åœ¨<code>test()</code>æ–¹æ³•ä¸­æ·»åŠ äº†ä¸€æ¡è¯­å¥<code>Thread.sleep(Integer.MAX_VALUE);</code>ï¼Œæ¥è®©<code>test()</code>æ— æ³•è¿›è¡Œå‡ºæ ˆæ“ä½œï¼Œè¿›è€Œå¯¼è‡´<code>main()</code>ä¹Ÿæ— æ³•å‡ºæ ˆã€‚è¿è¡Œä»£ç å‘ç°ï¼Œè¿è¡Œç»“æœå¦‚æˆ‘ä»¬æ‰€æ–™ï¼Œç¨‹åºä¸€ç›´åœç•™åœ¨<code>test()</code>å…¥æ ˆï¼Œæ— æ³•è¿›è¡Œå…¶ä»–æ“ä½œã€‚<br><img src="/blog/assets/img/20200725150109203.8d40c733.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" loading="lazy"><br> æˆ‘ä»¬æ¥ç€è§‚å¯Ÿä¸‹å›¾ï¼Œåœ¨å›¾ä¸­ä¸€ä¸ªæ ˆä¸­æœ‰ä¸¤ä¸ªæ ˆå¸§ï¼Œåˆ†åˆ«æ˜¯<code>Stack Frame1</code>å’Œ<code>Stack Frame2</code>ï¼Œå¯¹åº”æ–¹æ³• 1 å’Œæ–¹æ³• 2ã€‚å…¶ä¸­<code>Stack Frame2</code>æ˜¯æœ€å…ˆè¢«è°ƒç”¨çš„æ–¹æ³• 2ï¼Œæ‰€ä»¥å®ƒå…ˆå…¥æ ˆã€‚ç„¶åæ–¹æ³• 2 åˆè°ƒç”¨äº†æ–¹æ³• 1ï¼Œæ‰€ä»¥<code>Stack Frame1</code>å¤„äºæ ˆé¡¶ä½ç½®ã€‚æ‰§è¡Œå®Œæ¯•åï¼Œä¾æ¬¡å¼¹å‡º<code>Stack Frame1</code>å’Œ<code>Stack Frame2</code>ï¼Œç„¶åçº¿ç¨‹ç»“æŸï¼Œæ ˆé‡Šæ”¾ã€‚<br> æ‰€ä»¥ï¼Œæ¯æ‰§è¡Œä¸€ä¸ªæ–¹æ³•éƒ½ä¼šäº§ç”Ÿä¸€ä¸ªæ ˆå¸§ï¼Œå¹¶ä¿å­˜åˆ°æ ˆçš„é¡¶éƒ¨ï¼Œé¡¶éƒ¨çš„æ ˆå¸§å°±æ˜¯å½“å‰æ‰€æ‰§è¡Œçš„æ–¹æ³•ï¼Œè¯¥æ–¹æ³•æ‰§è¡Œå®Œæ¯•åä¼šè‡ªåŠ¨å‡ºæ ˆã€‚</p><figure><img src="/blog/assets/img/img-202303101622.c9ea3006.png" alt="img-202303101622.png" tabindex="0" loading="lazy"><figcaption>img-202303101622.png</figcaption></figure><p>æ€»ç»“å¦‚ä¸‹ï¼Œæ ˆä¸­çš„æ•°æ®éƒ½æ˜¯ä»¥æ ˆå¸§ï¼ˆStack Frameï¼‰çš„æ ¼å¼å­˜åœ¨ï¼Œæ ˆå¸§æ˜¯ä¸€ä¸ªå†…å­˜åŒºå—ï¼Œæ˜¯ä¸€ä¸ªæ•°æ®é›†ï¼Œæ˜¯ä¸€ä¸ªæœ‰å…³æ–¹æ³•ï¼ˆMethodï¼‰å’Œè¿è¡ŒæœŸæ•°æ®çš„æ•°æ®é›†ï¼Œå½“ä¸€ä¸ªæ–¹æ³• A è¢«è°ƒç”¨æ—¶å°±äº§ç”Ÿäº†ä¸€ä¸ªæ ˆå¸§ F1ï¼Œå¹¶è¢«å‹å…¥åˆ°æ ˆä¸­ï¼Œæ–¹æ³• A ä¸­åˆè°ƒç”¨äº†æ–¹æ³• Bï¼Œäºæ˜¯äº§ç”Ÿæ ˆå¸§ F2 ä¹Ÿè¢«å‹å…¥æ ˆä¸­ï¼Œæ–¹æ³• B åˆè°ƒç”¨æ–¹æ³• Cï¼Œäºæ˜¯äº§ç”Ÿæ ˆå¸§ F3 ä¹Ÿè¢«å‹å…¥æ ˆä¸­Â·Â·Â·Â·Â·Â·æ‰§è¡Œå®Œæ¯•åï¼Œ<strong>éµå¾ªâ€œå…ˆè¿›åå‡ºï¼Œåè¿›å…ˆå‡ºâ€çš„åŸåˆ™</strong>ï¼Œå…ˆå¼¹å‡º F3 æ ˆå¸§ï¼Œå†å¼¹å‡º F2 æ ˆå¸§ï¼Œå†å¼¹å‡º F1 æ ˆå¸§ã€‚</p><h3 id="_6-3-æ ˆæº¢å‡º-stackoverflowerror" tabindex="-1"><a class="header-anchor" href="#_6-3-æ ˆæº¢å‡º-stackoverflowerror"><span>6.3 æ ˆæº¢å‡º StackOverflowError</span></a></h3><p>å¤§å®¶è‚¯å®šå¯¹æ ˆæº¢å‡ºè€³ç†Ÿï¼Œé‚£æ ˆæº¢å‡ºæ˜¯æ€ä¹ˆäº§ç”Ÿçš„å‘¢ï¼Ÿ</p><p>è¯·çœ‹ä¸‹é¢ä»£ç ï¼Œ<code>test()</code>æ–¹æ³•é‡Œé¢åˆè°ƒç”¨äº†<code>test()</code>æ–¹æ³•ï¼Œå³è‡ªå·±è°ƒç”¨è‡ªå·±ï¼Œä¹Ÿå«é€’å½’ã€‚<br> åŒæ—¶ï¼Œæ ˆæ˜¯ä¸€ä¸ªå†…å­˜å—ï¼Œå®ƒæ˜¯æœ‰å¤§å°é•¿åº¦çš„ï¼Œè€Œæˆ‘ä»¬è§‚å¯Ÿä»£ç å‘ç°ï¼Œåªè¦ä»£ç ä¸€è¿è¡Œï¼Œ<code>test()</code>æ–¹æ³•å°±ä¼šä¸€ç›´è¿›è¡Œå…¥æ ˆæ“ä½œï¼Œè€Œæ²¡æœ‰å‡ºæ ˆæ“ä½œï¼Œç»“æœè‚¯å®šä¼šè¶…å‡ºæ ˆçš„å¤§å°ï¼Œè¿›è€Œé€ æˆæ ˆæº¢å‡ºé”™è¯¯ï¼Œå³<code>java.lang.StackOverflowError</code>ã€‚<br><img src="/blog/assets/img/20200725155127479.8d298071.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" loading="lazy"><br> æ‰€ä»¥è¯´ï¼Œè€å“¥ä»¬ï¼Œç¦æ­¢å¥—å¨ƒï¼Œç¦æ­¢å¥—å¨ƒï¼Œç¦æ­¢å¥—å¨ƒï¼!!!âˆ‘(ï¾Ÿ Ğ” ï¾Ÿãƒ)ãƒ</p><blockquote><p><code>java.lang.StackOverflowError</code>æ˜¯é”™è¯¯ï¼Œä¸æ˜¯å¼‚å¸¸ï¼è¯æ˜å¦‚ä¸‹ ï¼š<br><img src="/blog/assets/img/20200725155549596.c19ab7b3.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" loading="lazy"></p></blockquote><h2 id="_7-æ ˆã€å †ã€æ–¹æ³•åŒºçš„äº¤äº’å…³ç³»" tabindex="-1"><a class="header-anchor" href="#_7-æ ˆã€å †ã€æ–¹æ³•åŒºçš„äº¤äº’å…³ç³»"><span>7. æ ˆã€å †ã€æ–¹æ³•åŒºçš„äº¤äº’å…³ç³»</span></a></h2><p>æ ˆã€å †ã€æ–¹æ³•åŒºä¸‰è€…çš„å…³ç³»å¦‚ä¸‹å›¾ï¼Œå…¶ä¸­<code>reference</code>æ˜¯å¼•ç”¨ç±»å‹ã€‚<br><img src="/blog/assets/img/20200725160245331.08f58510.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" loading="lazy"><br> ä¸¾ä¸ªæ —å­ï¼Œæ¯”å¦‚<code>MyObject myObject = new MyObject();</code>ï¼Œç­‰å·å·¦è¾¹<code>MyObject myObject</code>çš„<code>myObject</code>å°±æ˜¯å¼•ç”¨ï¼Œåœ¨ Java æ ˆé‡Œé¢ã€‚ç­‰å·å³è¾¹çš„<code>new MyObject()</code>ï¼Œ<code>new</code>å‡ºæ¥çš„<code>MyObject</code>å®ä¾‹å¯¹è±¡åœ¨å †é‡Œé¢ã€‚ç®€å•æ¥è¯´ï¼Œå°±æ˜¯ Java æ ˆä¸­çš„å¼•ç”¨<code>myObject</code>æŒ‡å‘äº†å †ä¸­çš„<code>MyObject</code>å®ä¾‹å¯¹è±¡ã€‚<br><img src="/blog/assets/img/20200725161551868.9cf16ee5.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" loading="lazy"></p><h2 id="_8-å †-heap" tabindex="-1"><a class="header-anchor" href="#_8-å †-heap"><span>8. å † Heap</span></a></h2><h3 id="_8-1-å †ä½“ç³»ç»“æ„" tabindex="-1"><a class="header-anchor" href="#_8-1-å †ä½“ç³»ç»“æ„"><span>8.1 å †ä½“ç³»ç»“æ„</span></a></h3><p>ä¸€ä¸ª JVM å®ä¾‹åªå­˜åœ¨ä¸€ä¸ªå †å†…å­˜ï¼Œå †å†…å­˜çš„å¤§å°æ˜¯å¯ä»¥è°ƒèŠ‚çš„ã€‚ç±»åŠ è½½å™¨è¯»å–äº†ç±»æ–‡ä»¶ä¹‹åï¼Œéœ€è¦æŠŠç±»ã€æ–¹æ³•ã€å¸¸é‡å˜é‡æ”¾åˆ°å †å†…å­˜ä¸­ï¼Œä¿æŒæ‰€ä»¥å¼•ç”¨ç±»å‹çš„çœŸå®ä¿¡æ¯ï¼Œæ–¹ä¾¿æ‰§è¡Œå™¨æ‰§è¡Œã€‚</p><p>å…¶ä¸­ï¼Œå †å†…å­˜åˆ†ä¸º 3 ä¸ªéƒ¨åˆ†ï¼š</p><ol><li>Young Generation Spaceï¼Œæ–°ç”ŸåŒºã€æ–°ç”Ÿä»£</li><li>Tenure Generation Spaceï¼Œè€å¹´åŒºã€è€å¹´ä»£</li><li>Permanent Spaceï¼Œæ°¸ä¹…åŒºã€å…ƒç©ºé—´</li></ol><p><strong><code>Java7</code> ä¹‹å‰ï¼Œå †ç»“æ„å›¾å¦‚ä¸‹ï¼Œè€Œ Java8 åˆ™åªå°†æ°¸ä¹…åŒºå˜æˆäº†å…ƒç©ºé—´ã€‚</strong><br><img src="/blog/assets/img/20200725163244622.299a10b0.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" loading="lazy"><br><strong>æ€»ç»“ä¸€ä¸‹ï¼Œå †å†…å­˜åœ¨<code>é€»è¾‘ä¸Š</code>åˆ†ä¸ºæ–°ç”Ÿ+å…»è€+å…ƒç©ºé—´ï¼Œè€Œå †å†…å­˜åœ¨ç‰©ç†ä¸Šåˆ†ä¸ºæ–°ç”Ÿ+å…»è€ã€‚</strong></p><h3 id="_8-2-å¯¹è±¡åœ¨å †ä¸­çš„ç”Ÿå‘½å‘¨æœŸ" tabindex="-1"><a class="header-anchor" href="#_8-2-å¯¹è±¡åœ¨å †ä¸­çš„ç”Ÿå‘½å‘¨æœŸ"><span>8.2 å¯¹è±¡åœ¨å †ä¸­çš„ç”Ÿå‘½å‘¨æœŸ</span></a></h3><p>é‚£ä¹ˆå¦‚ä½•ç›´è§‚çš„äº†è§£å¯¹è±¡åœ¨å †ä¸­çš„ç”Ÿå‘½å‘¨æœŸå‘¢ï¼Ÿ</p><p>ï¼ˆ1ï¼‰é¦–å…ˆï¼Œæ–°ç”ŸåŒºæ˜¯ç±»çš„è¯ç”Ÿã€æˆé•¿ã€æ¶ˆäº¡çš„åŒºåŸŸã€‚ä¸€ä¸ªç±»åœ¨è¿™é‡Œè¢«åˆ›å»ºå¹¶ä½¿ç”¨ï¼Œæœ€åè¢«åƒåœ¾å›æ”¶å™¨æ”¶é›†ï¼Œç»“æŸç”Ÿå‘½ã€‚</p><p>ï¼ˆ2ï¼‰å…¶æ¬¡ï¼Œæ‰€æœ‰çš„ç±»éƒ½æ˜¯åœ¨<code>Eden Space</code>è¢«<code>new</code>å‡ºæ¥çš„ã€‚è€Œå½“<code>Eden Space</code>çš„ç©ºé—´ç”¨å®Œæ—¶ï¼Œç¨‹åºåˆéœ€è¦åˆ›å»ºå¯¹è±¡ï¼ŒJVM çš„åƒåœ¾å›æ”¶å™¨åˆ™ä¼šå°†<code>Eden Space</code>ä¸­ä¸å†è¢«å…¶ä»–å¯¹è±¡æ‰€å¼•ç”¨çš„å¯¹è±¡è¿›è¡Œé”€æ¯ï¼Œä¹Ÿå°±æ˜¯åƒåœ¾å›æ”¶ï¼ˆMinor GCï¼‰ã€‚æ­¤æ—¶çš„ GC å¯ä»¥è®¤ä¸ºæ˜¯<strong>è½»é‡çº§ GC</strong>ã€‚</p><p>ï¼ˆ3ï¼‰ç„¶åå°†<code>Eden Space</code>ä¸­å‰©ä½™çš„æœªè¢«å›æ”¶çš„å¯¹è±¡ï¼Œç§»åŠ¨åˆ°<code>Survivor 0 Space</code>ï¼Œä»¥æ­¤å¾€å¤ï¼Œç›´åˆ°<code>Survivor 0 Space</code>ä¹Ÿæ»¡äº†çš„æ—¶å€™ï¼Œå†å¯¹<code>Survivor 0 Space</code>è¿›è¡Œåƒåœ¾å›æ”¶ï¼Œå‰©ä½™çš„æœªè¢«å›æ”¶çš„å¯¹è±¡ï¼Œåˆ™å†ç§»åŠ¨åˆ°<code>Survivor 1 Space</code>ã€‚<code>Survivor 1 Space</code>ä¹Ÿæ»¡äº†çš„è¯ï¼Œå†ç§»åŠ¨è‡³<code>Tenure Generation Space</code>ã€‚</p><p>ï¼ˆ4ï¼‰æœ€åï¼Œå¦‚æœ<code>Tenure Generation Space</code>ä¹Ÿæ»¡äº†çš„è¯ï¼Œé‚£ä¹ˆè¿™ä¸ªæ—¶å€™å°±ä¼šè¢«åƒåœ¾å›æ”¶ï¼ˆMajor GC or Full GCï¼‰å¹¶å°†è¯¥åŒºçš„å†…å­˜æ¸…ç†ã€‚æ­¤æ—¶çš„ GC å¯ä»¥è®¤ä¸ºæ˜¯<strong>é‡é‡çº§ GC</strong>ã€‚å¦‚æœ<code>Tenure Generation Space</code>è¢« GC åƒåœ¾å›æ”¶ä¹‹åï¼Œä¾æ—§å¤„äºå æ»¡çŠ¶æ€çš„è¯ï¼Œå°±ä¼šäº§ç”Ÿæˆ‘ä»¬åœºæ™¯çš„<code>OOM</code>å¼‚å¸¸ï¼Œå³<code>OutOfMemoryError</code>ã€‚</p><div class="language-dockerfile line-numbers-mode" data-highlighter="shiki" data-ext="dockerfile" data-title="dockerfile" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">å¦‚æœå‡ºç°iava.lang.OutOfMemorvError: Java heap spaceå¼‚å¸¸ï¼Œè¯´æ˜Javaè™šæ‹Ÿæœºçš„å †å†…å­˜ä¸å¤Ÿã€‚</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">åŸå› æœ‰äºŒ:</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(1)Javaè™šæ‹Ÿæœºçš„å †å†…å­˜è®¾ç½®ä¸å¤Ÿï¼Œå¯ä»¥é€šè¿‡å‚æ•°-Xmsã€-Xmxæ¥è°ƒæ•´ã€‚    </span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(2)ä»£ç ä¸­åˆ›å»ºäº†å¤§é‡å¤§å¯¹è±¡ï¼Œå¹¶ä¸”é•¿æ—¶é—´ä¸èƒ½è¢«åƒåœ¾æ”¶é›†å™¨æ”¶é›†(å­˜åœ¨è¢«å¼•ç”¨)ã€‚</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_8-3-minor-gc-çš„è¿‡ç¨‹" tabindex="-1"><a class="header-anchor" href="#_8-3-minor-gc-çš„è¿‡ç¨‹"><span>8.3 Minor GC çš„è¿‡ç¨‹</span></a></h3><p><code>Survivor 0 Space</code>ï¼Œå¹¸å­˜è€… 0 åŒºï¼Œä¹Ÿå«<code>from</code>åŒºï¼›<br><code>Survivor 1 Space</code>ï¼Œå¹¸å­˜è€… 1 åŒºï¼Œä¹Ÿå«<code>to</code>åŒºã€‚</p><p>å…¶ä¸­ï¼Œ<code>from</code>åŒºå’Œ<code>to</code>åŒºçš„åŒºåˆ†ä¸æ˜¯å›ºå®šçš„ï¼Œæ˜¯äº’ç›¸äº¤æ¢çš„ï¼Œæ„æ€æ˜¯è¯´ï¼Œåœ¨æ¯æ¬¡ GC ä¹‹åï¼Œä¸¤è€…ä¼šè¿›è¡Œäº¤æ¢ï¼Œè°ç©ºè°å°±æ˜¯<code>to</code>åŒºã€‚</p><p>ä¸æ˜ç™½ï¼Ÿæ²¡å…³ç³»ï¼Œæ¥ç€å¾€ä¸‹çœ‹ã€‚<br><img src="/blog/assets/img/20200807105031435.ae0a3158.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" loading="lazy"><br><strong>ï¼ˆ1ï¼‰<code>Eden Space</code>ã€<code>SurvivorFrom</code>å¤åˆ¶åˆ°<code>SurvivorTo</code>ï¼Œå¹´é¾„+1ã€‚</strong><br> é¦–å…ˆï¼Œå½“<code>Eden Space</code>æ»¡æ—¶ï¼Œä¼šè§¦å‘ç¬¬ä¸€æ¬¡ GCï¼ŒæŠŠè¿˜æ´»ç€çš„å¯¹è±¡æ‹·è´åˆ°<code>from</code>åŒºã€‚è€Œå½“<code>Eden Space</code>å†æ¬¡è§¦å‘ GC æ—¶ï¼Œä¼šæ‰«æ<code>Eden Space</code>å’Œ<code>SurvivorFrom</code>ï¼Œå¯¹è¿™ä¸¤ä¸ªåŒºè¿›è¡Œåƒåœ¾å›æ”¶ï¼Œç»è¿‡æ­¤æ¬¡å›æ”¶åä¾æ—§å­˜æ´»çš„å¯¹è±¡ï¼Œåˆ™ç›´æ¥å¤åˆ¶åˆ°<code>to</code>åŒºï¼ˆå¦‚æœå¯¹è±¡çš„å¹´é¾„å·²ç»è¾¾åˆ°è€å¹´çš„æ ‡å‡†ï¼Œåˆ™ç§»åŠ¨è‡³è€å¹´ä»£åŒºï¼‰ï¼ŒåŒæ—¶æŠŠè¿™äº›å¯¹è±¡çš„å¹´é¾„+1ã€‚</p><p><strong>ï¼ˆ2ï¼‰æ¸…ç©º<code>Eden Space</code>ã€<code>SurvivorFrom</code></strong><br> ç„¶åï¼Œæ¸…ç©º<code>Eden Space</code>å’Œ<code>SurvivorFrom</code>ä¸­çš„å¯¹è±¡ï¼Œæ­¤æ—¶çš„<code>SurvivorFrom</code>æ˜¯ç©ºçš„ã€‚</p><p><strong>ï¼ˆ3ï¼‰<code>SurvivorFrom</code>å’Œ<code>SurvivorTo</code>äº’æ¢</strong><br> æœ€åï¼Œ<code>SurvivorFrom</code>å’Œ<code>SurvivorTo</code>è¿›è¡Œäº’æ¢ï¼ŒåŸ<code>SurvivorFrom</code>æˆä¸ºä¸‹ä¸€æ¬¡ GC æ—¶çš„<code>SurvivorTo</code>ï¼ŒåŸ<code>SurvivorTo</code>æˆä¸ºä¸‹ä¸€æ¬¡ GC æ—¶çš„<code>SurvivorFrom</code>ã€‚éƒ¨åˆ†å¯¹è±¡ä¼šåœ¨<code>SurvivorFrom</code>å’Œ<code>SurvivorTo</code>ä¸­æ¥å›è¿›è¡Œäº¤æ¢å¤åˆ¶ï¼Œå¦‚æœäº¤æ¢ 15 æ¬¡ï¼ˆç”± JVM å‚æ•°<code>MaxTenuringThreshold</code>å†³å®šï¼Œé»˜è®¤ 15ï¼‰ï¼Œæœ€ç»ˆä¾æ—§å­˜æ´»çš„å¯¹è±¡å°±ä¼šç§»åŠ¨è‡³è€å¹´ä»£ã€‚</p><p>æ€»ç»“ä¸€å¥è¯ï¼Œ<strong>GC ä¹‹åæœ‰äº¤æ¢ï¼Œè°ç©ºè°æ˜¯<code>to</code></strong>ã€‚</p><blockquote><p>è¿™æ ·ä¹Ÿæ˜¯ä¸ºäº†ä¿è¯å†…å­˜ä¸­æ²¡æœ‰ç¢ç‰‡ï¼Œæ‰€ä»¥<code>Survivor 0 Space</code>å’Œ<code>Survivor 1 Space</code>æœ‰ä¸€ä¸ªè¦æ˜¯ç©ºçš„ã€‚</p></blockquote><h3 id="_8-4-hotspot-è™šæ‹Ÿæœºçš„å†…å­˜ç®¡ç†" tabindex="-1"><a class="header-anchor" href="#_8-4-hotspot-è™šæ‹Ÿæœºçš„å†…å­˜ç®¡ç†"><span>8.4 HotSpot è™šæ‹Ÿæœºçš„å†…å­˜ç®¡ç†</span></a></h3><figure><img src="/blog/assets/img/20200807112107588.7365d82e.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" tabindex="0" loading="lazy"><figcaption>åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°</figcaption></figure><blockquote><p>ä¸åŒå¯¹è±¡çš„ç”Ÿå‘½å‘¨æœŸä¸åŒï¼Œå…¶ä¸­ 98%çš„å¯¹è±¡éƒ½æ˜¯ä¸´æ—¶å¯¹è±¡ï¼Œå³è¿™äº›å¯¹è±¡çš„ç”Ÿå‘½å‘¨æœŸå¤§å¤šåªå­˜åœ¨äº Eden åŒºã€‚</p></blockquote><p>å®é™…è€Œè¨€ï¼Œæ–¹æ³•åŒºï¼ˆ<code>Method Area</code>ï¼‰å’Œå †ä¸€æ ·ï¼Œæ˜¯å„ä¸ªçº¿ç¨‹å…±äº«çš„å†…å­˜åŒºåŸŸï¼Œå®ƒç”¨äºå­˜å‚¨è™šæ‹ŸæœºåŠ è½½çš„ï¼šç±»ä¿¡æ¯+æ™®é€šå¸¸é‡+é™æ€å¸¸é‡+ç¼–è¯‘å™¨ç¼–è¯‘åçš„ä»£ç ç­‰ç­‰ã€‚<strong><code>è™½ç„¶ JVM è§„èŒƒå°†æ–¹æ³•åŒºæè¿°ä¸ºå †çš„ä¸€ä¸ªé€»è¾‘éƒ¨åˆ†ï¼Œä½†å®ƒå´è¿˜æœ‰ä¸€ä¸ªåˆ«åå«åšNon-Heapï¼ˆéå †å†…å­˜ï¼‰ï¼Œç›®çš„å°±æ˜¯è¦å’Œå †åŒºåˆ†å¼€ã€‚</code></strong></p><p>å¯¹äº HotSpot è™šæ‹Ÿæœºè€Œè¨€ï¼Œå¾ˆå¤šå¼€å‘è€…ä¹ æƒ¯å°†æ–¹æ³•åŒºç§°ä¸º â€œæ°¸ä¹…ä»£ï¼ˆ<code>Permanent Gen</code>ï¼‰â€ ã€‚ä½†ä¸¥æ ¼æ¥è¯´ä¸¤è€…æ˜¯ä¸åŒçš„ï¼Œæˆ–è€…è¯´åªæ˜¯ä½¿ç”¨æ°¸ä¹…ä»£æ¥å®ç°æ–¹æ³•åŒºè€Œå·²ï¼Œæ°¸ä¹…ä»£æ˜¯æ–¹æ³•åŒºï¼ˆå¯ä»¥ç†è§£ä¸ºä¸€ä¸ªæ¥å£<code>interface</code>ï¼‰çš„ä¸€ä¸ªå®ç°ï¼Œ<code>JDK1.7 çš„ç‰ˆæœ¬ä¸­ï¼Œå·²ç»å°†åŸæœ¬æ”¾åœ¨æ°¸ä¹…ä»£çš„å­—ç¬¦ä¸²å¸¸é‡æ± ç§»èµ°</code>ã€‚ï¼ˆå­—ç¬¦ä¸²å¸¸é‡æ± ï¼ŒJDK1.6 åœ¨æ–¹æ³•åŒºï¼ŒJDK1.7 åœ¨å †ï¼ŒJDK1.8 åœ¨å…ƒç©ºé—´ã€‚ï¼‰<br><img src="/blog/assets/img/20200807112937832.0988c2c9.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" loading="lazy"></p><blockquote><p>å¦‚æœæ²¡æœ‰æ˜ç¡®æŒ‡æ˜ï¼ŒJava è™šæ‹Ÿæœºçš„åå­—å°±å«åš<code>HotSpot</code>ã€‚<br><img src="/blog/assets/img/20200807114729427.07689046.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" loading="lazy"></p></blockquote><h3 id="_8-5-æ°¸ä¹…åŒº" tabindex="-1"><a class="header-anchor" href="#_8-5-æ°¸ä¹…åŒº"><span>8.5 æ°¸ä¹…åŒº</span></a></h3><p>æ°¸ä¹…åŒºæ˜¯ä¸€ä¸ªå¸¸é©»å†…å­˜åŒºåŸŸï¼Œç”¨äºå­˜æ”¾ JDK è‡ªèº«æ‰€æºå¸¦çš„<code>Class</code>ï¼Œ<code>Interface</code>çš„å…ƒæ•°æ®ï¼ˆä¹Ÿå°±æ˜¯ä¸Šé¢æ–‡ç« æåˆ°çš„<code>rt.jar</code>ç­‰ï¼‰ï¼Œä¹Ÿå°±æ˜¯è¯´å®ƒå­˜å‚¨çš„æ˜¯è¿è¡Œç¯å¢ƒå¿…é¡»çš„ç±»ä¿¡æ¯ï¼Œè¢«è£…è½½è¿›æ­¤åŒºåŸŸçš„æ•°æ®æ˜¯ä¸ä¼šè¢«åƒåœ¾å›æ”¶å™¨å›æ”¶æ‰çš„ï¼Œå…³é—­ JVM æ‰ä¼šé‡Šæ”¾æ­¤åŒºåŸŸæ‰€å ç”¨çš„å†…å­˜ã€‚<br><strong>ï¼ˆ1ï¼‰JDK1.7</strong><br><img src="/blog/assets/img/20200807121320925.18d78267.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" loading="lazy"></p><p><strong>ï¼ˆ2ï¼‰JDK1.8</strong><br><img src="/blog/assets/img/20200807121358976.3cf3b725.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" loading="lazy"><br> åœ¨ JDK1.8 ä¸­ï¼Œæ°¸ä¹…ä»£å·²ç»è¢«ç§»é™¤ï¼Œè¢«ä¸€ä¸ªç§°ä¸º<strong>å…ƒç©ºé—´</strong>çš„åŒºåŸŸæ‰€å–ä»£ã€‚å…ƒç©ºé—´çš„æœ¬è´¨å’Œæ°¸ä¹…ä»£ç±»ä¼¼ã€‚</p><p>å…ƒç©ºé—´ä¸æ°¸ä¹…ä»£ä¹‹é—´æœ€å¤§çš„åŒºåˆ«åœ¨äºï¼š <strong>æ°¸ä¹…å¸¦ä½¿ç”¨çš„ JVM çš„å †å†…å­˜ï¼Œä½†æ˜¯ java8 ä»¥åçš„<code>å…ƒç©ºé—´å¹¶ä¸åœ¨è™šæ‹Ÿæœºä¸­è€Œæ˜¯ä½¿ç”¨æœ¬æœºç‰©ç†å†…å­˜ã€‚</code></strong></p><p>å› æ­¤ï¼Œé»˜è®¤æƒ…å†µä¸‹ï¼Œå…ƒç©ºé—´çš„å¤§å°ä»…å—æœ¬åœ°å†…å­˜é™åˆ¶ã€‚<br> ç±»çš„å…ƒæ•°æ®æ”¾å…¥<code>native memory</code>ï¼Œå­—ç¬¦ä¸²æ± å’Œç±»çš„é™æ€å˜é‡æ”¾å…¥ Java å †ä¸­ï¼Œè¿™æ ·å¯ä»¥åŠ è½½å¤šå°‘ç±»çš„å…ƒæ•°æ®å°±ä¸å†ç”±<code>MaxPermSize</code>æ§åˆ¶, è€Œç”±ç³»ç»Ÿçš„å®é™…å¯ç”¨ç©ºé—´æ¥æ§åˆ¶ã€‚</p><h3 id="_8-6-å †å‚æ•°è°ƒä¼˜" tabindex="-1"><a class="header-anchor" href="#_8-6-å †å‚æ•°è°ƒä¼˜"><span>8.6 å †å‚æ•°è°ƒä¼˜</span></a></h3><p>åœ¨è¿›è¡Œå †å‚æ•°è°ƒä¼˜å‰ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ä¸‹é¢çš„ä»£ç æ¥è·å–è™šæ‹Ÿæœºçš„ç›¸å…³å†…å­˜ä¿¡æ¯ã€‚</p><pre><code>public class JVMMemory {
    public static void main(String[] args) {
        // è¿”å› Java è™šæ‹Ÿæœºè¯•å›¾ä½¿ç”¨çš„æœ€å¤§å†…å­˜é‡
        long maxMemory = Runtime.getRuntime().maxMemory();
        System.out.println(&quot;MAX_MEMORY = &quot; + maxMemory + &quot;ï¼ˆå­—èŠ‚ï¼‰ã€&quot; + (maxMemory / (double) 1024 / 1024) + &quot;MB&quot;);
        // è¿”å› Java è™šæ‹Ÿæœºä¸­çš„å†…å­˜æ€»é‡
        long totalMemory = Runtime.getRuntime().totalMemory();
        System.out.println(&quot;TOTAL_MEMORY = &quot; + totalMemory + &quot;ï¼ˆå­—èŠ‚ï¼‰ã€&quot; + (totalMemory / (double) 1024 / 1024) + &quot;MB&quot;);
    }
}
</code></pre><p>è¿è¡Œç»“æœå¦‚ä¸‹ï¼š</p><div class="language-java line-numbers-mode" data-highlighter="shiki" data-ext="java" data-title="java" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">MAX_MEMORY </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 1888485376</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">ï¼ˆå­—èŠ‚ï¼‰ã€1801</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:white;--shiki-dark:#FFFFFF;">0MB</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">TOTAL_MEMORY </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 128974848</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">ï¼ˆå­—èŠ‚ï¼‰ã€123</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:white;--shiki-dark:#FFFFFF;">0MB</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;">Process</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;"> finished with exit code </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">0</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>æœ‰äººå°±æœ‰ç–‘é—®äº†ï¼Œè¿™ä¸ª<code>1801.0MB</code>å’Œ<code>123.0MB</code>æ˜¯æ€ä¹ˆç®—å‡ºæ¥çš„ï¼Ÿçœ‹ä¸‹å›¾å°±æ˜ç™½äº†ï¼Œè™šæ‹Ÿæœºæœ€å¤§å†…å­˜ä¸ºç‰©ç†å†…å­˜çš„ 1/4ï¼Œè€Œåˆå§‹åˆ†é…çš„å†…å­˜ä¸ºç‰©ç†å†…å­˜çš„ 1/64ã€‚<br><img src="/blog/assets/img/20200807124758835.984df797.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" loading="lazy"><br> IDEA ä¸­å¦‚ä½•é…ç½® JVM å†…å­˜å‚æ•°ï¼Ÿåœ¨ã€Runã€‘-&gt;ã€Edit Configurationâ€¦ã€‘-&gt;ã€VM optionsã€‘ä¸­ï¼Œè¾“å…¥å‚æ•°<code>-Xms1024m -Xmx1024m -XX:+PrintGCDetails</code>ï¼Œç„¶åä¿å­˜é€€å‡ºã€‚<br><img src="/blog/assets/img/2020080714041120.8bfb199b.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" loading="lazy"><br> è¿è¡Œç»“æœå¦‚ä¸‹ï¼š</p><figure><img src="/blog/assets/img/20200807141114216.dc109fa2.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" tabindex="0" loading="lazy"><figcaption>åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°</figcaption></figure><blockquote><p><strong>JVM çš„åˆå§‹å†…å­˜å’Œæœ€å¤§å†…å­˜ä¸€èˆ¬æ€ä¹ˆé…ï¼Ÿ</strong><br> ç­”ï¼šåˆå§‹å†…å­˜å’Œæœ€å¤§å†…å­˜ä¸€å®šæ˜¯ä¸€æ ·å¤§ï¼Œç†ç”±æ˜¯é¿å… GC å’Œåº”ç”¨ç¨‹åºäº‰æŠ¢å†…å­˜ï¼Œè¿›è€Œå¯¼è‡´å†…å­˜å¿½é«˜å¿½ä½äº§ç”Ÿåœé¡¿ã€‚</p></blockquote><h3 id="_8-7-å †æº¢å‡º-outofmemoryerror" tabindex="-1"><a class="header-anchor" href="#_8-7-å †æº¢å‡º-outofmemoryerror"><span>8.7 å †æº¢å‡º OutOfMemoryError</span></a></h3><p>ç°åœ¨æˆ‘ä»¬æ¥æ¼”ç¤ºä¸€ä¸‹<code>OOM</code>ï¼Œé¦–å…ˆæŠŠå †å†…å­˜è°ƒæˆ 10M åï¼Œå†ä¸€ç›´ new å¯¹è±¡ï¼Œå¯¼è‡´ Full GC ä¹Ÿæ— æ³•å¤„ç†ï¼Œç›´è‡³æ’‘çˆ†å †å†…å­˜ï¼Œè¿›è€Œå¯¼è‡´<code>OOM</code>å †æº¢å‡ºé”™è¯¯ï¼Œç¨‹åºåŠç»“æœå¦‚ä¸‹ï¼š</p><blockquote><p>å‚æ•°è®¾ç½®ï¼š <code>-Xms10m -Xmx10m -XX:+PrintGCDetails</code></p></blockquote><div class="language-java line-numbers-mode" data-highlighter="shiki" data-ext="java" data-title="java" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">public</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> class</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> OOMTest</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    public</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> static</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> void</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> main</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;">String</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[] </span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">args</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;">        String</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> str</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &quot;xiaofeipeng&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">        while</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">true</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-dark:#7F848E;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;">            // æ¯æ‰§è¡Œä¸‹é¢è¯­å¥ï¼Œä¼šåœ¨å †é‡Œåˆ›å»ºæ–°çš„å¯¹è±¡</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">            str </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">+=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> str </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">+</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> new</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> Random</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">().</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">nextInt</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">88888888</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">+</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> new</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> Random</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">().</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">nextInt</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">999999999</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">        }</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-dark:#7F848E;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;">        // -Xms -XmX 10m</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-dark:#7F848E;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;">        //byte[] bytes = new byte[40*1024*1024];</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    }</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="/blog/assets/img/20200807143709937.99020921.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" tabindex="0" loading="lazy"><figcaption>åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°</figcaption></figure><blockquote><p>å¦‚æœå‡ºç°<code>java.lang.OutOfMemoryError: Java heap space</code>å¼‚å¸¸ï¼Œè¯´æ˜ Java è™šæ‹Ÿæœºçš„å †å†…å­˜ä¸å¤Ÿï¼Œé€ æˆå †å†…å­˜æº¢å‡ºã€‚åŸå› æœ‰ä¸¤ç‚¹ï¼š<br> â‘ Java è™šæ‹Ÿæœºçš„å †å†…å­˜è®¾ç½®å¤ªå°ï¼Œå¯ä»¥é€šè¿‡å‚æ•°<code>-Xms</code>å’Œ<code>-Xmx</code>æ¥è°ƒæ•´ã€‚<br> â‘¡ ä»£ç ä¸­åˆ›å»ºäº†å¤§é‡å¯¹è±¡ï¼Œå¹¶ä¸”é•¿æ—¶é—´ä¸èƒ½è¢« GC å›æ”¶ï¼ˆå­˜åœ¨è¢«å¼•ç”¨ï¼‰ã€‚</p></blockquote><h2 id="_9-gc-java-garbage-collection" tabindex="-1"><a class="header-anchor" href="#_9-gc-java-garbage-collection"><span>9. GCï¼ˆJava Garbage Collectionï¼‰</span></a></h2><h3 id="_9-1-gc-åƒåœ¾æ”¶é›†æœºåˆ¶" tabindex="-1"><a class="header-anchor" href="#_9-1-gc-åƒåœ¾æ”¶é›†æœºåˆ¶"><span>9.1 GC åƒåœ¾æ”¶é›†æœºåˆ¶</span></a></h3><p>å¯¹äº GC åƒåœ¾æ”¶é›†æœºåˆ¶ï¼Œæˆ‘ä»¬éœ€è¦è®°ä½ä»¥ä¸‹å‡ ç‚¹ï¼š</p><ol><li>æ¬¡æ•°ä¸Šé¢‘ç¹æ”¶é›† Young åŒºã€‚</li><li>æ¬¡æ•°ä¸Šè¾ƒå°‘æ”¶é›† Old åŒºã€‚</li><li>åŸºæœ¬ä¸åŠ¨å…ƒç©ºé—´ã€‚</li></ol><p><img src="/blog/assets/img/2020080716523497.3aa56db7.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" loading="lazy"><br><img src="/blog/assets/img/20200807154231426.fb170ff0.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" loading="lazy"><br> JVM åœ¨è¿›è¡Œ GC æ—¶ï¼Œå¹¶éæ¯æ¬¡éƒ½å¯¹ä¸Šé¢ä¸‰ä¸ªå†…å­˜åŒºåŸŸä¸€èµ·å›æ”¶çš„ï¼Œå¤§éƒ¨åˆ†æ—¶å€™å›æ”¶çš„éƒ½æ˜¯æŒ‡æ–°ç”Ÿä»£ã€‚<br> å› æ­¤ GC æŒ‰ç…§å›æ”¶çš„åŒºåŸŸåˆåˆ†äº†ä¸¤ç§ç±»å‹ï¼Œä¸€ç§æ˜¯æ™®é€š GCï¼ˆminor GCï¼‰ï¼Œä¸€ç§æ˜¯å…¨å±€ GCï¼ˆmajor GC or Full GCï¼‰</p><p><strong>Minor GC å’Œ Full GC çš„åŒºåˆ«ï¼š</strong><br><strong>ï¼ˆ1ï¼‰æ™®é€š GCï¼ˆminor GCï¼‰</strong>ï¼šåªé’ˆå¯¹æ–°ç”Ÿä»£åŒºåŸŸçš„ GCï¼ŒæŒ‡å‘ç”Ÿåœ¨æ–°ç”Ÿä»£çš„åƒåœ¾æ”¶é›†åŠ¨ä½œï¼Œå› ä¸ºå¤§å¤šæ•° Java å¯¹è±¡å­˜æ´»ç‡éƒ½ä¸é«˜ï¼Œæ‰€ä»¥ Minor GC éå¸¸é¢‘ç¹ï¼Œä¸€èˆ¬å›æ”¶é€Ÿåº¦ä¹Ÿæ¯”è¾ƒå¿«ã€‚<br><strong>ï¼ˆ2ï¼‰å…¨å±€ GCï¼ˆmajor GC or Full GCï¼‰</strong>ï¼šæŒ‡å‘ç”Ÿåœ¨è€å¹´ä»£çš„åƒåœ¾æ”¶é›†åŠ¨ä½œï¼Œå‡ºç°äº† Major GCï¼Œç»å¸¸ä¼šä¼´éšè‡³å°‘ä¸€æ¬¡çš„ Minor GCï¼ˆä½†å¹¶ä¸æ˜¯ç»å¯¹çš„ï¼‰ã€‚Major GC çš„é€Ÿåº¦ä¸€èˆ¬è¦æ¯” Minor GC æ…¢ä¸Š 10 å€ä»¥ä¸Š</p><h3 id="_9-2-gc-æ—¥å¿—ä¿¡æ¯è¯¦è§£" tabindex="-1"><a class="header-anchor" href="#_9-2-gc-æ—¥å¿—ä¿¡æ¯è¯¦è§£"><span>9.2 GC æ—¥å¿—ä¿¡æ¯è¯¦è§£</span></a></h3><p>é€šè¿‡ä¸Šé¢<code>OOM</code>æ¡ˆä¾‹ï¼Œæ˜¯ä¸æ˜¯è§‰å¾—é‚£ä¸€å¤§ç‰‡çš„æ—¥å¿—ä¿¡æ¯çœ‹ä¸æ‡‚ï¼Ÿæ‡µé€¼ï¼Ÿæ²¡äº‹ï¼Œé€šè¿‡ä¸‹å›¾ä½ å°±çŸ¥é“å¦‚ä½•é˜…è¯» GC æ—¥å¿—ä¿¡æ¯ã€‚</p><p><strong>ï¼ˆ1ï¼‰YGC ç›¸å…³å‚æ•°ï¼š</strong><br><img src="/blog/assets/img/20200807151938212.a6d532cd.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" loading="lazy"><br><strong>ï¼ˆ2ï¼‰FGC ç›¸å…³å‚æ•°ï¼š</strong><br><img src="/blog/assets/img/20200807153518837.c570f8f2.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" loading="lazy"></p><h3 id="_9-3-gc-å››å¤§ç®—æ³•" tabindex="-1"><a class="header-anchor" href="#_9-3-gc-å››å¤§ç®—æ³•"><span>9.3 GC å››å¤§ç®—æ³•</span></a></h3><ol><li>å¼•ç”¨è®¡æ•°æ³•</li><li>å¤åˆ¶ç®—æ³•ï¼ˆCopyingï¼‰</li><li>æ ‡è®°æ¸…é™¤ï¼ˆMark-Sweepï¼‰</li><li>æ ‡è®°å‹ç¼©ï¼ˆMark-Compactï¼‰</li></ol><h2 id="_0-å¦‚ä½•åˆ¤æ–­javaä¸­å¯¹è±¡æ˜¯å¦å­˜æ´»" tabindex="-1"><a class="header-anchor" href="#_0-å¦‚ä½•åˆ¤æ–­javaä¸­å¯¹è±¡æ˜¯å¦å­˜æ´»"><span>0. å¦‚ä½•åˆ¤æ–­Javaä¸­å¯¹è±¡æ˜¯å¦å­˜æ´»ï¼Ÿ</span></a></h2><hr><h3 id="_0-1-å¼•ç”¨è®¡æ•°ç®—æ³•" tabindex="-1"><a class="header-anchor" href="#_0-1-å¼•ç”¨è®¡æ•°ç®—æ³•"><span>0.1 å¼•ç”¨è®¡æ•°ç®—æ³•</span></a></h3><p><strong>å¼•ç”¨è®¡æ•°ç®—æ³•</strong>æ˜¯ç»™æ¯ä¸ªå¯¹è±¡è®¾ç½®ä¸€ä¸ªè®¡æ•°å™¨ï¼Œå½“æœ‰åœ°æ–¹å¼•ç”¨è¿™ä¸ªå¯¹è±¡çš„æ—¶å€™ï¼Œè®¡æ•°å™¨+1ï¼Œå½“å¼•ç”¨å¤±æ•ˆçš„æ—¶å€™ï¼Œè®¡æ•°å™¨-1ï¼Œå½“è®¡æ•°å™¨ä¸º0çš„æ—¶å€™ï¼ŒJVMå°±è®¤ä¸ºè¯¥å¯¹è±¡ä¸å†è¢«ä½¿ç”¨ï¼Œæ˜¯â€œåƒåœ¾â€äº†ã€‚</p><p>å¼•ç”¨è®¡æ•°å®ç°ç®€å•ï¼Œæ•ˆç‡é«˜ï¼›ä½†æ˜¯ä¸èƒ½è§£å†³å¾ªç¯å¼•ç”¨é—®é—®é¢˜ï¼ˆAå¯¹è±¡å¼•ç”¨Bå¯¹è±¡ï¼ŒBå¯¹è±¡åˆå¼•ç”¨Aå¯¹è±¡ï¼Œä½†æ˜¯Aï¼ŒBå¯¹è±¡å·²ä¸è¢«ä»»ä½•å…¶ä»–å¯¹è±¡å¼•ç”¨ï¼‰ï¼ŒåŒæ—¶æ¯æ¬¡è®¡æ•°å™¨çš„å¢åŠ å’Œå‡å°‘éƒ½å¸¦æ¥äº†å¾ˆå¤šé¢å¤–çš„å¼€é”€ï¼Œæ‰€ä»¥åœ¨JDK1.1ä¹‹åï¼Œè¿™ä¸ªç®—æ³•å·²ç»ä¸å†ä½¿ç”¨äº†ã€‚<br><img src="/blog/assets/img/20200807170516550.57bd26d5.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" loading="lazy"></p><h3 id="_0-2-æ ¹æœç´¢æ–¹æ³•" tabindex="-1"><a class="header-anchor" href="#_0-2-æ ¹æœç´¢æ–¹æ³•"><span>0.2 æ ¹æœç´¢æ–¹æ³•</span></a></h3><p><strong>æ ¹æœç´¢æ–¹æ³•</strong>æ˜¯é€šè¿‡ä¸€äº›<code>GCRoots</code>å¯¹è±¡ä½œä¸ºèµ·ç‚¹ï¼Œä»è¿™äº›èŠ‚ç‚¹å¼€å§‹å¾€ä¸‹æœç´¢ï¼Œæœç´¢é€šè¿‡çš„è·¯å¾„æˆä¸ºå¼•ç”¨é“¾ï¼ˆReferenceChainï¼‰ï¼Œå½“ä¸€ä¸ªå¯¹è±¡æ²¡æœ‰è¢«<code>GCRoots</code>çš„å¼•ç”¨é“¾è¿æ¥çš„æ—¶å€™ï¼Œè¯´æ˜è¿™ä¸ªå¯¹è±¡æ˜¯ä¸å¯ç”¨çš„ã€‚</p><p><strong>GCRootså¯¹è±¡åŒ…æ‹¬ï¼š</strong></p><ol><li>è™šæ‹Ÿæœºæ ˆï¼ˆæ ˆå¸§ä¸­çš„æœ¬åœ°å˜é‡è¡¨ï¼‰ä¸­çš„å¼•ç”¨çš„å¯¹è±¡ã€‚</li><li>æ–¹æ³•åŒºåŸŸä¸­çš„ç±»é™æ€å±æ€§å¼•ç”¨çš„å¯¹è±¡ã€‚</li><li>æ–¹æ³•åŒºåŸŸä¸­å¸¸é‡å¼•ç”¨çš„å¯¹è±¡ã€‚</li><li>æ–¹æ³•æ ˆä¸­JNIï¼ˆ<code>Native</code>æ–¹æ³•ï¼‰çš„å¼•ç”¨çš„å¯¹è±¡ã€‚<br><img src="/blog/assets/img/20200807180534899.b6e0434e.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" loading="lazy"></li></ol><h2 id="_1-å¤åˆ¶ç®—æ³•-copying-é€‚ç”¨äºæ–°ç”Ÿä»£" tabindex="-1"><a class="header-anchor" href="#_1-å¤åˆ¶ç®—æ³•-copying-é€‚ç”¨äºæ–°ç”Ÿä»£"><span>1. å¤åˆ¶ç®—æ³•ï¼ˆCopyingï¼‰ï¼šé€‚ç”¨äºæ–°ç”Ÿä»£</span></a></h2><h3 id="_1-1-åŸç†åˆ†æ" tabindex="-1"><a class="header-anchor" href="#_1-1-åŸç†åˆ†æ"><span>1.1 åŸç†åˆ†æ</span></a></h3><p>è™šæ‹ŸæœºæŠŠæ–°ç”Ÿä»£åˆ†ä¸ºäº†ä¸‰éƒ¨åˆ†ï¼š1ä¸ª<code>Eden</code>åŒºå’Œ2ä¸ª<code>Survivor</code>åŒºï¼ˆåˆ†åˆ«å«<code>from</code>å’Œ<code>to</code>ï¼‰ï¼Œé»˜è®¤æ¯”ä¾‹ä¸º8:1:1ã€‚</p><p>ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œæ–°åˆ›å»ºçš„å¯¹è±¡éƒ½ä¼šè¢«åˆ†é…åˆ°<code>Eden</code>åŒºï¼ˆä¸€äº›å¤§å¯¹è±¡ç‰¹æ®Šå¤„ç†ï¼‰ï¼Œè¿™äº›å¯¹è±¡ç»è¿‡ç¬¬ä¸€æ¬¡<code>Minor GC</code>åï¼Œå¦‚æœä»ç„¶å­˜æ´»ï¼Œå°†ä¼šè¢«ç§»åˆ°<code>Survivor</code>åŒºã€‚å¯¹è±¡åœ¨<code>Survivor</code>åŒºä¸­æ¯ç†¬è¿‡ä¸€æ¬¡<code>Minor GC</code>ï¼Œå¹´é¾„ +1ï¼Œå½“å®ƒçš„å¹´é¾„å¢åŠ åˆ°ä¸€å®šç¨‹åº¦æ—¶ï¼ˆé»˜è®¤æ˜¯ 15 ï¼Œé€šè¿‡<code>-XX:MaxTenuringThreshold</code>æ¥è®¾å®šå‚æ•°ï¼‰ï¼Œå°±ä¼šè¢«ç§»åŠ¨åˆ°å¹´è€ä»£ä¸­ã€‚</p><p>å› ä¸ºæ–°ç”Ÿä»£ä¸­çš„å¯¹è±¡åŸºæœ¬éƒ½æ˜¯<strong>æœç”Ÿå¤•æ­»</strong>ï¼ˆè¢«GCå›æ”¶ç‡90%ä»¥ä¸Šï¼‰ï¼Œ<strong>æ‰€ä»¥åœ¨æ–°ç”Ÿä»£çš„åƒåœ¾å›æ”¶ç®—æ³•ä½¿ç”¨çš„æ˜¯å¤åˆ¶ç®—æ³•</strong>ã€‚</p><p>å¤åˆ¶ç®—æ³•çš„åŸºæœ¬æ€æƒ³å°±æ˜¯å°†å†…å­˜åˆ†ä¸ºä¸¤å—ï¼Œæ¯æ¬¡åªç”¨å…¶ä¸­ä¸€å—ï¼Œå½“è¿™ä¸€å—å†…å­˜ç”¨å®Œï¼Œå°±å°†è¿˜æ´»ç€çš„å¯¹è±¡å¤åˆ¶åˆ°å¦å¤–ä¸€å—ä¸Šé¢ã€‚<code>å¤åˆ¶ç®—æ³•ä¸ä¼šäº§ç”Ÿå†…å­˜ç¢ç‰‡</code>ã€‚</p><p>æˆ‘ä»¬åœ¨GCå¼€å§‹çš„æ—¶å€™ï¼Œå¯¹è±¡åªä¼šå­˜åœ¨äº<code>Eden</code>åŒºå’Œåä¸º<code>from</code>çš„<code>Survivor</code>åŒºï¼Œ<code>Survivor</code>åŒº<code>to</code>æ˜¯ç©ºçš„ã€‚ç´§æ¥ç€è¿›è¡ŒGCï¼Œ<code>Eden</code>åŒºä¸­æ‰€æœ‰å­˜æ´»çš„å¯¹è±¡éƒ½ä¼šè¢«å¤åˆ¶åˆ°<code>to</code>ï¼Œè€Œåœ¨<code>from</code>åŒºä¸­ï¼Œä»å­˜æ´»çš„å¯¹è±¡ä¼šæ ¹æ®ä»–ä»¬çš„å¹´é¾„å€¼æ¥å†³å®šå»å‘ã€‚å¹´é¾„è¾¾åˆ°ä¸€å®šå€¼ï¼ˆé»˜è®¤15ï¼‰çš„å¯¹è±¡ä¼šè¢«ç§»åŠ¨åˆ°è€å¹´ä»£ä¸­ï¼Œæ²¡æœ‰è¾¾åˆ°é˜ˆå€¼çš„å¯¹è±¡ä¼šè¢«å¤åˆ¶åˆ°<code>to</code>åŒºåŸŸã€‚ <code>ç»è¿‡è¿™æ¬¡GCåï¼ŒEdenåŒºå’ŒfromåŒºå·²ç»è¢«æ¸…ç©ºã€‚è¿™ä¸ªæ—¶å€™ï¼Œfromå’Œtoä¼šäº¤æ¢ä»–ä»¬çš„è§’è‰²ï¼Œä¹Ÿå°±æ˜¯æ–°çš„toå°±æ˜¯ä¸Šæ¬¡GCå‰çš„fromï¼Œæ–°çš„fromå°±æ˜¯ä¸Šæ¬¡GCå‰çš„toã€‚</code>ä¸ç®¡æ€æ ·ï¼Œéƒ½ä¼šä¿è¯åä¸º<code>to</code>çš„<code>Survivor</code>åŒºåŸŸæ˜¯ç©ºçš„ã€‚<code>Minor GC</code>ä¼šä¸€ç›´é‡å¤è¿™æ ·çš„è¿‡ç¨‹ï¼Œç›´åˆ°<code>to</code>åŒºè¢«å¡«æ»¡ï¼Œ<code>to</code>åŒºè¢«å¡«æ»¡ä¹‹åï¼Œä¼šå°†æ‰€æœ‰å¯¹è±¡ç§»åŠ¨åˆ°è€å¹´ä»£ä¸­ã€‚<br><img src="/blog/assets/img/20200807183357142.945a84da.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" loading="lazy"></p><blockquote><p><code>-XX:MaxTenuringThreshold</code>ï¼Œè®¾ç½®å¯¹è±¡åœ¨æ–°ç”Ÿä»£ä¸­å­˜æ´»çš„æ¬¡æ•°ã€‚</p></blockquote><p>å› ä¸º<code>Eden</code>åŒºå¯¹è±¡ä¸€èˆ¬å­˜æ´»ç‡è¾ƒä½ï¼Œä¸€èˆ¬çš„ï¼Œä½¿ç”¨ä¸¤å—10%çš„å†…å­˜ä½œä¸ºç©ºé—²å’Œæ´»åŠ¨åŒºé—´ï¼Œè€Œå¦å¤–80%çš„å†…å­˜ï¼Œåˆ™æ˜¯ç”¨æ¥ç»™æ–°å»ºå¯¹è±¡åˆ†é…å†…å­˜çš„ã€‚ä¸€æ—¦å‘ç”ŸGCï¼Œå°†10%çš„<code>from</code>æ´»åŠ¨åŒºé—´ä¸å¦å¤–80%ä¸­å­˜æ´»çš„<code>Eden</code>åŒºå¯¹è±¡è½¬ç§»åˆ°10%çš„<code>to</code>ç©ºé—²åŒºé—´ï¼Œæ¥ä¸‹æ¥ï¼Œå°†ä¹‹å‰90%çš„å†…å­˜å…¨éƒ¨é‡Šæ”¾ï¼Œä»¥æ­¤ç±»æ¨ã€‚<br><img src="/blog/assets/img/20200807160818909.5445990e.gif" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" loading="lazy"><br> ä¸Šé¢åŠ¨ç”»ä¸­ï¼ŒAreaç©ºé—²ä»£è¡¨toï¼ŒAreaæ¿€æ´»ä»£è¡¨fromï¼Œç»¿è‰²ä»£è¡¨ä¸è¢«å›æ”¶çš„ï¼Œçº¢è‰²ä»£è¡¨è¢«å›æ”¶çš„ã€‚</p><h3 id="_1-2-ä¼˜ç¼ºç‚¹" tabindex="-1"><a class="header-anchor" href="#_1-2-ä¼˜ç¼ºç‚¹"><span>1.2 ä¼˜ç¼ºç‚¹</span></a></h3><p><strong>ä¼˜ç‚¹</strong> ï¼šä¸ä¼šäº§ç”Ÿå†…å­˜ç¢ç‰‡ï¼Œæ•ˆç‡é«˜ã€‚<br><strong>ç¼ºç‚¹</strong> ï¼šè€—è´¹å†…å­˜ç©ºé—´ã€‚</p><p>å¦‚æœå¯¹è±¡çš„å­˜æ´»ç‡å¾ˆé«˜ï¼Œæˆ‘ä»¬å¯ä»¥æç«¯ä¸€ç‚¹ï¼Œå‡è®¾æ˜¯100%å­˜æ´»ï¼Œé‚£ä¹ˆæˆ‘ä»¬éœ€è¦å°†æ‰€æœ‰å¯¹è±¡éƒ½å¤åˆ¶ä¸€éï¼Œå¹¶å°†æ‰€æœ‰å¼•ç”¨åœ°å€é‡ç½®ä¸€éã€‚å¤åˆ¶è¿™ä¸€å·¥ä½œæ‰€èŠ±è´¹çš„æ—¶é—´ï¼Œåœ¨å¯¹è±¡å­˜æ´»ç‡è¾¾åˆ°ä¸€å®šç¨‹åº¦æ—¶ï¼Œå°†ä¼šå˜çš„ä¸å¯å¿½è§†ã€‚</p><p>æ‰€ä»¥ä»ä»¥ä¸Šæè¿°ä¸éš¾çœ‹å‡ºï¼Œå¤åˆ¶ç®—æ³•è¦æƒ³ä½¿ç”¨ï¼Œæœ€èµ·ç å¯¹è±¡çš„å­˜æ´»ç‡è¦éå¸¸ä½æ‰è¡Œï¼Œè€Œä¸”æœ€é‡è¦çš„æ˜¯ï¼Œæˆ‘ä»¬å¿…é¡»è¦å…‹æœ50%å†…å­˜çš„æµªè´¹ã€‚</p><h2 id="_2-æ ‡è®°æ¸…é™¤-mark-sweep-é€‚ç”¨äºè€å¹´ä»£" tabindex="-1"><a class="header-anchor" href="#_2-æ ‡è®°æ¸…é™¤-mark-sweep-é€‚ç”¨äºè€å¹´ä»£"><span>2. æ ‡è®°æ¸…é™¤ï¼ˆMark-Sweepï¼‰ï¼šé€‚ç”¨äºè€å¹´ä»£</span></a></h2><h3 id="_2-1-åŸç†åˆ†æ" tabindex="-1"><a class="header-anchor" href="#_2-1-åŸç†åˆ†æ"><span>2.1 åŸç†åˆ†æ</span></a></h3><p>æ ‡è®°æ¸…é™¤ç®—æ³•ï¼Œä¸»è¦åˆ†æˆæ ‡è®°å’Œæ¸…é™¤ä¸¤ä¸ªé˜¶æ®µï¼Œå…ˆæ ‡è®°å‡ºè¦å›æ”¶çš„å¯¹è±¡ï¼Œç„¶åç»Ÿä¸€å›æ”¶è¿™äº›å¯¹è±¡ï¼Œå¦‚ä¸‹å›¾ï¼š<br><img src="/blog/assets/img/20200807184746659.7b4a81bd.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" loading="lazy"><br> ç®€å•æ¥è¯´ï¼Œæ ‡è®°æ¸…é™¤ç®—æ³•å°±æ˜¯å½“ç¨‹åºè¿è¡ŒæœŸé—´ï¼Œè‹¥å¯ä»¥ä½¿ç”¨çš„å†…å­˜è¢«è€—å°½çš„æ—¶å€™ï¼ŒGCçº¿ç¨‹å°±ä¼šè¢«è§¦å‘å¹¶å°†ç¨‹åºæš‚åœï¼Œéšåå°†è¦å›æ”¶çš„å¯¹è±¡æ ‡è®°ä¸€éï¼Œæœ€ç»ˆç»Ÿä¸€å›æ”¶è¿™äº›å¯¹è±¡ï¼Œå®Œæˆæ ‡è®°æ¸…ç†å·¥ä½œæ¥ä¸‹æ¥ä¾¿è®©åº”ç”¨ç¨‹åºæ¢å¤è¿è¡Œã€‚</p><p>ä¸»è¦è¿›è¡Œä¸¤é¡¹å·¥ä½œï¼Œç¬¬ä¸€é¡¹åˆ™æ˜¯æ ‡è®°ï¼Œç¬¬äºŒé¡¹åˆ™æ˜¯æ¸…é™¤ã€‚</p><ul><li>æ ‡è®°ï¼šä»å¼•ç”¨æ ¹èŠ‚ç‚¹å¼€å§‹æ ‡è®°éå†æ‰€æœ‰çš„<code>GC Roots</code>ï¼Œ å…ˆæ ‡è®°å‡ºè¦å›æ”¶çš„å¯¹è±¡ã€‚</li><li>æ¸…é™¤ï¼šéå†æ•´ä¸ªå †ï¼ŒæŠŠæ ‡è®°çš„å¯¹è±¡æ¸…é™¤ã€‚<br><img src="/blog/assets/img/20200807160938544.cb5a4024.gif" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" loading="lazy"></li></ul><h3 id="_2-2-ä¼˜ç¼ºç‚¹" tabindex="-1"><a class="header-anchor" href="#_2-2-ä¼˜ç¼ºç‚¹"><span>2.2 ä¼˜ç¼ºç‚¹</span></a></h3><p><strong>ä¼˜ç‚¹</strong> ï¼šä¸éœ€è¦é¢å¤–çš„å†…å­˜ç©ºé—´ã€‚<br><strong>ç¼ºç‚¹</strong> ï¼šéœ€è¦æš‚åœæ•´ä¸ªåº”ç”¨ï¼Œä¼šäº§ç”Ÿå†…å­˜ç¢ç‰‡ï¼›ä¸¤æ¬¡æ‰«æï¼Œè€—æ—¶ä¸¥é‡ã€‚</p><p>ç®€å•æ¥è¯´ï¼Œå®ƒçš„ç¼ºç‚¹å°±æ˜¯<strong>æ•ˆç‡æ¯”è¾ƒä½</strong>ï¼ˆé€’å½’ä¸å…¨å †å¯¹è±¡éå†ï¼‰ï¼Œè€Œä¸”åœ¨è¿›è¡ŒGCçš„æ—¶å€™ï¼Œéœ€è¦åœæ­¢åº”ç”¨ç¨‹åºï¼Œè¿™ä¼šå¯¼è‡´ç”¨æˆ·ä½“éªŒéå¸¸å·®åŠ²ã€‚</p><p>è€Œä¸”è¿™ç§æ–¹å¼<strong>æ¸…ç†å‡ºæ¥çš„ç©ºé—²å†…å­˜æ˜¯ä¸è¿ç»­</strong>çš„ï¼Œè¿™ç‚¹ä¸éš¾ç†è§£ï¼Œæˆ‘ä»¬çš„æ­»äº¡å¯¹è±¡éƒ½æ˜¯éšæœºåˆ†å¸ƒåœ¨å†…å­˜å½“ä¸­ï¼Œç°åœ¨æŠŠå®ƒä»¬æ¸…é™¤ä¹‹åï¼Œå†…å­˜çš„å¸ƒå±€è‡ªç„¶ä¼šé›¶ç¢ä¸è¿ç»­ã€‚è€Œä¸ºäº†åº”ä»˜è¿™ä¸€ç‚¹ï¼ŒJVMå°±ä¸å¾—ä¸ç»´æŒä¸€ä¸ªå†…å­˜çš„ç©ºé—²åˆ—è¡¨ï¼Œè¿™åˆæ˜¯ä¸€ç§å¼€é”€ã€‚å¹¶ä¸”åœ¨åˆ†é…æ•°ç»„å¯¹è±¡çš„æ—¶å€™ï¼Œéœ€è¦å»å†…å­˜å¯»æ‰¾è¿ç»­çš„å†…å­˜ç©ºé—´ï¼Œä½†æ­¤æ—¶çš„å†…å­˜ç©ºé—´å¤ªè¿‡é›¶ç¢åˆ†æ•£ï¼Œå› æ­¤èµ„æºè€—è´¹åŠ å¤§ã€‚</p><h2 id="_3-æ ‡è®°å‹ç¼©-mark-compact-é€‚ç”¨äºè€å¹´ä»£" tabindex="-1"><a class="header-anchor" href="#_3-æ ‡è®°å‹ç¼©-mark-compact-é€‚ç”¨äºè€å¹´ä»£"><span>3. æ ‡è®°å‹ç¼©ï¼ˆMark-Compactï¼‰ï¼šé€‚ç”¨äºè€å¹´ä»£</span></a></h2><h3 id="_3-1-åŸç†åˆ†æ" tabindex="-1"><a class="header-anchor" href="#_3-1-åŸç†åˆ†æ"><span>3.1 åŸç†åˆ†æ</span></a></h3><p>ç®€å•æ¥è¯´ï¼Œå°±æ˜¯<strong>å…ˆæ ‡è®°ï¼Œåæ•´ç†</strong>ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š<br><img src="/blog/assets/img/20200807185820542.5dc811bc.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" loading="lazy"><br><img src="/blog/assets/img/20200807161246378.59bc425a.gif" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" loading="lazy"></p><h3 id="_3-2-ä¼˜ç¼ºç‚¹" tabindex="-1"><a class="header-anchor" href="#_3-2-ä¼˜ç¼ºç‚¹"><span>3.2 ä¼˜ç¼ºç‚¹</span></a></h3><p><strong>ä¼˜ç‚¹</strong> ï¼šæ²¡æœ‰å†…å­˜ç¢ç‰‡ã€‚<br><strong>ç¼ºç‚¹</strong> ï¼šéœ€è¦ç§»åŠ¨å¯¹è±¡çš„æˆæœ¬ï¼Œæ•ˆç‡ä¹Ÿä¸é«˜ï¼ˆä¸ä»…è¦æ ‡è®°æ‰€æœ‰å­˜æ´»å¯¹è±¡ï¼Œè¿˜è¦æ•´ç†æ‰€æœ‰å­˜æ´»å¯¹è±¡çš„å¼•ç”¨åœ°å€ï¼‰ã€‚</p><h3 id="_3-3-æ ‡è®°æ¸…é™¤å‹ç¼©-mark-sweep-compact" tabindex="-1"><a class="header-anchor" href="#_3-3-æ ‡è®°æ¸…é™¤å‹ç¼©-mark-sweep-compact"><span>3.3 æ ‡è®°æ¸…é™¤å‹ç¼©ï¼ˆMark-Sweep-Compactï¼‰</span></a></h3><figure><img src="/blog/assets/img/20200807190452284.49778932.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" tabindex="0" loading="lazy"><figcaption>åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°</figcaption></figure><h2 id="_4-åˆ†ä»£æ”¶é›†ç®—æ³•" tabindex="-1"><a class="header-anchor" href="#_4-åˆ†ä»£æ”¶é›†ç®—æ³•"><span>4. åˆ†ä»£æ”¶é›†ç®—æ³•</span></a></h2><p>å½“å‰å•†ä¸šè™šæ‹Ÿæœºéƒ½æ˜¯é‡‡ç”¨åˆ†ä»£æ”¶é›†ç®—æ³•ï¼Œå®ƒæ ¹æ®å¯¹è±¡å­˜æ´»å‘¨æœŸçš„ä¸åŒå°†å†…å­˜åˆ’åˆ†ä¸ºå‡ å—ï¼Œä¸€èˆ¬æ˜¯æŠŠJavaå †åˆ†ä¸ºæ–°ç”Ÿä»£å’Œè€å¹´ä»£ï¼Œç„¶åæ ¹æ®å„ä¸ªå¹´ä»£çš„ç‰¹ç‚¹é‡‡ç”¨æœ€é€‚å½“çš„åƒåœ¾æ”¶é›†ç®—æ³•ã€‚<br> åœ¨æ–°ç”Ÿä»£ä¸­ï¼Œæ¯æ¬¡åƒåœ¾æ”¶é›†éƒ½å‘ç°æœ‰å¤§æ‰¹å¯¹è±¡æ­»å»ï¼Œåªæœ‰å°‘é‡å­˜æ´»ï¼Œå°±é€‰ç”¨<strong>å¤åˆ¶ç®—æ³•</strong>ï¼Œè€Œè€å¹´ä»£å› ä¸ºå¯¹è±¡å­˜æ´»ç‡é«˜ï¼Œæ²¡æœ‰é¢å¤–ç©ºé—´å¯¹å®ƒè¿›è¡Œåˆ†é…æ‹…ä¿ï¼Œå°±å¿…é¡»ä½¿ç”¨<strong>æ ‡è®°æ¸…é™¤</strong>æˆ–è€…<strong>æ ‡è®°å‹ç¼©</strong>ç®—æ³•æ¥è¿›è¡Œå›æ”¶ã€‚<br><img src="/blog/assets/img/20200807161123464.4974bc8c.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" loading="lazy"></p><h2 id="_5-æ€»ç»“" tabindex="-1"><a class="header-anchor" href="#_5-æ€»ç»“"><span>5. æ€»ç»“</span></a></h2><h3 id="_5-1-å¹´è½»ä»£-young-gen" tabindex="-1"><a class="header-anchor" href="#_5-1-å¹´è½»ä»£-young-gen"><span>5.1 å¹´è½»ä»£ï¼ˆYoung Genï¼‰</span></a></h3><p><strong>å¹´è½»ä»£ç‰¹ç‚¹æ˜¯å†…å­˜ç©ºé—´ç›¸å¯¹è€å¹´ä»£è¾ƒå°ï¼Œå¯¹è±¡å­˜æ´»ç‡ä½ã€‚</strong></p><p>å¤åˆ¶ç®—æ³•çš„æ•ˆç‡åªå’Œå½“å‰å­˜æ´»å¯¹è±¡å¤§å°æœ‰å…³ï¼Œå› è€Œå¾ˆé€‚ç”¨äºå¹´è½»ä»£çš„å›æ”¶ã€‚è€Œå¤åˆ¶ç®—æ³•çš„å†…å­˜åˆ©ç”¨ç‡ä¸é«˜çš„é—®é¢˜ï¼Œå¯ä»¥é€šè¿‡è™šæ‹Ÿæœºä¸­çš„ä¸¤ä¸ª<code>Survivor</code>åŒºè®¾è®¡å¾—åˆ°ç¼“è§£ã€‚</p><h3 id="_5-2-è€å¹´ä»£-tenure-gen" tabindex="-1"><a class="header-anchor" href="#_5-2-è€å¹´ä»£-tenure-gen"><span>5.2 è€å¹´ä»£ï¼ˆTenure Genï¼‰</span></a></h3><p><strong>è€å¹´ä»£çš„ç‰¹ç‚¹æ˜¯å†…å­˜ç©ºé—´è¾ƒå¤§ï¼Œå¯¹è±¡å­˜æ´»ç‡é«˜ã€‚</strong></p><p>è¿™ç§æƒ…å†µï¼Œå­˜åœ¨å¤§é‡å­˜æ´»ç‡é«˜çš„å¯¹è±¡ï¼Œå¤åˆ¶ç®—æ³•æ˜æ˜¾å˜å¾—ä¸åˆé€‚ã€‚ä¸€èˆ¬æ˜¯ç”±æ ‡è®°æ¸…é™¤æˆ–è€…æ˜¯æ ‡è®°æ¸…é™¤ä¸æ ‡è®°æ•´ç†çš„æ··åˆå®ç°ã€‚</p><p>ï¼ˆ1ï¼‰<strong>æ ‡è®°é˜¶æ®µï¼ˆMarkï¼‰</strong> çš„å¼€é”€ä¸å­˜æ´»å¯¹è±¡çš„æ•°é‡æˆæ­£æ¯”ã€‚è¿™ç‚¹ä¸Šè¯´æ¥ï¼Œå¯¹äºè€å¹´ä»£ï¼Œæ ‡è®°æ¸…é™¤æˆ–è€…æ ‡è®°æ•´ç†æœ‰ä¸€äº›ä¸ç¬¦ï¼Œä½†å¯ä»¥é€šè¿‡å¤šæ ¸/çº¿ç¨‹åˆ©ç”¨ï¼Œå¯¹å¹¶å‘ã€å¹¶è¡Œçš„å½¢å¼ææ ‡è®°æ•ˆç‡ã€‚<br> ï¼ˆ2ï¼‰<strong>æ¸…é™¤é˜¶æ®µï¼ˆSweepï¼‰</strong> çš„å¼€é”€ä¸æ‰€ç®¡ç†å†…å­˜ç©ºé—´å¤§å°å½¢æ­£ç›¸å…³ã€‚ä½†Sweepâ€œå°±åœ°å¤„å†³â€çš„ç‰¹ç‚¹ï¼Œå›æ”¶çš„è¿‡ç¨‹æ²¡æœ‰å¯¹è±¡çš„ç§»åŠ¨ã€‚ä½¿å…¶ç›¸å¯¹å…¶ä»–æœ‰å¯¹è±¡ç§»åŠ¨æ­¥éª¤çš„å›æ”¶ç®—æ³•ï¼Œä»ç„¶æ˜¯æ•ˆç‡æœ€å¥½çš„ã€‚ä½†æ˜¯éœ€è¦è§£å†³å†…å­˜ç¢ç‰‡é—®é¢˜ã€‚<br> ï¼ˆ3ï¼‰<strong>æ•´ç†é˜¶æ®µï¼ˆCompactï¼‰</strong> çš„å¼€é”€ä¸å­˜æ´»å¯¹è±¡çš„æ•°æ®æˆå¼€æ¯”ã€‚å¦‚ä¸Šä¸€æ¡æ‰€æè¿°ï¼Œå¯¹äºå¤§é‡å¯¹è±¡çš„ç§»åŠ¨æ˜¯å¾ˆå¤§å¼€é”€çš„ï¼Œåšä¸ºè€å¹´ä»£çš„ç¬¬ä¸€é€‰æ‹©å¹¶ä¸åˆé€‚ã€‚</p><p>åŸºäºä¸Šé¢çš„è€ƒè™‘ï¼Œè€å¹´ä»£ä¸€èˆ¬æ˜¯ç”±æ ‡è®°æ¸…é™¤æˆ–è€…æ˜¯æ ‡è®°æ¸…é™¤ä¸æ ‡è®°æ•´ç†çš„æ··åˆå®ç°ã€‚ä»¥è™šæ‹Ÿæœºä¸­çš„CMSå›æ”¶å™¨ä¸ºä¾‹ï¼ŒCMSæ˜¯åŸºäº<code>Mark-Sweep</code>å®ç°çš„ï¼Œå¯¹äºå¯¹è±¡çš„å›æ”¶æ•ˆç‡å¾ˆé«˜ã€‚è€Œå¯¹äºç¢ç‰‡é—®é¢˜ï¼ŒCMSé‡‡ç”¨åŸºäº<code>Mark-Compact</code>ç®—æ³•çš„Serial Oldå›æ”¶å™¨åšä¸ºè¡¥å¿æªæ–½ï¼šå½“å†…å­˜å›æ”¶ä¸ä½³ï¼ˆç¢ç‰‡å¯¼è‡´çš„<code>Concurrent Mode Failure</code>æ—¶ï¼‰ï¼Œå°†é‡‡ç”¨Serial Oldæ‰§è¡ŒFull GCä»¥è¾¾åˆ°å¯¹è€å¹´ä»£å†…å­˜çš„æ•´ç†ã€‚</p><blockquote><p>å‚è€ƒæ–‡ç« ï¼š<a href="https://www.jianshu.com/p/ba415aa2330b" target="_blank" rel="noopener noreferrer">OMM Errorå’Œä¸ƒå¤§åƒåœ¾å›æ”¶å™¨è¯¦è§£</a></p></blockquote><h2 id="_6-é™„å½•-å¸¸è§é¢è¯•é—®é¢˜" tabindex="-1"><a class="header-anchor" href="#_6-é™„å½•-å¸¸è§é¢è¯•é—®é¢˜"><span>6. é™„å½•.å¸¸è§é¢è¯•é—®é¢˜</span></a></h2><h3 id="_6-1-gcå››ç§ç®—æ³•å“ªä¸ªå¥½" tabindex="-1"><a class="header-anchor" href="#_6-1-gcå››ç§ç®—æ³•å“ªä¸ªå¥½"><span>6.1 GCå››ç§ç®—æ³•å“ªä¸ªå¥½ï¼Ÿ</span></a></h3><p>æ²¡æœ‰å“ªä¸ªç®—æ³•æ˜¯èƒ½ä¸€æ¬¡æ€§è§£å†³æ‰€æœ‰é—®é¢˜çš„ï¼Œå› ä¸ºJVMåƒåœ¾å›æ”¶ä½¿ç”¨çš„æ˜¯åˆ†ä»£æ”¶é›†ç®—æ³•ï¼Œæ²¡æœ‰æœ€å¥½çš„ç®—æ³•ï¼Œåªæœ‰æ ¹æ®æ¯ä¸€ä»£ä»–çš„åƒåœ¾å›æ”¶çš„ç‰¹æ€§ç”¨å¯¹åº”çš„ç®—æ³•ã€‚ä¾‹å¦‚æ–°ç”Ÿä»£ä½¿ç”¨å¤åˆ¶ç®—æ³•ï¼Œè€å¹´ä»£ä½¿ç”¨æ ‡è®°æ¸…é™¤å’Œæ ‡è®°æ•´ç†ç®—æ³•ã€‚<br> æ‰€ä»¥è¯´ï¼Œæ²¡æœ‰æœ€å¥½çš„åƒåœ¾å›æ”¶æœºåˆ¶ï¼Œåªæœ‰æœ€åˆé€‚çš„ã€‚</p><h3 id="_6-2-è¯·è¯´å‡ºå„ä¸ªåƒåœ¾å›æ”¶ç®—æ³•çš„ä¼˜ç¼ºç‚¹" tabindex="-1"><a class="header-anchor" href="#_6-2-è¯·è¯´å‡ºå„ä¸ªåƒåœ¾å›æ”¶ç®—æ³•çš„ä¼˜ç¼ºç‚¹"><span>6.2 è¯·è¯´å‡ºå„ä¸ªåƒåœ¾å›æ”¶ç®—æ³•çš„ä¼˜ç¼ºç‚¹</span></a></h3><p><strong>ï¼ˆ1ï¼‰å†…å­˜æ•ˆç‡ï¼š</strong> å¤åˆ¶ç®—æ³• &gt; æ ‡è®°æ¸…é™¤ç®—æ³• &gt; æ ‡è®°æ•´ç†ç®—æ³•ï¼ˆæ­¤å¤„çš„æ•ˆç‡åªæ˜¯ç®€å•çš„å¯¹æ¯”æ—¶é—´å¤æ‚åº¦ï¼Œå®é™…æƒ…å†µä¸ä¸€å®šå¦‚æ­¤ï¼‰ã€‚<br><strong>ï¼ˆ2ï¼‰å†…å­˜æ•´é½åº¦ï¼š</strong> å¤åˆ¶ç®—æ³• = æ ‡è®°æ•´ç†ç®—æ³• &gt; æ ‡è®°æ¸…é™¤ç®—æ³•ã€‚<br><strong>ï¼ˆ3ï¼‰å†…å­˜åˆ©ç”¨ç‡ï¼š</strong> æ ‡è®°æ•´ç†ç®—æ³• = æ ‡è®°æ¸…é™¤ç®—æ³• &gt; å¤åˆ¶ç®—æ³•ã€‚</p><p>å¯ä»¥çœ‹å‡ºï¼Œæ•ˆç‡ä¸Šæ¥è¯´ï¼Œå¤åˆ¶ç®—æ³•æ˜¯å½“ä¹‹æ— æ„§çš„è€å¤§ï¼Œä½†æ˜¯å´æµªè´¹äº†å¤ªå¤šå†…å­˜ï¼Œè€Œä¸ºäº†å°½é‡å…¼é¡¾ä¸Šé¢æ‰€æåˆ°çš„ä¸‰ä¸ªæŒ‡æ ‡ï¼Œæ ‡è®°æ•´ç†ç®—æ³•ç›¸å¯¹æ¥è¯´æ›´å¹³æ»‘ä¸€äº›ï¼Œä½†æ•ˆç‡ä¸Šä¾ç„¶ä¸å°½å¦‚äººæ„ï¼Œå®ƒæ¯”å¤åˆ¶ç®—æ³•å¤šäº†ä¸€ä¸ªæ ‡è®°çš„é˜¶æ®µï¼Œåˆæ¯”æ ‡è®°æ¸…é™¤å¤šäº†ä¸€ä¸ªæ•´ç†å†…å­˜çš„è¿‡ç¨‹ã€‚</p></div><!----><footer class="vp-page-meta"><div class="vp-meta-item edit-link"><a class="auto-link external-link vp-meta-label" href="https://github.com/vuepress-theme-hope/vuepress-theme-hope/edit/main/src/study-notes/JVM/README.md" aria-label="åœ¨ GitHub ä¸Šç¼–è¾‘æ­¤é¡µ" rel="noopener noreferrer" target="_blank"><!--[--><svg xmlns="http://www.w3.org/2000/svg" class="icon edit-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="edit icon" name="edit"><path d="M430.818 653.65a60.46 60.46 0 0 1-50.96-93.281l71.69-114.012 7.773-10.365L816.038 80.138A60.46 60.46 0 0 1 859.225 62a60.46 60.46 0 0 1 43.186 18.138l43.186 43.186a60.46 60.46 0 0 1 0 86.373L588.879 565.55l-8.637 8.637-117.466 68.234a60.46 60.46 0 0 1-31.958 11.229z"></path><path d="M728.802 962H252.891A190.883 190.883 0 0 1 62.008 771.98V296.934a190.883 190.883 0 0 1 190.883-192.61h267.754a60.46 60.46 0 0 1 0 120.92H252.891a69.962 69.962 0 0 0-69.098 69.099V771.98a69.962 69.962 0 0 0 69.098 69.098h475.911A69.962 69.962 0 0 0 797.9 771.98V503.363a60.46 60.46 0 1 1 120.922 0V771.98A190.883 190.883 0 0 1 728.802 962z"></path></svg><!--]-->åœ¨ GitHub ä¸Šç¼–è¾‘æ­¤é¡µ<!----></a></div><div class="vp-meta-item git-info"><div class="update-time"><span class="vp-meta-label">ä¸Šæ¬¡ç¼–è¾‘äº: </span><!----></div><div class="contributors"><span class="vp-meta-label">è´¡çŒ®è€…: </span><!--[--><!--[--><span class="vp-meta-info" title="email: 948742327@qq.com">jiang</span><!--]--><!--]--></div></div></footer><nav class="vp-page-nav"><a class="route-link auto-link prev" href="/blog/study-notes/heima-baodian/" aria-label="é»‘é©¬é¢è¯•å®å…¸"><div class="hint"><span class="arrow start"></span>ä¸Šä¸€é¡µ</div><div class="link"><!---->é»‘é©¬é¢è¯•å®å…¸</div></a><a class="route-link auto-link next" href="/blog/study-notes/JVM/Memory-GC/" aria-label="å†…å­˜ä¸åƒåœ¾å›æ”¶ç¯‡"><div class="hint">ä¸‹ä¸€é¡µ<span class="arrow end"></span></div><div class="link">å†…å­˜ä¸åƒåœ¾å›æ”¶ç¯‡<!----></div></a></nav><!----><!----><!--]--></main><!--]--><footer class="vp-footer-wrapper"><div class="vp-footer">å­åœ¨å·ä¸Šæ›°ï¼šâ€œé€è€…å¦‚æ–¯å¤«ï¼Œä¸èˆæ˜¼å¤œã€‚</div><div class="vp-copyright">Copyright Â© 2024 æ¨±å® </div></footer></div><!--]--><!--[--><!----><!--]--><!--]--></div>
    <script src="/blog/assets/js/runtime~app.20661bf4.js" defer></script><script src="/blog/assets/js/4438.eaf07fb8.js" defer></script><script src="/blog/assets/js/app.1c886d51.js" defer></script>
  </body>
</html>
